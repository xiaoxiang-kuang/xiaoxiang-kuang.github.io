<!DOCTYPE html>
<html dir="ltr">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
<meta name="theme-color" content="#FFFFFF">
<meta name="color-scheme" content="light dark">

<title>mysql | 小象的blog</title>
<link rel="manifest" href="/manifest.json">
<link rel="icon" href="/favicon.png" type="image/x-icon">
<link rel="stylesheet" href="/book.min.e24d94cf619e7e6705439036ee43e77f243d24ac89100b59375379bc4d659d87.css" >
  <script defer src="/sw.min.6f6f90fcb8eb1c49ec389838e6b801d0de19430b8e516902f8d75c3c8bd98739.js" ></script>
<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->
</head>
<body dir="ltr">
  <input type="checkbox" class="hidden toggle" id="toc-control" />
  <main class="container flex">

    <aside class="book-menu">
      <div class="book-menu-content">
        
  <nav>
<h2 class="book-brand">
  <a class="flex align-center" href="/"><img src="/logo.png" alt="Logo" /><span>小象的blog</span>
  </a>
</h2>


















  
<ul>
  
  <li>
    <a href="/posts/">
        主页
      </a>
  </li>
  
  <li>
    <a href="/posts/linux/linux%E5%91%BD%E4%BB%A4/">
        linux命令总结
      </a>
  </li>
  
  <li>
    <a href="/posts/linux/shell%E8%84%9A%E6%9C%AC/">
        shell脚本
      </a>
  </li>
  
  <li>
    <a href="/categories/book/">
        书籍笔记
      </a>
  </li>
  
  <li>
    <a href="/about/">
        关于
      </a>
  </li>
  
</ul>





</nav>




  <script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>


  <div class="split-line"></div>
  
  <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#mysql起步">mysql起步</a>
          <ul>
            <li><a href="#linux上mysql布局">linux上mysql布局</a></li>
            <li><a href="#mysql安装">mysql安装</a></li>
            <li><a href="#mysql配置">mysql配置</a></li>
          </ul>
        </li>
        <li><a href="#mysql账户管理">mysql账户管理</a></li>
        <li><a href="#mysql系统变量">mysql系统变量</a>
          <ul>
            <li><a href="#通过命令行设置系统变量">通过命令行设置系统变量</a></li>
            <li><a href="#通过配置文件设置系统变量">通过配置文件设置系统变量</a></li>
            <li><a href="#运行过程中修改系统变量">运行过程中修改系统变量</a></li>
            <li><a href="#状态变量">状态变量</a></li>
            <li><a href="#补充">补充</a></li>
          </ul>
        </li>
        <li><a href="#mysql字符集">mysql字符集</a>
          <ul>
            <li><a href="#常见字符集">常见字符集</a></li>
            <li><a href="#mysql的字符集和比较规则">mysql的字符集和比较规则</a></li>
            <li><a href="#各级别的字符集和比较规则">各级别的字符集和比较规则</a></li>
            <li><a href="#补充-1">补充</a></li>
          </ul>
        </li>
        <li><a href="#mysqldump">mysqldump</a></li>
        <li><a href="#mysqladmin">mysqladmin</a>
          <ul>
            <li><a href="#option">option</a></li>
            <li><a href="#command">command</a></li>
          </ul>
        </li>
        <li><a href="#sql">sql</a>
          <ul>
            <li><a href="#数据类型">数据类型</a></li>
            <li><a href="#database">DATABASE</a></li>
            <li><a href="#table">TABLE</a></li>
            <li><a href="#show">SHOW</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>


 
      </div>
    </aside>

    <div class="book-page">
      <div>
	      <header class="book-header">
          
  <div class="flex align-center justify-between">
   <label for="toc-control">
    
    <img src="/svg/toc.svg" class="book-icon" alt="Table of Contents" />
    
  </label>
  
  <strong>mysql</strong>
</div>


  
    <aside class="hidden clearfix">
      <nav>
        




        








        

  
<ul>
  
  <li>
    <a href="/posts/">
        主页
      </a>
  </li>
  
  <li>
    <a href="/posts/linux/linux%E5%91%BD%E4%BB%A4/">
        linux命令总结
      </a>
  </li>
  
  <li>
    <a href="/posts/linux/shell%E8%84%9A%E6%9C%AC/">
        shell脚本
      </a>
  </li>
  
  <li>
    <a href="/categories/book/">
        书籍笔记
      </a>
  </li>
  
  <li>
    <a href="/about/">
        关于
      </a>
  </li>
  
</ul>





      </nav>
      <div class="split-line"></div>
      
  <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#mysql起步">mysql起步</a>
          <ul>
            <li><a href="#linux上mysql布局">linux上mysql布局</a></li>
            <li><a href="#mysql安装">mysql安装</a></li>
            <li><a href="#mysql配置">mysql配置</a></li>
          </ul>
        </li>
        <li><a href="#mysql账户管理">mysql账户管理</a></li>
        <li><a href="#mysql系统变量">mysql系统变量</a>
          <ul>
            <li><a href="#通过命令行设置系统变量">通过命令行设置系统变量</a></li>
            <li><a href="#通过配置文件设置系统变量">通过配置文件设置系统变量</a></li>
            <li><a href="#运行过程中修改系统变量">运行过程中修改系统变量</a></li>
            <li><a href="#状态变量">状态变量</a></li>
            <li><a href="#补充">补充</a></li>
          </ul>
        </li>
        <li><a href="#mysql字符集">mysql字符集</a>
          <ul>
            <li><a href="#常见字符集">常见字符集</a></li>
            <li><a href="#mysql的字符集和比较规则">mysql的字符集和比较规则</a></li>
            <li><a href="#各级别的字符集和比较规则">各级别的字符集和比较规则</a></li>
            <li><a href="#补充-1">补充</a></li>
          </ul>
        </li>
        <li><a href="#mysqldump">mysqldump</a></li>
        <li><a href="#mysqladmin">mysqladmin</a>
          <ul>
            <li><a href="#option">option</a></li>
            <li><a href="#command">command</a></li>
          </ul>
        </li>
        <li><a href="#sql">sql</a>
          <ul>
            <li><a href="#数据类型">数据类型</a></li>
            <li><a href="#database">DATABASE</a></li>
            <li><a href="#table">TABLE</a></li>
            <li><a href="#show">SHOW</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>


    </aside>
  
 
        </header>
        
<article class="markdown">
  <h1>
    <a href="/posts/%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/">mysql</a>
  </h1>
  
  <h5>2021-02-04</h5>



  

  
  <div>
    
      <a href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a>
  </div>
  



<h2 id="mysql起步">
  mysql起步
  <a class="anchor" href="#mysql%e8%b5%b7%e6%ad%a5">#</a>
</h2>
<ul>
<li>查询版本和当前时间<code>select version(),current_date;</code></li>
<li>mysql执行结束后会显示返回了多少行和用了多长时间，受网络其他因素影响</li>
<li>当输入多行，打算不执行这句sql语句，输入<code>\c</code></li>
<li>自带的的mysql database描述了用户的访问权限。</li>
<li>unix下数据库名是大小写相关的。建议在创建数据库的时候要么全大写，要么全小写，可以在刚安装的时候修改my.cnf文件。</li>
<li>相邻的带引号的多个字符串会拼接成一个字符串。下面这两个等价：</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#e6db74">&#39;a string&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#39;a&#39;&#39;string&#39;</span>
</span></span></code></pre></div><h3 id="linux上mysql布局">
  linux上mysql布局
  <a class="anchor" href="#linux%e4%b8%8amysql%e5%b8%83%e5%b1%80">#</a>
</h3>
<table>
<thead>
<tr>
<th>文件资源</th>
<th>位置</th>
</tr>
</thead>
<tbody>
<tr>
<td>客户端程序和脚本</td>
<td>/usr/bin</td>
</tr>
<tr>
<td>mysqld server</td>
<td>/usr/sbin</td>
</tr>
<tr>
<td>配置文件地址</td>
<td>/etc/my.cnf</td>
</tr>
<tr>
<td>数据存放目录</td>
<td>/var/lib/mysql</td>
</tr>
<tr>
<td>错误日志文件</td>
<td>/var/log/mysqld.log</td>
</tr>
<tr>
<td>secure_file_priv</td>
<td>/var/lib/mysql-files</td>
</tr>
<tr>
<td>System V init script</td>
<td>/etc/init.d/mysqld</td>
</tr>
<tr>
<td>Systemd服务</td>
<td>mysqld</td>
</tr>
<tr>
<td>Pid文件</td>
<td>/var/run/mysql/mysqld.pid</td>
</tr>
<tr>
<td>Socket</td>
<td>/var/lib/mysql/mysql.sock</td>
</tr>
<tr>
<td>使用手册</td>
<td>/usr/share/man</td>
</tr>
<tr>
<td>字符集文件等其他文件</td>
<td>/usr/share/mysql</td>
</tr>
<tr>
<td>库</td>
<td>/usr/lib/mysql</td>
</tr>
<tr>
<td><strong>参考链接：</strong></td>
<td>
  <a href="https://dev.mysql.com/doc/refman/8.0/en/linux-installation-rpm.html">MySQL :: MySQL 8.0 Reference Manual :: 2.5.4 Installing MySQL on Linux Using RPM Packages from Oracle</a></td>
</tr>
</tbody>
</table>
<h3 id="mysql安装">
  mysql安装
  <a class="anchor" href="#mysql%e5%ae%89%e8%a3%85">#</a>
</h3>
<ul>
<li><code>systemctl start mysqld</code>启动mysql。</li>
<li>mysql安装后，会自动创建超级用户<code>'root'@'localhost'</code>，其密码在<code>/var/log/mysqld.log</code>，使用<code>grep 'temporary password' /var/log/mysqld.log</code>来寻找密码。</li>
<li>修改密码<code>ALTER USER 'root'@'localhost' IDENTIFIED BY 'newPassword'</code>。</li>
<li>mysql8修改成简单的密码会报错（试了下mysql5.7也会报错，解决方法一样）。解决流程如下：
<ol>
<li>mysql8增加了一组变量来控制密码的长度、强度等。通过<code>SHOW VARIABLES LIKE 'validate_password%'</code>来查看。</li>
<li>validate_password.length用来要求密码的最小长度，这个参数不得小于<code>validate_password.number_count+validate_password.special_char_count+2*validate_password.mixed_case_count)</code>。</li>
<li>validate_password.policy会影响validate_password的其他变量是否有效（除validate_password.check_user_name），它的值可以为0(LOW)，1(MEDIUM)，2(STRONG)。为0则只检查length这个变量。</li>
<li>更改策略：<code>set global validate_password.policy=0;set global validate_password.number=4;</code></li>
<li><strong>参考链接：</strong>
  <a href="https://dev.mysql.com/doc/refman/8.0/en/validate-password-options-variables.html">MySQL :: MySQL 8.0 Reference Manual :: 6.4.3.2 Password Validation Options and Variables</a></li>
</ol>
</li>
</ul>
<h3 id="mysql配置">
  mysql配置
  <a class="anchor" href="#mysql%e9%85%8d%e7%bd%ae">#</a>
</h3>
<ul>
<li>mysql配置文件被划分为多个组，每个组有一个组名，用[]括起来。</li>
</ul>
<pre tabindex="0"><code>[mysqld]
default-storage-engine=InnoDB
validate_password=OFF
</code></pre><h2 id="mysql账户管理">
  mysql账户管理
  <a class="anchor" href="#mysql%e8%b4%a6%e6%88%b7%e7%ae%a1%e7%90%86">#</a>
</h2>
<ul>
<li>mysql将账户存储在mysq数据库的user表中。</li>
<li><code>CREATE USER</code>用于创建性的mysql用户；账户首次创建没有特权，需要使用<code>GRANT</code>分配特权。</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e">#如果不指定主机，默认就是&#39;%&#39;（所有ip都能访问）</span>
</span></span><span style="display:flex;"><span>CREATE USER <span style="color:#e6db74">&#39;jeffrey&#39;</span>@<span style="color:#e6db74">&#39;localhost&#39;</span> IDENTIFIED BY <span style="color:#e6db74">&#39;password&#39;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#删除用户。</span>
</span></span><span style="display:flex;"><span>DROP USER <span style="color:#e6db74">&#39;jeffrey&#39;</span>@<span style="color:#e6db74">&#39;localhost&#39;</span>;
</span></span><span style="display:flex;"><span><span style="color:#75715e">#重命名现有的账户,可以用来解决账号只能在本地访问的问题。</span>
</span></span><span style="display:flex;"><span>RENAME USER <span style="color:#e6db74">&#39;jeffrey&#39;</span>@<span style="color:#e6db74">&#39;localhost&#39;</span> TO <span style="color:#e6db74">&#39;jeff&#39;</span>@<span style="color:#e6db74">&#39;%&#39;</span>
</span></span></code></pre></div><ul>
<li><code>ALTER USER</code>修改账户的信息（如修改密码）。不推荐使用<code>SET PASSWORD</code>来修改密码。</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e">#修改自己的密码，USER()会返回当前登录用户的用户名和主机名</span>
</span></span><span style="display:flex;"><span>ALTER USER USER<span style="color:#f92672">()</span> IDENTIFIED BY <span style="color:#e6db74">&#39;password&#39;</span>;
</span></span><span style="display:flex;"><span><span style="color:#75715e">#锁定账户</span>
</span></span><span style="display:flex;"><span>ALTER USER <span style="color:#e6db74">&#39;jeffrey&#39;</span>@<span style="color:#e6db74">&#39;localhost&#39;</span> ACCOUNT LOCK;
</span></span><span style="display:flex;"><span>ALTER USER <span style="color:#e6db74">&#39;jeffrey&#39;</span>@<span style="color:#e6db74">&#39;localhost&#39;</span> ACCOUNT UNLOCK;
</span></span></code></pre></div><ul>
<li><code>GRANT</code>用来对账户进行授权，<code>REVOKE</code>用来撤销账户特权。</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e">#授予除GRANT和PROXY外的所有特权</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#还可以授予ALTER、CREATE、DELETE、DROP、SELECT、UPDATE、GRANT OPTION</span>
</span></span><span style="display:flex;"><span>GRANT ALL ON db1.* TO <span style="color:#e6db74">&#39;jeffrey&#39;</span>@<span style="color:#e6db74">&#39;localhost&#39;</span>;
</span></span><span style="display:flex;"><span>REVOKE INSERT ON *.* FROM <span style="color:#e6db74">&#39;jeffrey&#39;</span>@<span style="color:#e6db74">&#39;localhost&#39;</span>;
</span></span><span style="display:flex;"><span>REVOKE ALL <span style="color:#f92672">[</span>PRIVILEGES<span style="color:#f92672">]</span>, GRANT OPTION FROM <span style="color:#e6db74">&#39;jeffrey&#39;</span>@<span style="color:#e6db74">&#39;localhost&#39;</span>;
</span></span></code></pre></div><h2 id="mysql系统变量">
  mysql系统变量
  <a class="anchor" href="#mysql%e7%b3%bb%e7%bb%9f%e5%8f%98%e9%87%8f">#</a>
</h2>
<ul>
<li>mysql有很多的系统变量，能够影响程序的行为，很多命令都能在运行过程中修改。</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e">#获取某个变量的信息</span>
</span></span><span style="display:flex;"><span>show <span style="color:#f92672">[</span>global | session<span style="color:#f92672">]</span> variables like <span style="color:#e6db74">&#39;xxx&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#获取默认存储引擎</span>
</span></span><span style="display:flex;"><span>show variables like <span style="color:#e6db74">&#39;default_storage_engine&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#获取默认的最大连接数</span>
</span></span><span style="display:flex;"><span>show variables like <span style="color:#e6db74">&#39;max_connections&#39;</span>;
</span></span></code></pre></div><h3 id="通过命令行设置系统变量">
  通过命令行设置系统变量
  <a class="anchor" href="#%e9%80%9a%e8%bf%87%e5%91%bd%e4%bb%a4%e8%a1%8c%e8%ae%be%e7%bd%ae%e7%b3%bb%e7%bb%9f%e5%8f%98%e9%87%8f">#</a>
</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>mysqld --max_connections<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>
</span></span></code></pre></div><h3 id="通过配置文件设置系统变量">
  通过配置文件设置系统变量
  <a class="anchor" href="#%e9%80%9a%e8%bf%87%e9%85%8d%e7%bd%ae%e6%96%87%e4%bb%b6%e8%ae%be%e7%bd%ae%e7%b3%bb%e7%bb%9f%e5%8f%98%e9%87%8f">#</a>
</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-properties" data-lang="properties"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">[server]</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">max_connections</span><span style="color:#f92672">=</span><span style="color:#e6db74">10</span>
</span></span></code></pre></div><h3 id="运行过程中修改系统变量">
  运行过程中修改系统变量
  <a class="anchor" href="#%e8%bf%90%e8%a1%8c%e8%bf%87%e7%a8%8b%e4%b8%ad%e4%bf%ae%e6%94%b9%e7%b3%bb%e7%bb%9f%e5%8f%98%e9%87%8f">#</a>
</h3>
<ul>
<li>许多系统变量分为全局范围（global）和会话范围（session）。</li>
<li>并不是所有的变量都有全局范围和会话范围，如max_connections只有全局范围。</li>
<li>服务器在启动时会给所有的全局变量一个默认值，当有连接的客户端时，服务器为每个连接的客户端维护一组会话变量，并以全局变量的值初始化。</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e">#全局设置存储引擎</span>
</span></span><span style="display:flex;"><span>set global default_sotrage_engine<span style="color:#f92672">=</span>MyISAM
</span></span><span style="display:flex;"><span><span style="color:#75715e">#本次会话期间设置存储引擎</span>
</span></span><span style="display:flex;"><span>set <span style="color:#f92672">[</span>session<span style="color:#f92672">]</span> default_storage_engine<span style="color:#f92672">=</span>MyISAM
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#获取会话范围的变量内容</span>
</span></span><span style="display:flex;"><span>show SESSION VARIABLES LIKE <span style="color:#e6db74">&#39;default_sotrage_engine&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#不写修饰符默认是session范围，如果一个变量没有session范围则显示global范围的值</span>
</span></span><span style="display:flex;"><span>show VARIABLES LIKE <span style="color:#e6db74">&#39;max_connections&#39;</span>
</span></span></code></pre></div><h3 id="状态变量">
  状态变量
  <a class="anchor" href="#%e7%8a%b6%e6%80%81%e5%8f%98%e9%87%8f">#</a>
</h3>
<ul>
<li>状态变量有关服务器的运行情况。</li>
<li>状态变量不能人为设置。</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>show <span style="color:#f92672">[</span>global | session<span style="color:#f92672">]</span> status like <span style="color:#f92672">[</span>like <span style="color:#e6db74">&#39;xxx&#39;</span><span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#查看当前有多少客户端与服务器建立了连接。</span>
</span></span><span style="display:flex;"><span>show status like <span style="color:#e6db74">&#39;threads_connected&#39;</span>
</span></span></code></pre></div><h3 id="补充">
  补充
  <a class="anchor" href="#%e8%a1%a5%e5%85%85">#</a>
</h3>
<ul>
<li>
<p>很多变量不可修改，如<code>version</code>。</p>
</li>
<li>
<p>大部分系统变量都可以当启动选项传入。</p>
</li>
</ul>
<h2 id="mysql字符集">
  mysql字符集
  <a class="anchor" href="#mysql%e5%ad%97%e7%ac%a6%e9%9b%86">#</a>
</h2>
<h3 id="常见字符集">
  常见字符集
  <a class="anchor" href="#%e5%b8%b8%e8%a7%81%e5%ad%97%e7%ac%a6%e9%9b%86">#</a>
</h3>
<ul>
<li>ASCII：共128个字符，用一个字节编码。</li>
<li>ISO 8859-1：共收录256个字符，在ASCII的基础上扩充了128个西欧常用字符。这个字符集也有一个别名Latin 1。</li>
<li>GB2312：收录了6763个汉字以及部分其他编码，兼容ASCII字符集，如果该字符集在ASCII字符集中，则采用一字节编码，否则采用两字节编码。</li>
<li>GBK：在GB2312的基础上进行了扩充，兼容GB2312。</li>
<li>UTF-8：几乎收录了当前世界上各个国家和地区使用的字符，而且还在不断扩充，采用变长编码的方式，编码一个字符需要1~4个字节。</li>
</ul>
<h3 id="mysql的字符集和比较规则">
  mysql的字符集和比较规则
  <a class="anchor" href="#mysql%e7%9a%84%e5%ad%97%e7%ac%a6%e9%9b%86%e5%92%8c%e6%af%94%e8%be%83%e8%a7%84%e5%88%99">#</a>
</h3>
<h4 id="utf8和utf8mb4">
  utf8和utf8mb4
  <a class="anchor" href="#utf8%e5%92%8cutf8mb4">#</a>
</h4>
<ul>
<li>utf8mb3：阉割过的utf-8，只使用1~3个字节表示字符。mysql中的utf8就是utf8-mb3的别名。</li>
<li>utf8mb4：正宗utf-8，使用1~4表示字符。</li>
</ul>
<h4 id="字符集查看">
  字符集查看
  <a class="anchor" href="#%e5%ad%97%e7%ac%a6%e9%9b%86%e6%9f%a5%e7%9c%8b">#</a>
</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>SHOW CHARSET <span style="color:#f92672">[</span>LIKE <span style="color:#e6db74">&#39;utf8%&#39;</span><span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#结果中的maxlen表示此字符集最多需要几个字节表示一个字符。</span>
</span></span></code></pre></div><h4 id="比较规则">
  比较规则
  <a class="anchor" href="#%e6%af%94%e8%be%83%e8%a7%84%e5%88%99">#</a>
</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>SHOW COLLATION <span style="color:#f92672">[</span>LIKE <span style="color:#e6db74">&#39;utf8%&#39;</span><span style="color:#f92672">]</span>
</span></span></code></pre></div><ul>
<li>比较规则都以与其关联的字符集的名称开头，后面紧跟着该比较规则所应用的语言，如<code>utf8_polish_ci</code>表示波兰语的比较规则，<code>utf8_general_ci</code>是一种通用的比较规则。名称后缀介绍如下：</li>
</ul>
<table>
<thead>
<tr>
<th>后缀</th>
<th>英文</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>_ai</td>
<td>accent insensitive</td>
<td>不区分重音</td>
</tr>
<tr>
<td>_as</td>
<td>accent sensitive</td>
<td>区分重音</td>
</tr>
<tr>
<td>_ci</td>
<td>case insensitive</td>
<td>不区分大小写</td>
</tr>
<tr>
<td>_cs</td>
<td>case sensitive</td>
<td>区分大小写</td>
</tr>
<tr>
<td>_bin</td>
<td>binary</td>
<td>以二进制的方式比较</td>
</tr>
</tbody>
</table>
<ul>
<li>每种字符集都有一个默认的比较规则，是在执行SHOW COLLATION语句返回的结果中Default为YES的比较规则。</li>
</ul>
<h3 id="各级别的字符集和比较规则">
  各级别的字符集和比较规则
  <a class="anchor" href="#%e5%90%84%e7%ba%a7%e5%88%ab%e7%9a%84%e5%ad%97%e7%ac%a6%e9%9b%86%e5%92%8c%e6%af%94%e8%be%83%e8%a7%84%e5%88%99">#</a>
</h3>
<ul>
<li>mysql有4个界别的字符集和比较规则</li>
</ul>
<h4 id="服务器级别">
  服务器级别
  <a class="anchor" href="#%e6%9c%8d%e5%8a%a1%e5%99%a8%e7%ba%a7%e5%88%ab">#</a>
</h4>
<ul>
<li>mysql提过了两个系统变量来表示服务器级别的字符集和比较规则：</li>
</ul>
<pre tabindex="0"><code>#服务器级别的字符集
SHOW VARIABLES LIKE &#39;character_set_server&#39;
#服务器级别的比较规则
SHOW VARIABLES LIKE &#39;collation_server&#39;
</code></pre><ul>
<li>通过修改配置文件来修改这两个值</li>
</ul>
<pre tabindex="0"><code>[server]
charset_set_server=utf8
collation_server=utf8_general_ci
</code></pre><h4 id="数据库级别">
  数据库级别
  <a class="anchor" href="#%e6%95%b0%e6%8d%ae%e5%ba%93%e7%ba%a7%e5%88%ab">#</a>
</h4>
<ul>
<li>
<p>有两个变量可以看数据库级别的字符集和编码：<code>character_set_database</code>和<code>collation_database</code>，使用方式和上面类似。不能使用这两个变量修改当前数据库的字符集和比较规则。</p>
</li>
<li>
<p>创建数据库和修改数据库时指定</p>
</li>
</ul>
<pre tabindex="0"><code>CREATE DATABASE database1
	[[DEFAULT] CHARACTER SET utf8]
	[[DEFAULT] COLLATE utf8_general_ci]

ALTER DATABASE database1
	[[DEFAULT] CHARACTER SET utf8]
	[[DEFAULT] COLLATE utf8_general_ci]
</code></pre><h4 id="表级别">
  表级别
  <a class="anchor" href="#%e8%a1%a8%e7%ba%a7%e5%88%ab">#</a>
</h4>
<ul>
<li>可以在创建和修改表的时候指定表的字符集和比较规则。</li>
</ul>
<pre tabindex="0"><code>CREATE TABLE table1
	...
	...
	[[DEFALUT] CHARACTER SET utf8]
	[COLLATE UTF8_general_ci]
	
ALTER TABLE table1
	[[DEFALUT] CHARACTER SET utf8]
	[COLLATE UTF8_general_ci]
</code></pre><h4 id="列级别">
  列级别
  <a class="anchor" href="#%e5%88%97%e7%ba%a7%e5%88%ab">#</a>
</h4>
<ul>
<li>创建和修改列的时候可以设置列的字符集和比较规则。</li>
</ul>
<pre tabindex="0"><code>CREATE TABLE table1(
	column1 varchar(255) [CHARACTER SET utf8] [COLLATE utf8_general_ci]
);

ALTER TABLE table1 MODIFY column1 varchar(255) [CHARACTER SET utf8] [COLLATE utf8_general_ci];
</code></pre><h3 id="补充-1">
  补充
  <a class="anchor" href="#%e8%a1%a5%e5%85%85-1">#</a>
</h3>
<ul>
<li>只修改字符集，则比较规则将修改为修改后的字符集的默认的比较规则。</li>
<li>只修改比较规则，则字符集将变为修改后的比较规则对应的字符集。</li>
<li>创建或修改列时未显示的指定字符集和比较规则，则该列使用表的字符集和比较规则，如果创建表时未显示的指定字符集和比较规则，则该表默认使用数据库的字符集和比较规则，如果创建数据库时未显示指定字符集和比较规则，则使用mysql服务器的字符集和比较规则。</li>
<li>mysql5.7及以前的版本，mysql服务器默认的字符集为latin1，mysql8.0后默认字符集为utfmb4。</li>
</ul>
<h2 id="mysqldump">
  mysqldump
  <a class="anchor" href="#mysqldump">#</a>
</h2>
<p>mysqldump可以备份数据库。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>mysqldump <span style="color:#f92672">[</span>options<span style="color:#f92672">]</span> db_name &gt; file_name
</span></span><span style="display:flex;"><span>mysqldump <span style="color:#f92672">[</span>options<span style="color:#f92672">]</span> --databases db_name ...
</span></span></code></pre></div><ul>
<li>默认输出到控制台，可通过<code>&gt;</code>输出到文件。</li>
<li>可以直接在后面跟一个数据库名，这样就备份了数据库的表的结构和数据。但不包括建库的语句。</li>
<li>可选的option
<ul>
<li><code>--databases</code>：备份指定几个数据库。在备份数据库时会加上<code>CREATE DATBASE...</code>和<code>use xxx</code>的语句，</li>
<li><code>--all-databases</code>：备份数据库的所有表，和<code>--databases</code>类似。</li>
<li><code>--add-drop-database</code>：在<code>CREATE DATABASE</code>之前加上<code>DROP DATABASE</code>语句，这个参数与&ndash;databases和&ndash;all-databases同时使用。</li>
<li><code>--add-drop-table</code>：建表语句之前加上删表语句。</li>
<li><code>--ignore-table</code>：不备份指定的表。</li>
<li><code>--tables</code>: 会覆盖&ndash;databases属性<code>mysqldump database1 --tables table1 -u root -p </code>。</li>
<li><code>--no-data</code>：不备份数据。</li>
<li><code>--force</code>：-f即使在备份期间发生sql异常也继续。</li>
<li><code>--host</code>：-h主机。&ndash;user：-u用户。&ndash;password：-p密码。&ndash;port：-P端口。</li>
<li><code>--xml</code>：输出xml文件。</li>
<li><code>--set-charset</code>：默认启用的参数。</li>
</ul>
</li>
<li>一个例子</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>mysqldump -u root -p --databases test --add-drop-database &gt; test.sql
</span></span></code></pre></div><ul>
<li>
<p>导入sql文件</p>
<ul>
<li>连接上mysql server后使用<code>source</code>命令导入。</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>mysql&gt;source dump.sql
</span></span></code></pre></div><ul>
<li>从外部导入（sql文件中指定了数据库的情况）。</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>shell&gt;mysql<span style="color:#f92672">[</span>-u root -p<span style="color:#f92672">]</span> &lt;dump.sql
</span></span></code></pre></div><ul>
<li>外部导入（sql文件中未指定数据库）</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>shell&gt; mysqladmin create db1 <span style="color:#75715e">#如果有该数据库就不用建了</span>
</span></span><span style="display:flex;"><span>shell&gt; mysql <span style="color:#f92672">[</span>-u root -p<span style="color:#f92672">]</span> db1 &lt; dump.sql <span style="color:#75715e">#指定数据库</span>
</span></span></code></pre></div></li>
</ul>
<p>参考链接：
  <a href="https://dev.mysql.com/doc/refman/5.7/en/mysqldump.html#option_mysqldump_databases">MySQL :: MySQL 5.7 Reference Manual :: 4.5.4 mysqldump — A Database Backup Program</a></p>
<h2 id="mysqladmin">
  mysqladmin
  <a class="anchor" href="#mysqladmin">#</a>
</h2>
<ul>
<li>mysqladmin可以用来检测服务的配置、创建数据库、关闭mysql服务等。</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>mysqladmin <span style="color:#f92672">[</span>options<span style="color:#f92672">]</span> command <span style="color:#f92672">[</span>command-arg<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>command <span style="color:#f92672">[</span>command-arg<span style="color:#f92672">]]</span>
</span></span></code></pre></div><h3 id="option">
  option
  <a class="anchor" href="#option">#</a>
</h3>
<ul>
<li>&ndash;host：指定主机。</li>
<li>&ndash;port（-P）：指定端口。</li>
<li>&ndash;user：指定连接用户。</li>
<li>&ndash;version：显示版本信息并退出。</li>
<li>&ndash;wait：如果连接失败，等待并重试。</li>
<li>&ndash;connect-timeout：连接超时的时间。</li>
</ul>
<h3 id="command">
  command
  <a class="anchor" href="#command">#</a>
</h3>
<ul>
<li>create/drop db_name：创建/删除数据库。</li>
<li>password &ldquo;new_password&rdquo;：修改密码，在windows上确保使用双引号&quot;，使用单引号&rsquo;的话单引号会被识别为密码的一部分。</li>
<li>shutdown：关闭服务。</li>
<li>status：显示一个简短的服务状态消息。显示的结果如下：
<ul>
<li>Uptime：mysql运行了多少秒。</li>
<li>Threads：客户端连接的线程数（active）。</li>
<li>Questions：从服务启动开始客户端查询的数量。</li>
<li>Slow queries：查询超过<code>long_query_time</code>秒的数量。</li>
<li>Opens：服务已经打开了多少张表。</li>
<li>Flush tables：<code>flush-*,refresh,reload</code>这些指令服务执行的次数。</li>
<li>Open tables：当前打开了多少张表。</li>
</ul>
</li>
<li>version：显示服务的版本信息。</li>
</ul>
<p><strong>参考链接（官方）：</strong>
  <a href="https://dev.mysql.com/doc/refman/5.7/en/mysqladmin.html"> mysqladmin — A MySQL Server Administration Program</a>
<strong>参考链接（汉化）：</strong>
  <a href="https://www.docs4dev.com/docs/zh/mysql/5.7/reference/mysqladmin.html">mysqladmin-MySQL 服务器管理程序 | Docs4dev</a></p>
<h2 id="sql">
  sql
  <a class="anchor" href="#sql">#</a>
</h2>
<h3 id="数据类型">
  数据类型
  <a class="anchor" href="#%e6%95%b0%e6%8d%ae%e7%b1%bb%e5%9e%8b">#</a>
</h3>
<ol>
<li>整数数据类型 tinyint（1字节）、smallint（2字节）、mediumint（3字节）、int（4字节）、bigint（8字节）。</li>
<li>定点数据类型 <code>decimal(5,2)</code>，其中5是精度，表示有效位数；2表示小数点后几位。</li>
<li>浮点类型 float（4字节）、double（8字节）。</li>
<li>日期和时间类型 DATE（YYYY-MM-DD）、DATETIME（YYYY-MM-DD hh:mm:ss）、TIMESTAMP（范围是UTC1970-01-01 00:00:01-UTC2038-01-19 03:14:07)、TIME（范围-838:59:59-838:59:59）、YEAR（范围是1901-2155）</li>
<li>字符串类型 CHAR（长度为声明时的长度，范围0-255）、VARCHAR（可变长度，范围时0-65535）、4种TEXT。</li>
<li>字节串类型 BINARY、VARCHAR、四种BLOB。</li>
</ol>
<ul>
<li>可以把BLOB看作VARBINARY，把TEXT看作VARCHAR，但它们有一点点不同：①对于BLOB和TEXT列上的索引，必须要指定缩影前缀长度，对应VARBINARY和VARCHAR，这是可选的；②BLOB和TEXT所在的列不能有默认值。<strong>参考链接：</strong>
  <a href="https://dev.mysql.com/doc/refman/5.7/en/blob.html">MySQL :: MySQL 5.7 Reference Manual :: 11.3.4 The BLOB and TEXT Types</a></li>
</ul>
<h3 id="database">
  DATABASE
  <a class="anchor" href="#database">#</a>
</h3>
<ul>
<li>创建数据库</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span>CRATE <span style="color:#66d9ef">DATABASE</span> db_name [[<span style="color:#66d9ef">DEFAULT</span>] <span style="color:#66d9ef">CHARACTER</span> <span style="color:#66d9ef">SET</span> [<span style="color:#f92672">=</span>] utf8];
</span></span></code></pre></div><h3 id="table">
  TABLE
  <a class="anchor" href="#table">#</a>
</h3>
<ul>
<li>克隆和复制。</li>
</ul>
<pre tabindex="0"><code>#从origin_tb1克隆一个新表（只有结构，没有数据）。
CREATE TABLE new_tb1 LIKE origin_tb1;
#复制origin_tb1表，（结构和数据都复制了）。
CREATE TABLE new_tb1 AS SELECT * FROM origin_tb1;
</code></pre><h4 id="alter">
  ALTER
  <a class="anchor" href="#alter">#</a>
</h4>
<pre tabindex="0"><code>#单个alter table可以跟多个修改语句，用逗号隔开
#删除
ALTER TABLE t2 DROP COLUMN c, DROP COLUMN d;
</code></pre><h5 id="changemodifyalter">
  change、modify、alter
  <a class="anchor" href="#changemodifyalter">#</a>
</h5>
<ul>
<li>change可以重命名列、修改列的定义。配合FIRST或AFTER，可以指定列的位置。</li>
<li>MODIFY可以修改列的定义，但无法修改它的名字。配合FIRST或AFTER能指定列的名字。</li>
<li>ALTER只能修改列的默认值。</li>
</ul>
<pre tabindex="0"><code>#将a的名字改为b，修改定义
ALTER TABLE t1 CHANGE a b BIGINT NOT NULL;
#不修改a的名字，只修改定义
ALTER TABLE t1 CHANGE a a BIGINT NOT NULL;
#修改b的定义
ALTER TABLE t1 MODIFY b INT NOT NULL;
#如果只想要修改b的名字而不去修改它的定义，就需要将定义再写一遍
ALTER TABLE t1 CHANGE b a INT NOT NULL;
#除了如PRIMARY KEY或UNIQUE属性，其他的如DEFAULT COMMENT等需要在修改时带上，否则修改后的列是没有这些属性。
#使用CHANGE或MODIFY，myslq会尝试将列中数据转化未新的类型。
#当使用CHANGE修改列名后，使用了该列的VIEW需要修改。
#ALTER TABLE xxx ALTER ...SET DEFAULT xxx或ALTER ... DROP DEFAULT。如果旧的默认值被删除而列不可以为NULL，mysql将为其分配默认值（数字类型默认为0，如果指定了AUTO_INCREMENT，默认值是序列中的下一个值，对于EMUM，默认值为第一个枚举值，对于其他字符串类型，默认值为空字符串）。

ALTER TABLE `service`.`email_relation` RENAME TO  `service`.`relation` ;
ALTER TABLE `service`.`relation` CHANGE COLUMN `email` `mail` VARCHAR(64) NULL DEFAULT NULL ;
</code></pre><ul>
<li>
  <a href="https://dev.mysql.com/doc/refman/5.7/en/alter-table.html">MySQL :: MySQL 5.7 Reference Manual :: 13.1.8 ALTER TABLE Statement</a></li>
</ul>
<h3 id="show">
  SHOW
  <a class="anchor" href="#show">#</a>
</h3>
<pre tabindex="0"><code>#显示属性
SHOW COLUMNS FROM MYSQL.USER;
#显示建库语句，例：
SHOW CREATE DATABASE MYSQL;
#显示建表语句，例：
SHOW CREATE TABLE MYSQL.USER;
#显示创建该用户的语句
SHOW CREATE USER root;
#显示分配个某用户的特权
SHOW GRANTS [FOR user];
show grants for &#39;joe&#39;@&#39;home.example.com&#39;
</code></pre></article>
 
	    </div>

      <footer class="page-footer">
        
  
<a href="https://beian.miit.gov.cn" target="_blank" style="color:gray;"></a>

 
      </footer>
    </div>

  </main>

</body>
</html>











