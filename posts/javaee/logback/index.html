<!DOCTYPE html>
<html dir="ltr">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
<meta name="theme-color" content="#FFFFFF">
<meta name="color-scheme" content="light dark">

<title>logback | 小象的blog</title>
<link rel="manifest" href="/manifest.json">
<link rel="icon" href="/favicon.png" type="image/x-icon">
<link rel="stylesheet" href="/book.min.e24d94cf619e7e6705439036ee43e77f243d24ac89100b59375379bc4d659d87.css" >
  <script defer src="/sw.min.6f6f90fcb8eb1c49ec389838e6b801d0de19430b8e516902f8d75c3c8bd98739.js" ></script>
<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->
</head>
<body dir="ltr">
  <input type="checkbox" class="hidden toggle" id="toc-control" />
  <main class="container flex">

    <aside class="book-menu">
      <div class="book-menu-content">
        
  <nav>
<h2 class="book-brand">
  <a class="flex align-center" href="/"><img src="/logo.png" alt="Logo" /><span>小象的blog</span>
  </a>
</h2>


















  
<ul>
  
  <li>
    <a href="/posts/">
        主页
      </a>
  </li>
  
  <li>
    <a href="/posts/linux/linux%E5%91%BD%E4%BB%A4/">
        linux命令总结
      </a>
  </li>
  
  <li>
    <a href="/posts/linux/shell%E8%84%9A%E6%9C%AC/">
        shell脚本
      </a>
  </li>
  
  <li>
    <a href="/categories/book/">
        书籍笔记
      </a>
  </li>
  
  <li>
    <a href="/about/">
        关于
      </a>
  </li>
  
</ul>





</nav>




  <script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>


  <div class="split-line"></div>
  
  <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li>
          <ul>
            <li><a href="#例">例：</a></li>
          </ul>
        </li>
        <li><a href="#appender">appender</a>
          <ul>
            <li><a href="#appenderbase">AppenderBase</a></li>
            <li><a href="#outputstreamappender">OutputStreamAppender</a></li>
            <li><a href="#consoleappender">ConsoleAppender</a></li>
            <li><a href="#fileappender">FileAppender</a></li>
            <li><a href="#rollingfileappender">RollingFileAppender</a></li>
            <li><a href="#socketappender-和-sslsocketappender">SocketAppender 和 SSLSocketAppender</a></li>
            <li><a href="#smtpappender">SMTPAppender</a></li>
            <li><a href="#dbappender">DBAppender</a></li>
            <li><a href="#syslogappender">SyslogAppender</a></li>
            <li><a href="#siftingappender">SiftingAppender</a></li>
            <li><a href="#asyncappender">AsyncAppender</a></li>
          </ul>
        </li>
        <li><a href="#encoder">encoder</a></li>
        <li><a href="#layout">layout</a>
          <ul>
            <li><a href="#patternlayout">PatternLayout</a></li>
            <li><a href="#logback初始化步骤">logback初始化步骤</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>


 
      </div>
    </aside>

    <div class="book-page">
      <div>
	      <header class="book-header">
          
  <div class="flex align-center justify-between">
   <label for="toc-control">
    
    <img src="/svg/toc.svg" class="book-icon" alt="Table of Contents" />
    
  </label>
  
  <strong>logback</strong>
</div>


  
    <aside class="hidden clearfix">
      <nav>
        




        








        

  
<ul>
  
  <li>
    <a href="/posts/">
        主页
      </a>
  </li>
  
  <li>
    <a href="/posts/linux/linux%E5%91%BD%E4%BB%A4/">
        linux命令总结
      </a>
  </li>
  
  <li>
    <a href="/posts/linux/shell%E8%84%9A%E6%9C%AC/">
        shell脚本
      </a>
  </li>
  
  <li>
    <a href="/categories/book/">
        书籍笔记
      </a>
  </li>
  
  <li>
    <a href="/about/">
        关于
      </a>
  </li>
  
</ul>





      </nav>
      <div class="split-line"></div>
      
  <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li>
          <ul>
            <li><a href="#例">例：</a></li>
          </ul>
        </li>
        <li><a href="#appender">appender</a>
          <ul>
            <li><a href="#appenderbase">AppenderBase</a></li>
            <li><a href="#outputstreamappender">OutputStreamAppender</a></li>
            <li><a href="#consoleappender">ConsoleAppender</a></li>
            <li><a href="#fileappender">FileAppender</a></li>
            <li><a href="#rollingfileappender">RollingFileAppender</a></li>
            <li><a href="#socketappender-和-sslsocketappender">SocketAppender 和 SSLSocketAppender</a></li>
            <li><a href="#smtpappender">SMTPAppender</a></li>
            <li><a href="#dbappender">DBAppender</a></li>
            <li><a href="#syslogappender">SyslogAppender</a></li>
            <li><a href="#siftingappender">SiftingAppender</a></li>
            <li><a href="#asyncappender">AsyncAppender</a></li>
          </ul>
        </li>
        <li><a href="#encoder">encoder</a></li>
        <li><a href="#layout">layout</a>
          <ul>
            <li><a href="#patternlayout">PatternLayout</a></li>
            <li><a href="#logback初始化步骤">logback初始化步骤</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>


    </aside>
  
 
        </header>
        
<article class="markdown">
  <h1>
    <a href="/posts/javaee/logback/">logback</a>
  </h1>
  
  <h5>2021-08-23</h5>



  

  
  <div>
    
      <a href="/tags/java/">java</a>
  </div>
  



<h3 id="例">
  例：
  <a class="anchor" href="#%e4%be%8b">#</a>
</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;configuration&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;appender</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;STDOUT&#34;</span> <span style="color:#a6e22e">class=</span><span style="color:#e6db74">&#34;ch.qos.logback.core.ConsoleAppender&#34;</span><span style="color:#f92672">&gt;</span> 
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;encoder&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;pattern&gt;</span>%d{HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n<span style="color:#f92672">&lt;/pattern&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;/encoder&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/appender&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;appender</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;FILE&#34;</span> <span style="color:#a6e22e">class=</span><span style="color:#e6db74">&#34;ch.qos.logback.core.FileAppender&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;file&gt;</span>testFile.log<span style="color:#f92672">&lt;/file&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">&lt;!--         将 immediateFlush 设置为 false 可以获得更高的日志吞吐量 --&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;immediateFlush&gt;</span>false<span style="color:#f92672">&lt;/immediateFlush&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">&lt;!--         默认为 ch.qos.logback.classic.encoder.PatternLayoutEncoder --&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;encoder&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;pattern&gt;</span>%-4relative [%thread] %-5level %logger{35} - %msg%n<span style="color:#f92672">&lt;/pattern&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;/encoder&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/appender&gt;</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;appender</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;SYSLOG&#34;</span> <span style="color:#a6e22e">class=</span><span style="color:#e6db74">&#34;ch.qos.logback.classic.net.SyslogAppender&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;syslogHost&gt;</span>remote_home<span style="color:#f92672">&lt;/syslogHost&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;port&gt;</span>5140<span style="color:#f92672">&lt;/port&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;facility&gt;</span>AUTH<span style="color:#f92672">&lt;/facility&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;suffixPattern&gt;</span>[%thread] %logger %msg<span style="color:#f92672">&lt;/suffixPattern&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/appender&gt;</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;root</span> <span style="color:#a6e22e">level=</span><span style="color:#e6db74">&#34;INFO&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;appender-ref</span> <span style="color:#a6e22e">ref=</span><span style="color:#e6db74">&#34;STDOUT&#34;</span> <span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/root&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;logger</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;space.xiaoxiang&#34;</span> <span style="color:#a6e22e">level=</span><span style="color:#e6db74">&#34;debug&#34;</span> <span style="color:#a6e22e">additivity=</span><span style="color:#e6db74">&#34;true&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/configuration&gt;</span>
</span></span></code></pre></div><h2 id="appender">
  appender
  <a class="anchor" href="#appender">#</a>
</h2>
<h3 id="appenderbase">
  AppenderBase
  <a class="anchor" href="#appenderbase">#</a>
</h3>
<ul>
<li>是一个抽象类，实现了Appender接口，提供了基本方法供appender使用。</li>
</ul>
<h3 id="outputstreamappender">
  OutputStreamAppender
  <a class="anchor" href="#outputstreamappender">#</a>
</h3>
<ul>
<li>是ConsoleAppender、FileAppender以及 RollingFileAppender的父类。</li>
</ul>
<h3 id="consoleappender">
  ConsoleAppender
  <a class="anchor" href="#consoleappender">#</a>
</h3>
<ul>
<li>将日志输出到控制台，ConsoleAppender通过用户指定的encoder格式化日志事件。</li>
</ul>
<h3 id="fileappender">
  FileAppender
  <a class="anchor" href="#fileappender">#</a>
</h3>
<ul>
<li>将日志输出到文件中，通过<code>file</code>来指定目标文件。</li>
</ul>
<h3 id="rollingfileappender">
  RollingFileAppender
  <a class="anchor" href="#rollingfileappender">#</a>
</h3>
<ul>
<li>具有轮转日志文件的功能。比如在满足特定的条件后，将日志输出到另一个文件。</li>
</ul>
<h3 id="socketappender-和-sslsocketappender">
  SocketAppender 和 SSLSocketAppender
  <a class="anchor" href="#socketappender-%e5%92%8c-sslsocketappender">#</a>
</h3>
<ul>
<li>可以将日志传输到远端机器。</li>
</ul>
<h3 id="smtpappender">
  SMTPAppender
  <a class="anchor" href="#smtpappender">#</a>
</h3>
<ul>
<li>收集日志到缓冲区中，当用户指定的事件发生时，将从缓冲区中取出适当的内容进行发送。</li>
</ul>
<h3 id="dbappender">
  DBAppender
  <a class="anchor" href="#dbappender">#</a>
</h3>
<ul>
<li>将日志插到三张数据库表中，三张表分别是logging_event, logging_event_property 与 logging_event_exception。</li>
</ul>
<h3 id="syslogappender">
  SyslogAppender
  <a class="anchor" href="#syslogappender">#</a>
</h3>
<ul>
<li>可以将日志发送给远程的syslog守护线程。</li>
<li>日志事件的严重程度是根据日志事件的级别转换来的，DEBUG被转换为7，INFO被转换为6，WARN为4，ERROR为3。</li>
</ul>
<h3 id="siftingappender">
  SiftingAppender
  <a class="anchor" href="#siftingappender">#</a>
</h3>
<ul>
<li>根据给定的运行时属性分离或者过滤日志。</li>
</ul>
<h3 id="asyncappender">
  AsyncAppender
  <a class="anchor" href="#asyncappender">#</a>
</h3>
<ul>
<li>作为一个事件调度器存在，必须调用其他appender来完成操作。</li>
</ul>
<h2 id="encoder">
  encoder
  <a class="anchor" href="#encoder">#</a>
</h2>
<ul>
<li>encoder将日志事件转换为字节数组，同时将字节数组写入到一个OutputStream中。</li>
<li>PatternLayoutEncoder是目前唯一真正有用的encoder，它仅包裹了一个PatternLayout就完成了大部分的工作。</li>
</ul>
<h2 id="layout">
  layout
  <a class="anchor" href="#layout">#</a>
</h2>
<ul>
<li>layout负责将日志事件转化为字符串。</li>
</ul>
<h3 id="patternlayout">
  PatternLayout
  <a class="anchor" href="#patternlayout">#</a>
</h3>
<ul>
<li>
<p>可以通过调整PatternLayout的转换模式来进行定制，PatternLayout的转换模式由字面量和转换说明符组成，每一个转换说明符由一个百分号开始<code>%</code>，后面跟随格式修改器，以及可用大括号括起来的转换字符和可选的参数。格式修改器可以对字段进行对齐，修改最大最小宽度等。</p>
</li>
<li>
<p>括号用于对转换模式进行分组，<code>(</code>和<code>)</code>都有特殊的含义。</p>
</li>
<li>
<p>名为<code>com.foo</code>的logger是名为<code>com.foo.bar</code>的logger的父级。（命名层次结构）</p>
</li>
<li>
<p>root logger的默认层级为DEBUG。</p>
</li>
<li>
<p>层级的排序：TRACE &lt; DEBUG &lt; INFO &lt; WARN &lt; ERROR。</p>
</li>
<li>
<p>appender具有叠加性：logger L的日志输出会遍历L和它父级中所有的appender，如果L的某个上级P，P设置了additivity=false，那么L的日志输出会遍历从L到P（不包括P）的所有appender。additivity默认为true。</p>
</li>
</ul>
<h3 id="logback初始化步骤">
  logback初始化步骤
  <a class="anchor" href="#logback%e5%88%9d%e5%a7%8b%e5%8c%96%e6%ad%a5%e9%aa%a4">#</a>
</h3>
<ol>
<li>在类路径下寻找名为logback-test.xml。</li>
<li>如果没找到，找名为logback.groovy的文件。</li>
<li>如果没找到，找名为logback.xml的文件。</li>
<li>如果没找到，会用ServiceLoader工具去解析<code>META-INF\services\ch.qos.logback.classic.spi.Configutator</code>路径下实现了Configurator接口的类</li>
<li>如果还没找到，logback会通过BasicConfigurator为自己进行配置，日志将会全部打印在控制台。</li>
</ol></article>
 
	    </div>

      <footer class="page-footer">
        
  


 
      </footer>
    </div>

  </main>

</body>
</html>











