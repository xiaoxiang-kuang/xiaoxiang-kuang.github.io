<!DOCTYPE html>
<html dir="ltr">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
<meta name="theme-color" content="#FFFFFF">
<meta name="color-scheme" content="light dark">

<title>主页 | 小象的blog</title>
<link rel="manifest" href="/manifest.json">
<link rel="icon" href="/favicon.png" type="image/x-icon">
<link rel="stylesheet" href="/book.min.e24d94cf619e7e6705439036ee43e77f243d24ac89100b59375379bc4d659d87.css" >
  <script defer src="/sw.min.6f6f90fcb8eb1c49ec389838e6b801d0de19430b8e516902f8d75c3c8bd98739.js" ></script>
<link rel="alternate" type="application/rss+xml" href="/posts/index.xml" title="小象的blog" />
<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->
</head>
<body dir="ltr">
  <input type="checkbox" class="hidden toggle" id="toc-control" />
  <main class="container flex">

    <aside class="book-menu">
      <div class="book-menu-content">
        
  <nav>
<h2 class="book-brand">
  <a class="flex align-center" href="/"><img src="/logo.png" alt="Logo" /><span>小象的blog</span>
  </a>
</h2>


















  
<ul>
  
  <li>
    <a href="/posts/">
        主页
      </a>
  </li>
  
  <li>
    <a href="/posts/linux/linux%E5%91%BD%E4%BB%A4/">
        linux命令总结
      </a>
  </li>
  
  <li>
    <a href="/posts/linux/shell%E8%84%9A%E6%9C%AC/">
        shell脚本
      </a>
  </li>
  
  <li>
    <a href="/categories/book/">
        书籍笔记
      </a>
  </li>
  
  <li>
    <a href="/about/">
        关于
      </a>
  </li>
  
</ul>





</nav>




  <script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>


  <div class="split-line"></div>
  
  
<nav>
  <ul>
  
    
	  
	
  
    
	  
		
		  <li>
			<a href="/tags/bios/"  class="flex justify-between">
			  <span>bios</span>
			  <span>11</span>
			</a>
		  </li>
		
		  <li>
			<a href="/tags/%E5%85%B6%E4%BB%96/"  class="flex justify-between">
			  <span>其他</span>
			  <span>4</span>
			</a>
		  </li>
		
		  <li>
			<a href="/tags/c%E8%AF%AD%E8%A8%80/"  class="flex justify-between">
			  <span>c语言</span>
			  <span>6</span>
			</a>
		  </li>
		
		  <li>
			<a href="/tags/linux/"  class="flex justify-between">
			  <span>linux</span>
			  <span>10</span>
			</a>
		  </li>
		
		  <li>
			<a href="/tags/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8/"  class="flex justify-between">
			  <span>信息安全</span>
			  <span>4</span>
			</a>
		  </li>
		
		  <li>
			<a href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/"  class="flex justify-between">
			  <span>计算机网络</span>
			  <span>7</span>
			</a>
		  </li>
		
		  <li>
			<a href="/tags/java/"  class="flex justify-between">
			  <span>java</span>
			  <span>53</span>
			</a>
		  </li>
		
		  <li>
			<a href="/tags/nginx/"  class="flex justify-between">
			  <span>nginx</span>
			  <span>5</span>
			</a>
		  </li>
		
		  <li>
			<a href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/"  class="flex justify-between">
			  <span>数据库</span>
			  <span>7</span>
			</a>
		  </li>
		
		  <li>
			<a href="/tags/%E5%89%8D%E7%AB%AF/"  class="flex justify-between">
			  <span>前端</span>
			  <span>4</span>
			</a>
		  </li>
		
		  <li>
			<a href="/tags/http/"  class="flex justify-between">
			  <span>http</span>
			  <span>7</span>
			</a>
		  </li>
		
		  <li>
			<a href="/tags/python/"  class="flex justify-between">
			  <span>python</span>
			  <span>6</span>
			</a>
		  </li>
		
		  <li>
			<a href="/tags/git/"  class="flex justify-between">
			  <span>git</span>
			  <span>1</span>
			</a>
		  </li>
		
		  <li>
			<a href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"  class="flex justify-between">
			  <span>设计模式</span>
			  <span>10</span>
			</a>
		  </li>
		
		  <li>
			<a href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"  class="flex justify-between">
			  <span>数据结构</span>
			  <span>7</span>
			</a>
		  </li>
		
		  <li>
			<a href="/tags/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/"  class="flex justify-between">
			  <span>操作系统</span>
			  <span>5</span>
			</a>
		  </li>
		
		  <li>
			<a href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/"  class="flex justify-between">
			  <span>计算机组成原理</span>
			  <span>1</span>
			</a>
		  </li>
		
      
	
  
  </ul>
</nav>


 
      </div>
    </aside>

    <div class="book-page">
      <div>
	      <header class="book-header">
          
  <div class="flex align-center justify-between">
   <label for="toc-control">
    
    <img src="/svg/toc.svg" class="book-icon" alt="Table of Contents" />
    
  </label>
  
  <strong>主页</strong>
</div>


  
    <aside class="hidden clearfix">
      <nav>
        




        








        

  
<ul>
  
  <li>
    <a href="/posts/">
        主页
      </a>
  </li>
  
  <li>
    <a href="/posts/linux/linux%E5%91%BD%E4%BB%A4/">
        linux命令总结
      </a>
  </li>
  
  <li>
    <a href="/posts/linux/shell%E8%84%9A%E6%9C%AC/">
        shell脚本
      </a>
  </li>
  
  <li>
    <a href="/categories/book/">
        书籍笔记
      </a>
  </li>
  
  <li>
    <a href="/about/">
        关于
      </a>
  </li>
  
</ul>





      </nav>
      <div class="split-line"></div>
      
  
<nav>
  <ul>
  
    
	  
	
  
    
	  
		
		  <li>
			<a href="/tags/bios/"  class="flex justify-between">
			  <span>bios</span>
			  <span>11</span>
			</a>
		  </li>
		
		  <li>
			<a href="/tags/%E5%85%B6%E4%BB%96/"  class="flex justify-between">
			  <span>其他</span>
			  <span>4</span>
			</a>
		  </li>
		
		  <li>
			<a href="/tags/c%E8%AF%AD%E8%A8%80/"  class="flex justify-between">
			  <span>c语言</span>
			  <span>6</span>
			</a>
		  </li>
		
		  <li>
			<a href="/tags/linux/"  class="flex justify-between">
			  <span>linux</span>
			  <span>10</span>
			</a>
		  </li>
		
		  <li>
			<a href="/tags/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8/"  class="flex justify-between">
			  <span>信息安全</span>
			  <span>4</span>
			</a>
		  </li>
		
		  <li>
			<a href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/"  class="flex justify-between">
			  <span>计算机网络</span>
			  <span>7</span>
			</a>
		  </li>
		
		  <li>
			<a href="/tags/java/"  class="flex justify-between">
			  <span>java</span>
			  <span>53</span>
			</a>
		  </li>
		
		  <li>
			<a href="/tags/nginx/"  class="flex justify-between">
			  <span>nginx</span>
			  <span>5</span>
			</a>
		  </li>
		
		  <li>
			<a href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/"  class="flex justify-between">
			  <span>数据库</span>
			  <span>7</span>
			</a>
		  </li>
		
		  <li>
			<a href="/tags/%E5%89%8D%E7%AB%AF/"  class="flex justify-between">
			  <span>前端</span>
			  <span>4</span>
			</a>
		  </li>
		
		  <li>
			<a href="/tags/http/"  class="flex justify-between">
			  <span>http</span>
			  <span>7</span>
			</a>
		  </li>
		
		  <li>
			<a href="/tags/python/"  class="flex justify-between">
			  <span>python</span>
			  <span>6</span>
			</a>
		  </li>
		
		  <li>
			<a href="/tags/git/"  class="flex justify-between">
			  <span>git</span>
			  <span>1</span>
			</a>
		  </li>
		
		  <li>
			<a href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"  class="flex justify-between">
			  <span>设计模式</span>
			  <span>10</span>
			</a>
		  </li>
		
		  <li>
			<a href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"  class="flex justify-between">
			  <span>数据结构</span>
			  <span>7</span>
			</a>
		  </li>
		
		  <li>
			<a href="/tags/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/"  class="flex justify-between">
			  <span>操作系统</span>
			  <span>5</span>
			</a>
		  </li>
		
		  <li>
			<a href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/"  class="flex justify-between">
			  <span>计算机组成原理</span>
			  <span>1</span>
			</a>
		  </li>
		
      
	
  
  </ul>
</nav>


    </aside>
  
 
        </header>
        
  
  <article class="markdown book-post">
    <h2>
      <a href="/posts/nginx/nginx/">nginx</a>
    </h2>
    
  <h5>2021-08-12</h5>



  

  
  <div>
    
      <a href="/tags/nginx/">nginx</a>
  </div>
  




    <p><ul>
<li>
<p>nginx默认的配置文件名是nginx.conf，位置在<code>/usr/local/nginx/conf</code>、<code>/etc/niginx</code>、或<code>/usr/local/etc/nginx</code>。通过<code>nginx -c xxx.conf</code>来指定配置文件。</p>
</li>
<li>
<p>当nginx启动后，可以通过<code>nginx -s signal</code>来控制nginx，signal可以是：</p>
<ul>
<li>stop：快速关闭；quit：正常关闭；reload：重新加载配置文件；reopen：重新打开配置文件。</li>
</ul>
</li>
<li>
<p>配置文件可以包含多个<code>server</code>块，他们之间通过监听的端口和服务名来区分。一旦nginx决定使用哪个服server来处理请求，他就会根据server块内location的指令来匹配请求头中的url，①精确匹配优先级最高，遇到就返回结果；②普通匹配会选择location中前缀最长的那个，和顺序无关；③当location中有正则表达式时，会优先匹配正则表达式（正则级别比普通匹配优先级高，但比精确匹配优先级低），正则表达式的匹配顺序按照文件中的物理顺序匹配，只要匹配到一条正则，就会返回结果；如果没有匹配，就会取普通匹配中最匹配的那个。</p>
</li>
<li>
<p>nginx的错误日志文件在<code>usr/local/nginx/logs</code>、<code>/var/log/nginx</code></p>
</li>
</ul>
<h2 id="常用配置">
  常用配置
  <a class="anchor" href="#%e5%b8%b8%e7%94%a8%e9%85%8d%e7%bd%ae">#</a>
</h2>
<h3 id="proxy_pass">
  proxy_pass
  <a class="anchor" href="#proxy_pass">#</a>
</h3>
<ul>
<li>使用<code>proxy_pass</code>来配置代理服务。代理服务的流程：server接收request-&gt;把request传给代理服务-&gt;获取代理服务的response-&gt;把response返回给客户端。</li>
<li>proxy_pass有两个要注意的点
<ul>
<li>proxy_pass后面如果跟了一个完整的url，如<code>http://localhost:8080/xxx</code>，那么最后访问的时候就是location中匹配的那一部分替换成proxy_pass的url。</li>
<li>proxy_pass后面如果跟的是如<code>http://localhost:8080</code>，那么最后访问的是proxy_pass的链接加上请求路径。</li>
</ul>
</li>
</ul>
<h3 id="例">
  例：
  <a class="anchor" href="#%e4%be%8b">#</a>
</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-nginx" data-lang="nginx"><span style="display:flex;"><span><span style="color:#66d9ef">server</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">listen</span> <span style="color:#ae81ff">80</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#最后的地址就是http://localhost:8080/journey/xxx
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#f92672">location</span> <span style="color:#e6db74">/journey</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">proxy_pass</span> <span style="color:#e6db74">http://localhost:8080</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#最后的地址就是http://localhost:8080/test/xxx，location对应的chat会被替换为url。
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#f92672">location</span> <span style="color:#e6db74">/chat</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">proxy_pass</span> <span style="color:#e6db74">http://localhost:8080/test</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#将会映射到/html/tool这个路径下
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#f92672">location</span> <span style="color:#e6db74">/tool</span> {
</span></span><span style="display:flex;"><span>    	<span style="color:#f92672">root</span> <span style="color:#e6db74">html</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#正则表达式以~开始，这里是匹配图片
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#f92672">location</span> ~ <span style="color:#e6db74">\.(gif|jpg|png)$</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">root</span> <span style="color:#e6db74">/data/images</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><strong>参考链接：</strong>
  <a href="http://nginx.org/en/docs/beginners_guide.html">Beginner’s Guide (nginx.org)</a></p>
<h2 id="nginx内嵌的变量">
  nginx内嵌的变量
  <a class="anchor" href="#nginx%e5%86%85%e5%b5%8c%e7%9a%84%e5%8f%98%e9%87%8f">#</a>
</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-nginx" data-lang="nginx"><span style="display:flex;"><span><span style="color:#75715e">#等于在proxy_pass指令中指定的被代理服务的主机名和端口
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">$proxy_host</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#等于在proxy_pass中指定的服务的端口，或者是其服务的默认端口
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>$proxy_port
</span></span><span style="display:flex;"><span><span style="color:#75715e">#如果X-Forwarded-For属性未在请求头中，$proxy_add_x_forwarded_for的值就等于$remote_addr;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#如果X-Forwarded-For在请求头中，那$proxy_add_x_forwarded_for的值就等于上一个$proxy_add_x_forwarded_for加上&#34;,$remote_addr&#34;。
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#例：proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>$proxy_add_x_forwarded_for
</span></span></code></pre></div><h2 id="nginx指令">
  nginx指令
  <a class="anchor" href="#nginx%e6%8c%87%e4%bb%a4">#</a>
</h2>
<h3 id="rewrite">
  rewrite
  <a class="anchor" href="#rewrite">#</a>
</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>语法: rewrite regex replacement <span style="color:#f92672">[</span>flag<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>context: server,location,if
</span></span><span style="display:flex;"><span>rewrite指令按照它出现的顺序来执行，可以通过flag来终止执行，如果replacement以<span style="color:#e6db74">&#34;http://,https://或者</span>$scheme<span style="color:#e6db74">&#34;</span>开始，就会直接返回客户端。
</span></span><span style="display:flex;"><span>flag可以是last、break、redirect、permanent。
</span></span><span style="display:flex;"><span>redirect是暂时重定向302，permanent是永久重定向301。
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>rewrite ^<span style="color:#f92672">(</span>.*<span style="color:#f92672">)</span>$ https://localhost$1 permanent;
</span></span></code></pre></div><h3 id="if">
  if
  <a class="anchor" href="#if">#</a>
</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>语法: <span style="color:#66d9ef">if</span><span style="color:#f92672">(</span>condition<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>...<span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>context: server, localtion
</span></span><span style="display:flex;"><span>condition包括：
</span></span><span style="display:flex;"><span>  1. 变量名，当变量为空或者为<span style="color:#e6db74">&#34;0&#34;</span>时是false；
</span></span><span style="display:flex;"><span>  2. 变量和字符串通过<span style="color:#e6db74">&#34;=&#34;</span>或者<span style="color:#e6db74">&#34;!=&#34;</span>来比较；
</span></span><span style="display:flex;"><span>  3. 变量和正则表达式比较【比较符号： ~（大小写敏感）、~*（大小写）不敏感、!~、!~*】，可以通过<span style="color:#f92672">()</span>来捕获数据。
</span></span><span style="display:flex;"><span>  4. 使用-f 或!-f检测文件书否存在；
</span></span><span style="display:flex;"><span>  5. 使用-d 或!-d检测目录是否存在；
</span></span><span style="display:flex;"><span>  6. 使用-e 或!-e 检测文件、目录、符号连接是否存在；
</span></span><span style="display:flex;"><span>  7. 使用-x 或!-x 检测是否是可执行文件。
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>$http_user_agent ~ MSIE<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    rewrite ^<span style="color:#f92672">(</span>.*<span style="color:#f92672">)</span>$ /msie/$1 break;
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>$http_cookie ~* <span style="color:#e6db74">&#34;id=([^;]+)(?:;|</span>$<span style="color:#e6db74">)&#34;</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    set $id $1;
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>$request_method <span style="color:#f92672">=</span> POST<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> 405;
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div><h3 id="return">
  return
  <a class="anchor" href="#return">#</a>
</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>语法: <span style="color:#66d9ef">return</span> code <span style="color:#f92672">[</span>text<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>     <span style="color:#66d9ef">return</span> code URL;
</span></span><span style="display:flex;"><span>     <span style="color:#66d9ef">return</span> URL;
</span></span><span style="display:flex;"><span>context: server,location,if
</span></span><span style="display:flex;"><span>返回特定的状态码，返回444会不发送响应头就关闭连接。
</span></span><span style="display:flex;"><span>可以指定一个重定向的URL（301，302，303，307，308），或者响应体text（其他的code）。
</span></span></code></pre></div><h3 id="set">
  set
  <a class="anchor" href="#set">#</a>
</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>语法: set $variable value;
</span></span><span style="display:flex;"><span>context: server,location,if
</span></span><span style="display:flex;"><span>给变量赋值，值可以是变量、字符串或者变量和字符串的组合。
</span></span></code></pre></div>
    </p>
  </article>
  
  <article class="markdown book-post">
    <h2>
      <a href="/posts/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/">网络安全</a>
    </h2>
    
  <h5>2021-08-01</h5>



  

  
  <div>
    
      <a href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/">计算机网络</a>, 
      <a href="/tags/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8/">信息安全</a>
  </div>
  




    <p><p>安全通信需要具有下列的特性</p>
<ul>
<li>
<p>机密性：仅有发送方和希望的接收方能够理解传输报文的内容。</p>
</li>
<li>
<p>报文完整性：确保其通信内容在传输的过程中未被改变。</p>
</li>
<li>
<p>端点鉴别：发送方和接收方都能证实通信过程所涉及的另一方。</p>
</li>
<li>
<p>运行安全性：确保网络安全。</p>
</li>
</ul>
<h2 id="密码学">
  密码学
  <a class="anchor" href="#%e5%af%86%e7%a0%81%e5%ad%a6">#</a>
</h2>
<p>报文的最初形式称为<strong>明文</strong></p>
<p>使用<strong>加密算法</strong>加密明文，生成的加密报文称为<strong>密文</strong>，加密算法往往是已知的。</p>
<p><strong>密钥</strong>K<sub>A</sub>是一串数字或者字符，加密算法以密钥和明文报文m为输入，生成的密文为输出。用K<sub>A</sub>(m)表示。</p>
<p>解密算法使用密钥K<sub>B</sub>和密文作为输入，通过计算K<sub>B</sub>(K<sub>A</sub>(m))得到m</p>
<h3 id="对称密钥密码体制">
  对称密钥密码体制
  <a class="anchor" href="#%e5%af%b9%e7%a7%b0%e5%af%86%e9%92%a5%e5%af%86%e7%a0%81%e4%bd%93%e5%88%b6">#</a>
</h3>
<ol>
<li>凯撒密码
<ul>
<li>将明文报文中的每个字母用字母表中该字母后第k个字母进行替换，允许回绕。</li>
<li>缺点：密钥值只有25个</li>
</ul>
</li>
<li>单码代替密码
<ul>
<li>使用字母表中的一个字母替换另一个字母。需要给定一个替换表，每个字母都有唯一一个的替换字母。</li>
<li>缺点：由于是定向替换，当对密文进行统计分析，并且常见的两三个字母的组合（in、on、the）往往是一起出现，而且如果入侵者知道该密文具有某些可能的东西，破解该密文就不那么困难了。</li>
</ul>
</li>
<li>多码代替密码
<ul>
<li>使用多个单码来替换明文的字母，即从多个字母中选一个代替明文中的一个字母，如何选怎呢？需要指定一个次序，比如第一次选择多个字母的第一个，第二次选择多个字母的第二个，第三次选择多个字母的第二个（122），然后按照这个顺序循环多次，直到完成加密。</li>
</ul>
</li>
</ol>
<p>块密码：要加密的报文被处理为k比特的块。例如。如果k=64，字报文被划分为多个64比特的块，每块被独立加密。</p>
<p><strong>密码块链接</strong>：使用块密码时，如果有多个明文块可能是相同的，将会产生相同的密文，解决方式是：发送方为第i个块生成一个随机的k比特数，通过将该数与第i个明文块异或，再将结果加密。该方法有一个问题，就是传输的时候需要两倍的带宽，块密码使用了一种称为密码块链接（Cipher Block Chaining，CBC）的技术，基本思想是只传输一个随机值，剩余的让发送方和接收方计算。流程如下：</p>
<ol>
<li>
<p>发送方生成一个随机的k比特串，称为初始向量c(0)，发送方以明文方式发送。</p>
</li>
<li>
<p>对于第一个块，发送方计算m(1)⊕c(0)，然后加密得到c(1)=K<sub>s</sub>(m(1)⊕c(0))。发送方向接收方发送加密块c(1)</p>
</li>
<li>
<p>对于第i个块，发送方根据c(i)=K<sub>s</sub>(m(1)⊕c(i-1))向接收方发送第i个密文块。</p>
</li>
</ol>
<h3 id="公开密钥加密">
  公开密钥加密
  <a class="anchor" href="#%e5%85%ac%e5%bc%80%e5%af%86%e9%92%a5%e5%8a%a0%e5%af%86">#</a>
</h3>
<p>世界上任何人都都可以得到<strong>公钥</strong>（public key）K<sub>B</sub><sup>+</sup></p>
<p>只有主人知道的<strong>私钥</strong>（private key）K<sub>B</sub><sup>-</sup></p>
<p>假如A要和B通信，A首先要取得B的公钥，然后用这个公钥和一个众所周知的加密算法加密他要传给B的报文m，即K<sub>B</sub><sup>+</sup>(m)，B接到A的加密报文后，用其私钥和一个众所周知的解密算法解密报文，即计算K<sub>B</sub><sup>-</sup>(K<sub>B</sub><sup>+</sup>(m))，这样就得到了最初的明文m。此外还有K<sub>B</sub><sup>-</sup>(K<sub>B</sub><sup>+</sup>(m)) = K<sub>B</sub><sup>+</sup>(K<sub>B</sub><sup>-</sup>(m))=m。</p>
<ol>
<li>RSA
<ul>
<li>生成RSA的公钥和私钥
<ol>
<li>选择两个大素数p和q，p和q越大，破解RSA越困难，执行加密和解密所用的时间也越长。推荐p和q的乘积为1024比特的数量级</li>
<li>计算n=pq，z=(p-1)(q-1)</li>
<li>选择一个小于n的数e，使得e和z没有公因数，e用来加密</li>
<li>求得一个数d使得ed-1可以被z整除，d将用来解密（ed mod z = 1）</li>
<li>外界可用的公钥K<sub>B</sub><sup>+</sup>是一对数（n，e），私钥K<sub>B</sub><sup>-</sup>是一对数（n，d）</li>
</ol>
</li>
<li>加密和解密过程
<ol>
<li>A给B发送一个由整数m表示的比特组合，m&lt;n。加密后的值c=m<sup>e</sup> mod n，将密文c发送给B</li>
<li>B通过计算获得m，m=c<sup>d</sup> mod n</li>
</ol>
</li>
</ul>
</li>
<li>会话密钥：RSA的指数运算极其耗时，在实际应用中，RSA通常与对称密钥结合使用。首先，A选择一个用于加密数据本身的密钥，这个密钥有时候称为会话密钥K<sub>s</sub>。A通过公钥将K<sub>s</sub>传输给B，B通过私钥解密后，就获取了K<sub>s</sub>，然后使用K<sub>s</sub>来传输数据。</li>
</ol>
<h2 id="报文完整性和数字签名">
  报文完整性和数字签名
  <a class="anchor" href="#%e6%8a%a5%e6%96%87%e5%ae%8c%e6%95%b4%e6%80%a7%e5%92%8c%e6%95%b0%e5%ad%97%e7%ad%be%e5%90%8d">#</a>
</h2>
<h3 id="密码散列函数">
  密码散列函数
  <a class="anchor" href="#%e5%af%86%e7%a0%81%e6%95%a3%e5%88%97%e5%87%bd%e6%95%b0">#</a>
</h3>
<p>密码散列函数的性质：找到任意两个不同的报文x和y使得H(x)=H(y)，在计算上是不可能的。</p>
<p>算法：MD5(128位)、SHA-1(160位)</p>
<p>为了执行报文完整性，A和B需要共享秘密s，这个共享的秘密是个比特串，被称为<strong>鉴别密钥</strong>。使用这个共享秘密，报文完整性能够执行如下：</p>
<ol>
<li>A生成报文m，用s级联m生成m+s，并计算散列H(m+s)。H(m+s)被称为<strong>报文鉴别码</strong>(Message Authentication Code,MAC)。</li>
<li>A将MAC附加到报文m上，生成扩展报文(m,H(m+s))，将该扩展报文发送给B。</li>
<li>B收到扩展报文(m,h)，由于知道s，计算出报文鉴别码H(m+s)，如果其等于h，则证明一切正常。</li>
</ol>
<h3 id="数字签名">
  数字签名
  <a class="anchor" href="#%e6%95%b0%e5%ad%97%e7%ad%be%e5%90%8d">#</a>
</h3>
<p>数字签名是B先使用散列函数对报文生成散列，使用私钥对散列进行加密（数字签名）。</p>
<p>A获取到了B的明文报文和已经数字签名的报文摘要，先使用B的公钥解密数字签名，得到一个散列结果，再使用散列函数获取报文的散列，如果这两个散列匹配，则可以确信报文的完整性和发送方。</p>
<h3 id="公钥认证">
  公钥认证
  <a class="anchor" href="#%e5%85%ac%e9%92%a5%e8%ae%a4%e8%af%81">#</a>
</h3>
<p>证实一个公钥属于某个特定的实体。</p>
<p>将公钥与特定的实体绑定通常是由认证中心（Certification Authority，CA）完成的。CA证实了一个实体的真实身份；一旦CA验证了某个实体的身份，这个CA会生成一个将其身份和实体的公钥绑定起来的证书。</p>
<h2 id="使tcp连接安全ssl">
  使TCP连接安全：SSL
  <a class="anchor" href="#%e4%bd%bftcp%e8%bf%9e%e6%8e%a5%e5%ae%89%e5%85%a8ssl">#</a>
</h2>
<p>SSL：Secure Socket Layer，安全套接口协议</p>
<p>TLS：Transport Layer Security，TLS 运输层安全性，是SSL版本3的一个稍加修改的版本</p>
    </p>
  </article>
  
  <article class="markdown book-post">
    <h2>
      <a href="/posts/javase/equals/">equals</a>
    </h2>
    
  <h5>2021-04-26</h5>



  

  
  <div>
    
      <a href="/tags/java/">java</a>
  </div>
  




    <p><h2 id="object">
  Object
  <a class="anchor" href="#object">#</a>
</h2>
<ul>
<li>Object的equals方法</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">boolean</span> <span style="color:#a6e22e">equals</span><span style="color:#f92672">(</span>Object obj<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#f92672">(</span><span style="color:#66d9ef">this</span> <span style="color:#f92672">==</span> obj<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span></code></pre></div><ul>
<li>Object的toString方法</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>	<span style="color:#66d9ef">public</span> String <span style="color:#a6e22e">toString</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> getClass<span style="color:#f92672">().</span><span style="color:#a6e22e">getName</span><span style="color:#f92672">()</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;@&#34;</span> <span style="color:#f92672">+</span> Integer<span style="color:#f92672">.</span><span style="color:#a6e22e">toHexString</span><span style="color:#f92672">(</span>hashCode<span style="color:#f92672">());</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span></code></pre></div><h2 id="string">
  String
  <a class="anchor" href="#string">#</a>
</h2>
<ul>
<li>String的equals方法</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">boolean</span> <span style="color:#a6e22e">equals</span><span style="color:#f92672">(</span>Object anObject<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">//如果指向的是同一个对象就返回true
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span><span style="color:#66d9ef">this</span> <span style="color:#f92672">==</span> anObject<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">//如果该对象是String的实例
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>anObject <span style="color:#66d9ef">instanceof</span> String<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>            String anotherString <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>String<span style="color:#f92672">)</span>anObject<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">//value存放的是String本身的字符串
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>            <span style="color:#66d9ef">int</span> n <span style="color:#f92672">=</span> value<span style="color:#f92672">.</span><span style="color:#a6e22e">length</span><span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">//如果两个字符串的长度相等
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>            <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>n <span style="color:#f92672">==</span> anotherString<span style="color:#f92672">.</span><span style="color:#a6e22e">value</span><span style="color:#f92672">.</span><span style="color:#a6e22e">length</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">char</span> v1<span style="color:#f92672">[]</span> <span style="color:#f92672">=</span> value<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">char</span> v2<span style="color:#f92672">[]</span> <span style="color:#f92672">=</span> anotherString<span style="color:#f92672">.</span><span style="color:#a6e22e">value</span><span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span><span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">//按下标比较两个字符串的字符
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#66d9ef">while</span> <span style="color:#f92672">(</span>n<span style="color:#f92672">--</span> <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>v1<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span> <span style="color:#f92672">!=</span> v2<span style="color:#f92672">[</span>i<span style="color:#f92672">])</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">false</span><span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>                    i<span style="color:#f92672">++;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">false</span><span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span></code></pre></div><ul>
<li>String的hashCode方法</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>	<span style="color:#66d9ef">private</span> <span style="color:#66d9ef">int</span> hash<span style="color:#f92672">;</span> <span style="color:#75715e">// Default to 0	
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#75715e">//...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#75715e">//当通过new String(&#34;xxx&#34;)方式创建的字符串，原hash就被赋值给了现在的hash
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">public</span> <span style="color:#a6e22e">String</span><span style="color:#f92672">(</span>String original<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">value</span> <span style="color:#f92672">=</span> original<span style="color:#f92672">.</span><span style="color:#a6e22e">value</span><span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">hash</span> <span style="color:#f92672">=</span> original<span style="color:#f92672">.</span><span style="color:#a6e22e">hash</span><span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">//当hash为0并且字符串长度不为0时，现在的hash是通过循环计算出来的
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#75715e">//由该计算可知道，当字符串一样，它的hashcode就一样
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">hashCode</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">int</span> h <span style="color:#f92672">=</span> hash<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>h <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span> <span style="color:#f92672">&amp;&amp;</span> value<span style="color:#f92672">.</span><span style="color:#a6e22e">length</span> <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">char</span> val<span style="color:#f92672">[]</span> <span style="color:#f92672">=</span> value<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span><span style="color:#f92672">;</span> i <span style="color:#f92672">&lt;</span> value<span style="color:#f92672">.</span><span style="color:#a6e22e">length</span><span style="color:#f92672">;</span> i<span style="color:#f92672">++)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>                h <span style="color:#f92672">=</span> <span style="color:#ae81ff">31</span> <span style="color:#f92672">*</span> h <span style="color:#f92672">+</span> val<span style="color:#f92672">[</span>i<span style="color:#f92672">];</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>            hash <span style="color:#f92672">=</span> h<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> h<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span></code></pre></div>
    </p>
  </article>
  
  <article class="markdown book-post">
    <h2>
      <a href="/posts/javaee/maven-dependency-scope/">maven-dependency-scope</a>
    </h2>
    
  <h5>2021-04-23</h5>



  

  
  <div>
    
      <a href="/tags/java/">java</a>
  </div>
  




    <p><h2 id="共6个作用域">
  共6个作用域
  <a class="anchor" href="#%e5%85%b16%e4%b8%aa%e4%bd%9c%e7%94%a8%e5%9f%9f">#</a>
</h2>
<ol>
<li>
<p>compile</p>
<ul>
<li>默认作用域，在项目的编译、运行、测试中都有效，依赖传递</li>
</ul>
</li>
<li>
<p>provided</p>
<ul>
<li>在项目编译、测试中有效，运行中无效；依赖不传递，适用于一些web容器提供了运行时的依赖的情况。</li>
</ul>
</li>
<li>
<p>runtime</p>
<ul>
<li>只在项目运行、测试中有效，依赖传递</li>
</ul>
</li>
<li>
<p>test</p>
<ul>
<li>表示程序正常使用时不需要该依赖，只在测试编译和执行中有效。依赖不传递</li>
</ul>
</li>
<li>
<p>system</p>
<ul>
<li>和provided很像，但是必须明确指定jar路径，它不在仓库中去寻找</li>
</ul>
</li>
<li>
<p>import</p>
<ul>
<li>该作用域仅适用于<code>&lt;dependencyManagement&gt;</code>中type为pom的情况。</li>
<li>
  <a href="http://maven.apache.org/guides/introduction/introduction-to-dependency-mechanism.html#Importing_Dependencies">Importing Dependencyies</a></li>
</ul>
</li>
</ol>
    </p>
  </article>
  
  <article class="markdown book-post">
    <h2>
      <a href="/posts/javase/%E6%89%A7%E8%A1%8Cssh%E5%91%BD%E4%BB%A4/">执行ssh命令</a>
    </h2>
    
  <h5>2021-04-19</h5>



  

  
  <div>
    
      <a href="/tags/java/">java</a>
  </div>
  




    <p><ul>
<li>如何使用ssh连接linux执行shell命令？</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#f92672">package</span> space.xiaoxiang<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> com.jcraft.jsch.ChannelExec<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> com.jcraft.jsch.JSch<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> com.jcraft.jsch.JSchException<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> com.jcraft.jsch.Session<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> java.io.BufferedReader<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> java.io.IOException<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> java.io.InputStream<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> java.io.InputStreamReader<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * 通过ssh连接到linux主机，并执行一些shell命令，需要导入JSch这个包
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> */</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">App</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> String host <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;localhost&#34;</span><span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span> port <span style="color:#f92672">=</span> <span style="color:#ae81ff">22</span><span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> String username <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;xiaoxiang&#34;</span><span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> String password <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;asdf&#34;</span><span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">//连接到linux主机
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">public</span> Session <span style="color:#a6e22e">connect</span><span style="color:#f92672">()</span> <span style="color:#66d9ef">throws</span>  JSchException <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        JSch jsch <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> JSch<span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>        Session session <span style="color:#f92672">=</span> jsch<span style="color:#f92672">.</span><span style="color:#a6e22e">getSession</span><span style="color:#f92672">(</span>username<span style="color:#f92672">,</span> host<span style="color:#f92672">,</span> port<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>        session<span style="color:#f92672">.</span><span style="color:#a6e22e">setPassword</span><span style="color:#f92672">(</span>password<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>        session<span style="color:#f92672">.</span><span style="color:#a6e22e">setConfig</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;StrictHostKeyChecking&#34;</span><span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;no&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">//开启会话
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        session<span style="color:#f92672">.</span><span style="color:#a6e22e">connect</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> session<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">//执行shell命令
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">execCommand</span><span style="color:#f92672">(</span>Session session<span style="color:#f92672">,</span> String command<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> JSchException<span style="color:#f92672">,</span> IOException <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        ChannelExec channelExec <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>ChannelExec<span style="color:#f92672">)</span> session<span style="color:#f92672">.</span><span style="color:#a6e22e">openChannel</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;exec&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>        InputStream in <span style="color:#f92672">=</span> channelExec<span style="color:#f92672">.</span><span style="color:#a6e22e">getInputStream</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>        channelExec<span style="color:#f92672">.</span><span style="color:#a6e22e">setCommand</span><span style="color:#f92672">(</span>command<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>        BufferedReader reader <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> BufferedReader<span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> InputStreamReader<span style="color:#f92672">(</span>channelExec<span style="color:#f92672">.</span><span style="color:#a6e22e">getInputStream</span><span style="color:#f92672">()));</span>
</span></span><span style="display:flex;"><span>        channelExec<span style="color:#f92672">.</span><span style="color:#a6e22e">connect</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>        String line<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">while</span><span style="color:#f92672">((</span>line <span style="color:#f92672">=</span> reader<span style="color:#f92672">.</span><span style="color:#a6e22e">readLine</span><span style="color:#f92672">())</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">){</span>
</span></span><span style="display:flex;"><span>            System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span>line<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>        channelExec<span style="color:#f92672">.</span><span style="color:#a6e22e">disconnect</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span><span style="color:#f92672">(</span>String<span style="color:#f92672">[]</span> args<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> IOException<span style="color:#f92672">,</span> JSchException <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        App app <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> App<span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>        Session session <span style="color:#f92672">=</span> app<span style="color:#f92672">.</span><span style="color:#a6e22e">connect</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>        app<span style="color:#f92672">.</span><span style="color:#a6e22e">execCommand</span><span style="color:#f92672">(</span>session<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;ls -l&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>        System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;----------&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>        app<span style="color:#f92672">.</span><span style="color:#a6e22e">execCommand</span><span style="color:#f92672">(</span>session<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;df -h&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>        session<span style="color:#f92672">.</span><span style="color:#a6e22e">disconnect</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div>
    </p>
  </article>
  
  <article class="markdown book-post">
    <h2>
      <a href="/posts/javaee/mybatis%E5%85%A5%E9%97%A8/">mybatis入门</a>
    </h2>
    
  <h5>2021-04-02</h5>



  

  
  <div>
    
      <a href="/tags/java/">java</a>
  </div>
  




    <p><ol>
<li>写mybatis配置文件</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#75715e">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; ?&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">&lt;!DOCTYPE configuration
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">        PUBLIC &#34;-//mybatis.org//DTD Config 3.0//EN&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">        &#34;http://mybatis.org/dtd/mybatis-3-config.dtd&#34;&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;configuration&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">&lt;!--数据库配置文件路径--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">&lt;!--&lt;properties resource=&#34;config.properties&#34;/&gt;--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;environments</span> <span style="color:#a6e22e">default=</span><span style="color:#e6db74">&#34;dev&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;environment</span> <span style="color:#a6e22e">id=</span><span style="color:#e6db74">&#34;dev&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;transactionManager</span> <span style="color:#a6e22e">type=</span><span style="color:#e6db74">&#34;JDBC&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;dataSource</span> <span style="color:#a6e22e">type=</span><span style="color:#e6db74">&#34;POOLED&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&lt;property</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;driver&#34;</span> <span style="color:#a6e22e">value=</span><span style="color:#e6db74">&#34;${driver}&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&lt;property</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;url&#34;</span> <span style="color:#a6e22e">value=</span><span style="color:#e6db74">&#34;${url}&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&lt;property</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;username&#34;</span> <span style="color:#a6e22e">value=</span><span style="color:#e6db74">&#34;${username}&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&lt;property</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;password&#34;</span> <span style="color:#a6e22e">value=</span><span style="color:#e6db74">&#34;${password}&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;/dataSource&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;/environment&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/environments&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">&lt;!--映射文件位置--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;mappers&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;mapper</span> <span style="color:#a6e22e">resource=</span><span style="color:#e6db74">&#34;space/xiaoxiang/dao/XxxxMapper.xml&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">&lt;!--&lt;package name=&#34;space.xiaoxiang.dao&#34;/&gt; 使用package接口的包名必须与xml包名一样--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/mappers&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/configuration&gt;</span>
</span></span></code></pre></div><ol start="2">
<li>数据库配置文件config.properties</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-properties" data-lang="properties"><span style="display:flex;"><span><span style="color:#a6e22e">driver</span><span style="color:#f92672">=</span><span style="color:#e6db74">com.mysql.cj.jdbc.Driver</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">url</span><span style="color:#f92672">=</span><span style="color:#e6db74">jdbc:mysql://localhost:3306/xxxxx?serverTimezone=GMT%2B8&amp;characterEncoding=utf-8</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">username</span><span style="color:#f92672">=</span><span style="color:#e6db74">xxxx</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">password</span><span style="color:#f92672">=</span><span style="color:#e6db74">xxxxxxxx</span>
</span></span></code></pre></div><ol start="3">
<li>
<p>写dao层接口和xml文件</p>
<ol>
<li>接口</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#f92672">package</span> space.xiaoxiang.dao<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> java.util.List<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> java.util.Map<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">XxxxMapper</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> List<span style="color:#f92672">&lt;</span>Map<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">,</span> Object<span style="color:#f92672">&gt;&gt;</span> <span style="color:#a6e22e">selectAll</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div><ol start="2">
<li>xml文件</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#75715e">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; ?&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">&lt;!DOCTYPE mapper
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">        PUBLIC &#34;-//mybatis.org//DTD Mapper 3.0//EN&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">        &#34;http://mybatis.org/dtd/mybatis-3-mapper.dtd&#34;&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;mapper</span> <span style="color:#a6e22e">namespace=</span><span style="color:#e6db74">&#34;space.xiaoxiang.dao.XxxxtMapper&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;select</span> <span style="color:#a6e22e">id=</span><span style="color:#e6db74">&#34;selectAll&#34;</span> <span style="color:#a6e22e">resultType=</span><span style="color:#e6db74">&#34;map&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>        SELECT * FROM xxxx
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/select&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/mapper&gt;</span>
</span></span></code></pre></div></li>
<li>
<p>运行</p>
</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#a6e22e">@Test</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">test</span><span style="color:#f92672">()</span> <span style="color:#66d9ef">throws</span> IOException <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">//数据库配置文件
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    String databaseConfigFileName <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;config.properties&#34;</span><span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>    Properties databaseConfig <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Properties<span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>    databaseConfig<span style="color:#f92672">.</span><span style="color:#a6e22e">load</span><span style="color:#f92672">(</span>Resources<span style="color:#f92672">.</span><span style="color:#a6e22e">getResourceAsStream</span><span style="color:#f92672">(</span>databaseConfigFileName<span style="color:#f92672">));</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">//mybatis配置文件
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    String mybatisConfigFileName <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;mybatis-config.xml&#34;</span><span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>    InputStream mybatisConfig <span style="color:#f92672">=</span> Resources<span style="color:#f92672">.</span><span style="color:#a6e22e">getResourceAsStream</span><span style="color:#f92672">(</span>mybatisConfigFileName<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">//一个数据库对应一个SqlSessionFactory
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    SqlSessionFactory sqlSessionFactory <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> SqlSessionFactoryBuilder<span style="color:#f92672">().</span><span style="color:#a6e22e">build</span><span style="color:#f92672">(</span>mybatisConfig<span style="color:#f92672">,</span>databaseConfig<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span> <span style="color:#f92672">(</span>SqlSession sqlSession <span style="color:#f92672">=</span> sqlSessionFactory<span style="color:#f92672">.</span><span style="color:#a6e22e">openSession</span><span style="color:#f92672">())</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        XxxxMapper xxxxMapper <span style="color:#f92672">=</span> sqlSession<span style="color:#f92672">.</span><span style="color:#a6e22e">getMapper</span><span style="color:#f92672">(</span>XxxxMapper<span style="color:#f92672">.</span><span style="color:#a6e22e">class</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>        xxxxMapper<span style="color:#f92672">.</span><span style="color:#a6e22e">selectAll</span><span style="color:#f92672">().</span><span style="color:#a6e22e">forEach</span><span style="color:#f92672">((</span>map<span style="color:#f92672">)</span> <span style="color:#f92672">-&gt;</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>            xxxxMapper<span style="color:#f92672">.</span><span style="color:#a6e22e">forEach</span><span style="color:#f92672">((</span>k<span style="color:#f92672">,</span> v<span style="color:#f92672">)</span> <span style="color:#f92672">-&gt;</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>                System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span>k <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34; : &#34;</span> <span style="color:#f92672">+</span> v<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">});</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">});</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div>
    </p>
  </article>
  
  <article class="markdown book-post">
    <h2>
      <a href="/posts/javaee/zookeeper%E8%B5%B7%E6%AD%A5/">zookeeper起步</a>
    </h2>
    
  <h5>2021-03-27</h5>



  

  
  <div>
    
      <a href="/tags/java/">java</a>
  </div>
  




    <p><ul>
<li>
<p><code>zkCli.sh -server localhost:2181</code>：连接到zookeeper</p>
</li>
<li>
<p>复制模式下的配置小结（以3台linux举例）</p>
<ol>
<li>为每一台linux安装上zookeeper</li>
<li>修改他们的配置文件zoo.cfg（3份可以一样）</li>
<li>在dataDir路径下创建myid文件，里面写一个数字，与server.x的x对应</li>
<li>每一台都启动zookeeper</li>
</ol>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-properties" data-lang="properties"><span style="display:flex;"><span><span style="color:#75715e">#zookeeper使用的基本时间单位</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">tickTime</span><span style="color:#f92672">=</span><span style="color:#e6db74">2000</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#存储内存数据库快照的位置</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">dataDir</span><span style="color:#f92672">=</span><span style="color:#e6db74">/var/lib/zookeeper</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#对client端提供服务</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">clientPort</span><span style="color:#f92672">=</span><span style="color:#e6db74">2181</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#超时</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">initLimit</span><span style="color:#f92672">=</span><span style="color:#e6db74">5</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#限制服务器与领导者之间过时的距离</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">syncLimit</span><span style="color:#f92672">=</span><span style="color:#e6db74">2</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#server.X格式列出了组成zookeeper服务的服务器。服务器启动时，它通过在数据目录中查找文件myid*来知道它是哪台服务器。</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#2888集群内机器通信使用，3888选举leader使用</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">server.1</span><span style="color:#f92672">=</span><span style="color:#e6db74">zoo1:2888:3888</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">server.2</span><span style="color:#f92672">=</span><span style="color:#e6db74">zoo2:2888:3888</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">server.3</span><span style="color:#f92672">=</span><span style="color:#e6db74">zoo3:2888:3888</span>
</span></span></code></pre></div><ul>
<li><code>zkServer.sh start</code>：启动zookeeper</li>
<li><code>zkServer.sh status</code>：查看当前状态</li>
<li><code>zkCli.sh -server 127.0.0.1:2181</code>：连接到zookeeper
<ul>
<li><code>ls /</code></li>
<li><code>create /zk_test my_data</code>：创建一个新的znode，并将字符串my_data与该节点关联</li>
<li><code>get /zk_test</code>：验证数据是否与znode关联</li>
<li><code>set /zk_test junk</code>：来更改与zk_test相关的数据</li>
<li><code>delete /zk_test</code></li>
</ul>
</li>
</ul>
<h2 id="znode">
  Znode
  <a class="anchor" href="#znode">#</a>
</h2>
<ul>
<li>组成
<ul>
<li>data：Znode存储的数据信息</li>
<li>stat：包含Znode的各种元数据，如事务ID、版本号、时间戳、大小等</li>
<li>child：当前节点的子节点引用</li>
<li>acl：<code>access control list</code>访问控制表，表示哪些人或哪些ip可以访问本节点</li>
</ul>
</li>
<li>Znode是用来存储少量的状态和配置信息，每个节点的数据最大不能超过1MB</li>
</ul>
    </p>
  </article>
  
  <article class="markdown book-post">
    <h2>
      <a href="/posts/%E6%95%B0%E6%8D%AE%E5%BA%93/clickhouse%E7%B1%BB%E5%9E%8B%E5%8F%8A%E5%87%BD%E6%95%B0/">clickhouse类型及函数</a>
    </h2>
    
  <h5>2021-03-25</h5>



  

  
  <div>
    
      <a href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a>
  </div>
  




    <p><h2 id="类型">
  类型
  <a class="anchor" href="#%e7%b1%bb%e5%9e%8b">#</a>
</h2>
<h3 id="decimalps-decimal32s-decimal64s-decimal128s">
  Decimal(P,S), Decimal32(S), Decimal64(S), Decimal128(S)
  <a class="anchor" href="#decimalps-decimal32s-decimal64s-decimal128s">#</a>
</h3>
<ul>
<li>有符号的<strong>定点数</strong>，可在加减乘中保持精度，除法的最低有效数字会被丢弃（不舍入）</li>
</ul>
<h4 id="参数">
  参数
  <a class="anchor" href="#%e5%8f%82%e6%95%b0">#</a>
</h4>
<ul>
<li>P表示精度，有效范围是[1:38]，决定可以有多少个十进制的数字</li>
<li>S表示规模，有效范围是[0:P]，决定数字的小数部分中包含的小数位数</li>
<li>P[1:9]对应Decimal32(S)</li>
<li>P[10:18]对应Decimal64(S)</li>
<li>P[19:38]对应Decimal128(S)</li>
<li>
  <a href="https://clickhouse.tech/docs/zh/single/#decimalp-s-decimal32s-decimal64s-decimal128s">精度</a></li>
</ul>
<h2 id="函数">
  函数
  <a class="anchor" href="#%e5%87%bd%e6%95%b0">#</a>
</h2>
<h3 id="parsedatetimebestefforttime_string-time_zone">
  parseDateTimeBestEffort(time_string[, time_zone])
  <a class="anchor" href="#parsedatetimebestefforttime_string-time_zone">#</a>
</h3>
<ul>
<li>把其他类型的时间日期转换为DateTime数据类型。</li>
<li>支持的格式：<code>timestamp</code> <code>YYYYMMDDHHMMSS </code> <code>DD/MM/YYYY hh:mm:ss </code> <code>YYYY-MM-DD hh:mm:ss</code>等</li>
</ul>
<h3 id="show-create-table">
  SHOW CREATE TABLE
  <a class="anchor" href="#show-create-table">#</a>
</h3>
<ul>
<li>返回创建该表的语句</li>
</ul>
<h3 id="类型转换">
  类型转换
  <a class="anchor" href="#%e7%b1%bb%e5%9e%8b%e8%bd%ac%e6%8d%a2">#</a>
</h3>
<ul>
<li>clickhouse是强类型，他不会在类型之间进行隐式转换。</li>
</ul>
<h3 id="totypenamex">
  toTypeName(x)
  <a class="anchor" href="#totypenamex">#</a>
</h3>
<ul>
<li>返回该参数的类型</li>
</ul>
    </p>
  </article>
  

  
    <ul class="pagination pagination-default">
      <li class="page-item">
        <a href="/posts/" aria-label="First" class="page-link" role="button"><span aria-hidden="true">&laquo;&laquo;</span></a>
      </li>
      <li class="page-item">
        <a href="/posts/page/9/" aria-label="Previous" class="page-link" role="button"><span aria-hidden="true">&laquo;</span></a>
      </li>
      <li class="page-item">
        <a href="/posts/page/8/" aria-label="Page 8" class="page-link" role="button">8</a>
      </li>
      <li class="page-item">
        <a href="/posts/page/9/" aria-label="Page 9" class="page-link" role="button">9</a>
      </li>
      <li class="page-item active">
        <a aria-current="page" aria-label="Page 10" class="page-link" role="button">10</a>
      </li>
      <li class="page-item">
        <a href="/posts/page/11/" aria-label="Page 11" class="page-link" role="button">11</a>
      </li>
      <li class="page-item">
        <a href="/posts/page/12/" aria-label="Page 12" class="page-link" role="button">12</a>
      </li>
      <li class="page-item">
        <a href="/posts/page/11/" aria-label="Next" class="page-link" role="button"><span aria-hidden="true">&raquo;</span></a>
      </li>
      <li class="page-item">
        <a href="/posts/page/19/" aria-label="Last" class="page-link" role="button"><span aria-hidden="true">&raquo;&raquo;</span></a>
      </li>
    </ul>
 
	    </div>

      <footer class="page-footer">
        
  


 
      </footer>
    </div>

  </main>

</body>
</html>











