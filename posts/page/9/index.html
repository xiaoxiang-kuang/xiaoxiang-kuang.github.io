<!DOCTYPE html>
<html dir="ltr">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
<meta name="theme-color" content="#FFFFFF">
<meta name="color-scheme" content="light dark">

<title>主页 | 小象的blog</title>
<link rel="manifest" href="/manifest.json">
<link rel="icon" href="/favicon.png" type="image/x-icon">
<link rel="stylesheet" href="/book.min.e24d94cf619e7e6705439036ee43e77f243d24ac89100b59375379bc4d659d87.css" >
  <script defer src="/sw.min.6f6f90fcb8eb1c49ec389838e6b801d0de19430b8e516902f8d75c3c8bd98739.js" ></script>
<link rel="alternate" type="application/rss+xml" href="/posts/index.xml" title="小象的blog" />
<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->
</head>
<body dir="ltr">
  <input type="checkbox" class="hidden toggle" id="toc-control" />
  <main class="container flex">

    <aside class="book-menu">
      <div class="book-menu-content">
        
  <nav>
<h2 class="book-brand">
  <a class="flex align-center" href="/"><img src="/logo.png" alt="Logo" /><span>小象的blog</span>
  </a>
</h2>


















  
<ul>
  
  <li>
    <a href="/posts/">
        主页
      </a>
  </li>
  
  <li>
    <a href="/posts/linux/linux%E5%91%BD%E4%BB%A4/">
        linux命令总结
      </a>
  </li>
  
  <li>
    <a href="/posts/linux/shell%E8%84%9A%E6%9C%AC/">
        shell脚本
      </a>
  </li>
  
  <li>
    <a href="/categories/book/">
        书籍笔记
      </a>
  </li>
  
  <li>
    <a href="/about/">
        关于
      </a>
  </li>
  
</ul>





</nav>




  <script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>


  <div class="split-line"></div>
  
  
<nav>
  <ul>
  
    
	  
	
  
    
	  
		
		  <li>
			<a href="/tags/bios/"  class="flex justify-between">
			  <span>bios</span>
			  <span>11</span>
			</a>
		  </li>
		
		  <li>
			<a href="/tags/%E5%85%B6%E4%BB%96/"  class="flex justify-between">
			  <span>其他</span>
			  <span>4</span>
			</a>
		  </li>
		
		  <li>
			<a href="/tags/c%E8%AF%AD%E8%A8%80/"  class="flex justify-between">
			  <span>c语言</span>
			  <span>6</span>
			</a>
		  </li>
		
		  <li>
			<a href="/tags/linux/"  class="flex justify-between">
			  <span>linux</span>
			  <span>10</span>
			</a>
		  </li>
		
		  <li>
			<a href="/tags/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8/"  class="flex justify-between">
			  <span>信息安全</span>
			  <span>4</span>
			</a>
		  </li>
		
		  <li>
			<a href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/"  class="flex justify-between">
			  <span>计算机网络</span>
			  <span>7</span>
			</a>
		  </li>
		
		  <li>
			<a href="/tags/java/"  class="flex justify-between">
			  <span>java</span>
			  <span>53</span>
			</a>
		  </li>
		
		  <li>
			<a href="/tags/nginx/"  class="flex justify-between">
			  <span>nginx</span>
			  <span>5</span>
			</a>
		  </li>
		
		  <li>
			<a href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/"  class="flex justify-between">
			  <span>数据库</span>
			  <span>7</span>
			</a>
		  </li>
		
		  <li>
			<a href="/tags/%E5%89%8D%E7%AB%AF/"  class="flex justify-between">
			  <span>前端</span>
			  <span>4</span>
			</a>
		  </li>
		
		  <li>
			<a href="/tags/http/"  class="flex justify-between">
			  <span>http</span>
			  <span>7</span>
			</a>
		  </li>
		
		  <li>
			<a href="/tags/python/"  class="flex justify-between">
			  <span>python</span>
			  <span>6</span>
			</a>
		  </li>
		
		  <li>
			<a href="/tags/git/"  class="flex justify-between">
			  <span>git</span>
			  <span>1</span>
			</a>
		  </li>
		
		  <li>
			<a href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"  class="flex justify-between">
			  <span>设计模式</span>
			  <span>10</span>
			</a>
		  </li>
		
		  <li>
			<a href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"  class="flex justify-between">
			  <span>数据结构</span>
			  <span>7</span>
			</a>
		  </li>
		
		  <li>
			<a href="/tags/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/"  class="flex justify-between">
			  <span>操作系统</span>
			  <span>5</span>
			</a>
		  </li>
		
		  <li>
			<a href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/"  class="flex justify-between">
			  <span>计算机组成原理</span>
			  <span>1</span>
			</a>
		  </li>
		
      
	
  
  </ul>
</nav>


 
      </div>
    </aside>

    <div class="book-page">
      <div>
	      <header class="book-header">
          
  <div class="flex align-center justify-between">
   <label for="toc-control">
    
    <img src="/svg/toc.svg" class="book-icon" alt="Table of Contents" />
    
  </label>
  
  <strong>主页</strong>
</div>


  
    <aside class="hidden clearfix">
      <nav>
        




        








        

  
<ul>
  
  <li>
    <a href="/posts/">
        主页
      </a>
  </li>
  
  <li>
    <a href="/posts/linux/linux%E5%91%BD%E4%BB%A4/">
        linux命令总结
      </a>
  </li>
  
  <li>
    <a href="/posts/linux/shell%E8%84%9A%E6%9C%AC/">
        shell脚本
      </a>
  </li>
  
  <li>
    <a href="/categories/book/">
        书籍笔记
      </a>
  </li>
  
  <li>
    <a href="/about/">
        关于
      </a>
  </li>
  
</ul>





      </nav>
      <div class="split-line"></div>
      
  
<nav>
  <ul>
  
    
	  
	
  
    
	  
		
		  <li>
			<a href="/tags/bios/"  class="flex justify-between">
			  <span>bios</span>
			  <span>11</span>
			</a>
		  </li>
		
		  <li>
			<a href="/tags/%E5%85%B6%E4%BB%96/"  class="flex justify-between">
			  <span>其他</span>
			  <span>4</span>
			</a>
		  </li>
		
		  <li>
			<a href="/tags/c%E8%AF%AD%E8%A8%80/"  class="flex justify-between">
			  <span>c语言</span>
			  <span>6</span>
			</a>
		  </li>
		
		  <li>
			<a href="/tags/linux/"  class="flex justify-between">
			  <span>linux</span>
			  <span>10</span>
			</a>
		  </li>
		
		  <li>
			<a href="/tags/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8/"  class="flex justify-between">
			  <span>信息安全</span>
			  <span>4</span>
			</a>
		  </li>
		
		  <li>
			<a href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/"  class="flex justify-between">
			  <span>计算机网络</span>
			  <span>7</span>
			</a>
		  </li>
		
		  <li>
			<a href="/tags/java/"  class="flex justify-between">
			  <span>java</span>
			  <span>53</span>
			</a>
		  </li>
		
		  <li>
			<a href="/tags/nginx/"  class="flex justify-between">
			  <span>nginx</span>
			  <span>5</span>
			</a>
		  </li>
		
		  <li>
			<a href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/"  class="flex justify-between">
			  <span>数据库</span>
			  <span>7</span>
			</a>
		  </li>
		
		  <li>
			<a href="/tags/%E5%89%8D%E7%AB%AF/"  class="flex justify-between">
			  <span>前端</span>
			  <span>4</span>
			</a>
		  </li>
		
		  <li>
			<a href="/tags/http/"  class="flex justify-between">
			  <span>http</span>
			  <span>7</span>
			</a>
		  </li>
		
		  <li>
			<a href="/tags/python/"  class="flex justify-between">
			  <span>python</span>
			  <span>6</span>
			</a>
		  </li>
		
		  <li>
			<a href="/tags/git/"  class="flex justify-between">
			  <span>git</span>
			  <span>1</span>
			</a>
		  </li>
		
		  <li>
			<a href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"  class="flex justify-between">
			  <span>设计模式</span>
			  <span>10</span>
			</a>
		  </li>
		
		  <li>
			<a href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"  class="flex justify-between">
			  <span>数据结构</span>
			  <span>7</span>
			</a>
		  </li>
		
		  <li>
			<a href="/tags/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/"  class="flex justify-between">
			  <span>操作系统</span>
			  <span>5</span>
			</a>
		  </li>
		
		  <li>
			<a href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/"  class="flex justify-between">
			  <span>计算机组成原理</span>
			  <span>1</span>
			</a>
		  </li>
		
      
	
  
  </ul>
</nav>


    </aside>
  
 
        </header>
        
  
  <article class="markdown book-post">
    <h2>
      <a href="/posts/javaee/oAuth/">oAuth</a>
    </h2>
    
  <h5>2021-08-20</h5>



  

  
  <div>
    
      <a href="/tags/java/">java</a>
  </div>
  




    <p><ul>
<li>oAuth是一种授权机制，数据所有者告诉授权系统，允许第三方应用获取这些数据，授权系统从而产生一个短期的进入令牌（token），第三方应用通过令牌获取数据。</li>
</ul>
<h3 id="授权码方式">
  授权码方式
  <a class="anchor" href="#%e6%8e%88%e6%9d%83%e7%a0%81%e6%96%b9%e5%bc%8f">#</a>
</h3>
<p>第三方应用（记为a）访问CALLBACK_URL这个网站，会重定向到授权系统（记为b），url如1所示</p>
<h4 id="1-请求授权码">
  1. 请求授权码
  <a class="anchor" href="#1-%e8%af%b7%e6%b1%82%e6%8e%88%e6%9d%83%e7%a0%81">#</a>
</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>https:<span style="color:#f92672">//</span>b.com<span style="color:#f92672">/</span>oauth<span style="color:#f92672">/</span>authorize<span style="color:#f92672">?</span>
</span></span><span style="display:flex;"><span>  response_type<span style="color:#f92672">=</span>code<span style="color:#f92672">&amp;</span> <span style="color:#f92672">#</span><span style="color:#960050;background-color:#1e0010">表示参数要求返回授权码</span>
</span></span><span style="display:flex;"><span>  client_id<span style="color:#f92672">=</span>CLIENT_ID<span style="color:#f92672">&amp;</span> <span style="color:#f92672">#</span><span style="color:#960050;background-color:#1e0010">客户端</span>id<span style="color:#960050;background-color:#1e0010">，</span>b<span style="color:#960050;background-color:#1e0010">就知道是谁在请求</span>
</span></span><span style="display:flex;"><span>  redirect_uri<span style="color:#f92672">=</span>CALLBACK_URL<span style="color:#f92672">&amp;</span> <span style="color:#f92672">#</span>b<span style="color:#960050;background-color:#1e0010">接收请求后跳转的网站</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">scope</span><span style="color:#f92672">=</span><span style="color:#66d9ef">read</span> <span style="color:#f92672">#</span><span style="color:#960050;background-color:#1e0010">授权范围</span>
</span></span></code></pre></div><h4 id="2-返回授权码">
  2. 返回授权码
  <a class="anchor" href="#2-%e8%bf%94%e5%9b%9e%e6%8e%88%e6%9d%83%e7%a0%81">#</a>
</h4>
<p>在授权系统登录成功后，会重定向到<code>CALLBACK_URL?code=AUTHORIZATION_CODE</code>，code就是授权码。</p>
<h4 id="3-请求令牌">
  3. 请求令牌
  <a class="anchor" href="#3-%e8%af%b7%e6%b1%82%e4%bb%a4%e7%89%8c">#</a>
</h4>
<p>CALLBACK_URL这个网站会重定向到授权系统，url如下：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>https:<span style="color:#f92672">//</span>b.com<span style="color:#f92672">/</span>oauth<span style="color:#f92672">/</span>token<span style="color:#f92672">?</span>
</span></span><span style="display:flex;"><span> client_id<span style="color:#f92672">=</span>CLIENT_ID<span style="color:#f92672">&amp;</span> <span style="color:#f92672">#</span><span style="color:#960050;background-color:#1e0010">客户端</span>id<span style="color:#960050;background-color:#1e0010">，</span>b<span style="color:#960050;background-color:#1e0010">就知道是谁在请求</span>
</span></span><span style="display:flex;"><span> client_secret<span style="color:#f92672">=</span>CLIENT_SECRET<span style="color:#f92672">&amp;</span> 
</span></span><span style="display:flex;"><span> grant_type<span style="color:#f92672">=</span>authorization_code<span style="color:#f92672">&amp;</span> <span style="color:#f92672">#</span><span style="color:#960050;background-color:#1e0010">授权类型，表明是授权码</span>
</span></span><span style="display:flex;"><span> code<span style="color:#f92672">=</span>AUTHORIZATION_CODE<span style="color:#f92672">&amp;</span> <span style="color:#f92672">#</span><span style="color:#960050;background-color:#1e0010">上一步拿到的授权码</span>
</span></span><span style="display:flex;"><span> redirect_uri<span style="color:#f92672">=</span>CALLBACK_URL <span style="color:#f92672">#</span>b<span style="color:#960050;background-color:#1e0010">之后跳转的网站</span>
</span></span></code></pre></div><h4 id="4-返回令牌">
  4. 返回令牌
  <a class="anchor" href="#4-%e8%bf%94%e5%9b%9e%e4%bb%a4%e7%89%8c">#</a>
</h4>
<p>授权系统会重定向到CALLBACK_URL，并发送一段JSON数据</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{  
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;access_token&#34;</span>:<span style="color:#e6db74">&#34;ACCESS_TOKEN（令牌）&#34;</span>,  
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;token_type&#34;</span>:<span style="color:#e6db74">&#34;bearer&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;expires_in&#34;</span>:<span style="color:#ae81ff">2592000</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;refresh_token&#34;</span>:<span style="color:#e6db74">&#34;REFRESH_TOKEN&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;scope&#34;</span>:<span style="color:#e6db74">&#34;read&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;uid&#34;</span>:<span style="color:#ae81ff">100101</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;info&#34;</span>:{<span style="color:#960050;background-color:#1e0010">...</span>}
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><strong>参考链接：</strong>
  <a href="https://www.ruanyifeng.com/blog/2019/04/oauth-grant-types.html">OAuth 2.0 的四种方式 - 阮一峰的网络日志 (ruanyifeng.com)</a></p>
    </p>
  </article>
  
  <article class="markdown book-post">
    <h2>
      <a href="/posts/http/https/">https</a>
    </h2>
    
  <h5>2021-08-20</h5>



  

  
  <div>
    
      <a href="/tags/http/">http</a>
  </div>
  




    <p><ul>
<li>如何保证公钥不被篡改？将公钥放在数字证书中，只要证书是可信的，公钥就是可信的。</li>
</ul>
<h3 id="握手过程">
  握手过程
  <a class="anchor" href="#%e6%8f%a1%e6%89%8b%e8%bf%87%e7%a8%8b">#</a>
</h3>
<ul>
<li>涉及四次通信。</li>
</ul>
<h4 id="1-客户端发送请求clienthello">
  1. 客户端发送请求（ClientHello）。
  <a class="anchor" href="#1-%e5%ae%a2%e6%88%b7%e7%ab%af%e5%8f%91%e9%80%81%e8%af%b7%e6%b1%82clienthello">#</a>
</h4>
<p>客户端向服务器提供以下信息：</p>
<ol>
<li>支持的协议版本，如TLS1.0版本。</li>
<li>客户端生成的随机数，是之后生成会话密钥的一部分。</li>
<li>支持的加密算法，如RSA。</li>
<li>支持的压缩算法。</li>
</ol>
<h4 id="2-服务器收到请求后向客户端发出回应serverhello">
  2. 服务器收到请求后，向客户端发出回应（ServerHello）。
  <a class="anchor" href="#2-%e6%9c%8d%e5%8a%a1%e5%99%a8%e6%94%b6%e5%88%b0%e8%af%b7%e6%b1%82%e5%90%8e%e5%90%91%e5%ae%a2%e6%88%b7%e7%ab%af%e5%8f%91%e5%87%ba%e5%9b%9e%e5%ba%94serverhello">#</a>
</h4>
<p>服务器向客户端发出回应包含以下内容（如果服务器需要确认客户端的身份，就需要再包含一项请求，要求和护短提供证书文件）：</p>
<ol>
<li>确认使用的协议版本。</li>
<li>服务器生成的随机数，是之后生成会话密钥的一部分。</li>
<li>确认使用的加密算法。</li>
<li>服务器证书。</li>
</ol>
<h4 id="3-客户端回应">
  3. 客户端回应
  <a class="anchor" href="#3-%e5%ae%a2%e6%88%b7%e7%ab%af%e5%9b%9e%e5%ba%94">#</a>
</h4>
<p>客户端收到回应后，先验证服务器的证书，如果证书不是可信机构颁发、证书中的域名与实际域名不一致、证书已经过期，就会显示一个警告询问是否继续。如果继续或者证书没有问题，客户端向服务端发送以下内容：</p>
<ol>
<li>一个随机数（pre-master key），该随机数用服务器的公钥加密。</li>
<li>编码改变通知，表示随后的信息都用协商的加密算法和密钥发送。</li>
<li>客户端的握手结束通知，包含前面发送所有内容的hash值，供服务器校验。</li>
</ol>
<h4 id="4-服务器回应">
  4. 服务器回应
  <a class="anchor" href="#4-%e6%9c%8d%e5%8a%a1%e5%99%a8%e5%9b%9e%e5%ba%94">#</a>
</h4>
<p>服务器收到第三个随机数后，计算会话使用的“会话密钥”，向客户端发送以下信息：</p>
<ol>
<li>编码改变通知，表面之后的信息都用协商的加密算法和密钥发送。</li>
<li>服务器握手状态结束通知，包含签名发送的所有内容的hash值。</li>
</ol>
<hr>
<ul>
<li>中间人攻击：如果中间人在客户端与服务端开始建立连接的时候，拦截客户端的请求，让客户端与自己通信，自己再和服务端通信，出现了：客户端请求-&gt;中间人-&gt;服务端，服务端响应-&gt;中间人-&gt;客户端，中间人能获取到客户端请求的所有数据和服务端响应的所有数据。所以当出现证书不安全的时候要注意。</li>
</ul>
<p><strong>参考链接：</strong>
  <a href="https://www.ruanyifeng.com/blog/2014/02/ssl_tls.html">SSL/TLS协议运行机制的概述 - 阮一峰的网络日志 (ruanyifeng.com)</a></p>
    </p>
  </article>
  
  <article class="markdown book-post">
    <h2>
      <a href="/posts/javaee/jwt%E5%8D%8F%E8%AE%AE/">jwt协议</a>
    </h2>
    
  <h5>2021-08-20</h5>



  

  
  <div>
    
      <a href="/tags/java/">java</a>
  </div>
  




    <p><ul>
<li>全称是JSON Web Token。</li>
<li>jwt由下面三个部分组成，格式类似<code>aaa.bbb.ccc</code>
<ul>
<li>Header（头部）</li>
<li>Payload（负载）</li>
<li>Signature（签名）</li>
</ul>
</li>
</ul>
<hr>
<ul>
<li>Header部分是一个JSON对象，由签名算法和token类型组成，会使用用Base64URL加密，加密后的数据组成jwt的第一部分。原始数据如下（例）：</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;alg&#34;</span>:<span style="color:#e6db74">&#34;HS256&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;typ&#34;</span>:<span style="color:#e6db74">&#34;JWT&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ul>
<li>Payload也是一个JSON对象，会用Base64URL加密，加密后的数据组成jwt的第二部分。默认定义了一些参数 iss(ssuer):签发人，exp(expiration):过期时间，sub(subject):主题，aud(audience):受众，nbf(not before):生效时间，iat(issued at):签发时间，jti(jwi id):编号。原始数据如下（例）：</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;sub&#34;</span>: <span style="color:#e6db74">&#34;1234567890&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;John Doe&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;admin&#34;</span>: <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ul>
<li>Signature会根据服务端的密钥和Header中给的算法，对加密后的Header和加密后的Payload再次进行加密，将加密的结果组成jwt的第三部分。加密的逻辑如下：</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>HMACSHA256<span style="color:#f92672">(</span> base64UrlEncode<span style="color:#f92672">(</span>header<span style="color:#f92672">)</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39;.&#39;</span> <span style="color:#f92672">+</span> base64UrlEncode<span style="color:#f92672">(</span>payload<span style="color:#f92672">),</span> secret<span style="color:#f92672">)</span>
</span></span></code></pre></div><hr>
<ul>
<li>可以在HTTP的headers中的使用，这样就不会有跨域问题了（因为没有使用cookie）：</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-properties" data-lang="properties"><span style="display:flex;"><span><span style="color:#a6e22e">Authorization</span><span style="color:#f92672">:</span><span style="color:#e6db74">Bearer &lt;token&gt;</span>
</span></span></code></pre></div><p><strong>参考链接：</strong>
  <a href="https://jwt.io/introduction/">JSON Web Token Introduction - jwt.io</a>
<strong>参考链接：</strong>
  <a href="https://www.ruanyifeng.com/blog/2018/07/json_web_token-tutorial.html">JSON Web Token 入门教程 - 阮一峰的网络日志 (ruanyifeng.com)</a>
<strong>解密jwt：</strong>
  <a href="https://jwt.io/#debugger-io">JSON Web Tokens - jwt.io</a></p>
    </p>
  </article>
  
  <article class="markdown book-post">
    <h2>
      <a href="/posts/javaee/cas%E5%8D%8F%E8%AE%AE/">cas协议</a>
    </h2>
    
  <h5>2021-08-19</h5>



  

  
  <div>
    
      <a href="/tags/java/">java</a>
  </div>
  




    <p><p>
  <img src="/img/%e7%bd%91%e7%bb%9c/cas%e5%8d%8f%e8%ae%ae/1.png" alt="CAS详细流程" /></p>
<h3 id="cas协议">
  CAS协议
  <a class="anchor" href="#cas%e5%8d%8f%e8%ae%ae">#</a>
</h3>
<ul>
<li>central authentication service（中央认证服务），TGT（Ticket Grangting Ticket）。TGC（ticket-granting cookie）、ST（service ticket）</li>
<li>流程如下（所有的过程都是重定向）：</li>
</ul>
<ol>
<li>用户通过浏览器访问业务系统（就是CAS client，可能是某个微服务）。</li>
<li>业务系统重定向到CAS server。</li>
<li>server对用户进行认证，如用户提供了正确的认证信息，server就会创建对应的session（似乎就是TGT），TGC（cookie）是该session的key，server把TGT和生成的ST发给浏览器。</li>
<li>浏览器重新请求该业务系统，同时url上带上了ST=xxx访问业务系统。</li>
<li>业务系统拿到ST后，向Server发起校验，校验成功后生成session和cookie，将cookie发送给浏览器。</li>
<li>浏览器带上该cookie，不带ST向业务系统发出请求。</li>
<li>业务系统验证cookie成功，系统登录成功。</li>
</ol>
<p><strong>参考链接：</strong>
  <a href="https://apereo.github.io/cas/4.2.x/protocol/CAS-Protocol.html">CAS - CAS Protocol (apereo.github.io)</a></p>
    </p>
  </article>
  
  <article class="markdown book-post">
    <h2>
      <a href="/posts/http/rest/">rest</a>
    </h2>
    
  <h5>2021-08-19</h5>



  

  
  <div>
    
      <a href="/tags/http/">http</a>
  </div>
  




    <p><ul>
<li>POST：创建，PUT：修改，DELETE：删除，GET：获取</li>
</ul>
    </p>
  </article>
  
  <article class="markdown book-post">
    <h2>
      <a href="/posts/javaee/jpa/">jpa</a>
    </h2>
    
  <h5>2021-08-18</h5>



  

  
  <div>
    
      <a href="/tags/java/">java</a>
  </div>
  




    <p><h3 id="jpa方法支持的关键字">
  jpa方法支持的关键字
  <a class="anchor" href="#jpa%e6%96%b9%e6%b3%95%e6%94%af%e6%8c%81%e7%9a%84%e5%85%b3%e9%94%ae%e5%ad%97">#</a>
</h3>
<div style="overflow:auto;">
<table>
<thead>
<tr>
<th>关键字</th>
<th>例子</th>
<th>jpql</th>
</tr>
</thead>
<tbody>
<tr>
<td>Distinct</td>
<td>findDistinctByLastnameAndFirstname</td>
<td>select distinct &hellip; where x.lastname=?1 and x.firstname=?2</td>
</tr>
<tr>
<td>And</td>
<td>findByFirstnameAndLastname</td>
<td>&hellip; where x.firstname=?1 and x.lastname=?2</td>
</tr>
<tr>
<td>Or</td>
<td>findByFirstNameOrLastname</td>
<td>&hellip; where x.firstname=?1 and x.lastname=?2</td>
</tr>
<tr>
<td>Is,Equals</td>
<td>findByFirstname,findByFirstnameIs,findByFirstnameEquals</td>
<td>&hellip; where x.firstname=?1</td>
</tr>
<tr>
<td>Between</td>
<td>findByStartDateBetween</td>
<td>&hellip; where x.startDate between ?1 and ?2</td>
</tr>
<tr>
<td>LessThan</td>
<td>findByAgeLessThan</td>
<td>&hellip; where x.age &lt;?1</td>
</tr>
<tr>
<td>LessThanEqual</td>
<td>findByAgeLessThanEqual</td>
<td>&hellip; where x.age?=?1</td>
</tr>
<tr>
<td>GreaterThan</td>
<td>findByAgeGreaterThan</td>
<td>&hellip; where x.age&gt;?1</td>
</tr>
<tr>
<td>After</td>
<td>findByStartDateAfter</td>
<td>&hellip; where x.startDate &gt;?1</td>
</tr>
<tr>
<td>Before</td>
<td>findByStartDateBefore</td>
<td>&hellip; where x.startDate&lt;?1</td>
</tr>
<tr>
<td>IsNull,Null</td>
<td>findByAge(Is)Null</td>
<td>&hellip; where x.age is null</td>
</tr>
<tr>
<td>IsNotNull,NotNull</td>
<td>findByAge(Is)NotNull</td>
<td>&hellip; where x.age not null</td>
</tr>
<tr>
<td>Like</td>
<td>findByFirstnameLike</td>
<td>&hellip; where x.firstname like?1</td>
</tr>
<tr>
<td>NotLike</td>
<td>findByFirstnameNotLike</td>
<td>&hellip; where x.firstname not like ?1</td>
</tr>
<tr>
<td>StartingWith</td>
<td>findByFirstnameStartingWith</td>
<td>… where x.firstname like ?1` (参数后面加%）</td>
</tr>
<tr>
<td>EndingWith</td>
<td>findByFirstnameEndingWith</td>
<td><code>… where x.firstname like ?1</code> （参数前面加%）</td>
</tr>
<tr>
<td>Containing</td>
<td>findByFirstnameContaining</td>
<td><code>… where x.firstname like ?1</code> （参数前后加%）</td>
</tr>
<tr>
<td>OrderBy</td>
<td>findByAgeOrderByLastnameDesc</td>
<td>… where x.age = ?1 order by x.lastname desc</td>
</tr>
<tr>
<td>Not</td>
<td>findByLastnameNot</td>
<td>… where x.lastname &lt;&gt; ?1</td>
</tr>
<tr>
<td>In</td>
<td>findByAgeIn(Collection//&lt;Age//&gt; ages)</td>
<td>… where x.age in ?1</td>
</tr>
<tr>
<td>NotIn</td>
<td>findByAgeNotIn(Collection<Age> ages)</td>
<td>… where x.age not in ?1</td>
</tr>
<tr>
<td>True</td>
<td>findByActiveTrue</td>
<td>… where x.active = true</td>
</tr>
<tr>
<td>False</td>
<td>findByActiveFalse()</td>
<td>… where x.active = false</td>
</tr>
<tr>
<td>IgnoreCase</td>
<td>findByFirstnameIgnoreCase</td>
<td>… where UPPER(x.firstname) = UPPER(?1)</td>
</tr>
</tbody>
</table>
</div>
<h3 id="ddl-auto">
  ddl-auto
  <a class="anchor" href="#ddl-auto">#</a>
</h3>
<ul>
<li>none：禁用ddl；</li>
<li>validate：验证表结构，不对数据库有任何修改；</li>
<li>update：如果启动时表格式不一样则更新表，原有数据保留</li>
<li>create：启动时删除数据库中的表，然后创建；</li>
<li>create-drop：启动时删除数据库中的表，然后创建，退出时删除数据表。</li>
</ul>
    </p>
  </article>
  
  <article class="markdown book-post">
    <h2>
      <a href="/posts/http/http%E7%8A%B6%E6%80%81%E7%A0%81/">http状态码</a>
    </h2>
    
  <h5>2021-08-17</h5>



  

  
  <div>
    
      <a href="/tags/http/">http</a>
  </div>
  




    <p><h2 id="消息响应">
  消息响应
  <a class="anchor" href="#%e6%b6%88%e6%81%af%e5%93%8d%e5%ba%94">#</a>
</h2>
<ul>
<li><code>101 Switching Protocol</code> 表示正在切换协议。</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-http" data-lang="http"><span style="display:flex;"><span><span style="color:#66d9ef">HTTP</span><span style="color:#f92672">/</span><span style="color:#ae81ff">1.1</span> <span style="color:#ae81ff">101</span> <span style="color:#a6e22e">Switching Protocols</span>
</span></span><span style="display:flex;"><span>Upgrade<span style="color:#f92672">:</span> <span style="color:#ae81ff">websocket</span>
</span></span><span style="display:flex;"><span>Connection<span style="color:#f92672">:</span> <span style="color:#ae81ff">Upgrade</span>
</span></span></code></pre></div><h2 id="成功响应">
  成功响应
  <a class="anchor" href="#%e6%88%90%e5%8a%9f%e5%93%8d%e5%ba%94">#</a>
</h2>
<ul>
<li><code>200 OK</code>请求成功。</li>
<li><code>201 CREATED</code>请求已成功，通常是POST、PUT请求后返回的响应。</li>
</ul>
<h2 id="重定向">
  重定向
  <a class="anchor" href="#%e9%87%8d%e5%ae%9a%e5%90%91">#</a>
</h2>
<ul>
<li><code>301 MOVED PERMENENTLY</code>请求的资源已经被永久移动到新位置。</li>
<li><code>302 FOUND</code>重定向是临时的。</li>
<li><code>304 Not Modified</code> 当文档内容没有修改，服务器会返回这个状态码，304响应禁止包含消息体。</li>
</ul>
<h2 id="客户端响应">
  客户端响应
  <a class="anchor" href="#%e5%ae%a2%e6%88%b7%e7%ab%af%e5%93%8d%e5%ba%94">#</a>
</h2>
<ul>
<li><code>400 BAD REQUEST</code>请求参数有误。</li>
<li><code>401 UNAUTHORIZED</code>当前请求需要用户验证。</li>
<li><code>403 FORBIDDEN</code>服务器已经理解请求，但是拒绝执行。</li>
<li><code>404 NOT FOUND</code>请求资源未找到。</li>
<li><code>405 Method Not Allowed</code> 请求方法不能被用于请求相应的资源。该响应必须返回一个Allow头用以表述当前资源能够接受的请求方法的列表。</li>
<li><code>414 URI Too Long</code> 请求的URI长度超过了服务器能够解释的长度，因此服务器拒绝对该请求提供服务。通常是因为超过了GET方法传输数据的上限，可以改为POST方法。</li>
</ul>
<h2 id="服务端响应">
  服务端响应
  <a class="anchor" href="#%e6%9c%8d%e5%8a%a1%e7%ab%af%e5%93%8d%e5%ba%94">#</a>
</h2>
<ul>
<li><code>500 INTERNAL SERVER ERROR</code>服务器内部错误。</li>
<li><code>502 BAD GATEWAY</code>服务器作为网关需要得到处理该请求的响应，但得到了一个错误的响应。</li>
<li><code>503 SERVICE UNAVILABLE</code>服务器没有准备好处理请求。</li>
</ul>
<p><strong>参考链接：</strong>
  <a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Status">HTTP 响应代码 - HTTP | MDN (mozilla.org)</a></p>
    </p>
  </article>
  
  <article class="markdown book-post">
    <h2>
      <a href="/posts/javaee/redis%E8%B5%B7%E6%AD%A5/">redis起步</a>
    </h2>
    
  <h5>2021-08-13</h5>



  

  
  <div>
    
      <a href="/tags/java/">java</a>
  </div>
  




    <p><ul>
<li>支持string、list、set、有序set、hash等数据类型</li>
<li>通过<code>./redis-server [redis.conf] </code>启动服务。</li>
<li>通过<code>./redis-cli [-h hostname] [-p port] </code>连接redis，登录后通过<code>AUTH password</code>来输入密码。</li>
</ul>
<h2 id="命令">
  命令
  <a class="anchor" href="#%e5%91%bd%e4%bb%a4">#</a>
</h2>
<ul>
<li><code>keys *</code> 查看当前库中的所有key。</li>
<li><code>exists key</code> 判断某个key是否存在</li>
<li><code>rename key newkey</code>键重命名</li>
<li>type key 查看key是什么类型</li>
<li><code>del key</code> 删除指定的key数据</li>
<li><code>expire key 10</code>  给key设定10秒的过期时间</li>
<li><code>ttl key</code> 查看还有多少秒过期，-1表示永不过期，-2表示已过期</li>
<li>select index 切换数据库，默认有16个库</li>
<li>dbsize 查看当前库key的数量</li>
<li><code>set key value</code> 设置字符串类型的键值对</li>
<li><code>get key</code> 获取值</li>
</ul>
<h2 id="数据类型">
  数据类型
  <a class="anchor" href="#%e6%95%b0%e6%8d%ae%e7%b1%bb%e5%9e%8b">#</a>
</h2>
<h3 id="string">
  string
  <a class="anchor" href="#string">#</a>
</h3>
<ul>
<li><code>set key value</code> 设置值</li>
<li><code>get key</code> 获取key对应的值</li>
<li><code>strlen key</code> 获取值的长度。</li>
<li>mset key1 value1 key2 value2 同时设置多个键值对。</li>
<li>mget key1 key2 同时获取多个键值对。</li>
<li>append key value 将给定的value追加到原值的末尾。</li>
<li>setnx key value 只有当key不存在的时候才设置key的值。</li>
<li>incr key key的值加一。</li>
<li>decr key key的值减一。</li>
<li>incrby key 步长 key的值加步长。</li>
<li>decrby key 步长 key的值减步长。</li>
<li>msetnx key1 value1 key2 value2 同时设置多个键值对，当有一个key存在的时候，所有的设置都会失败。</li>
<li><code>setex key seconds value</code> 设置键值对的同时设置过期时间，单位是秒。</li>
<li>String内部采用类似arraylist的机制，字符串实际分配的空间一般高于字符串的长度，当字符串长度小于1M时，扩容都是加倍的，超过1M时，每次扩容都是只增加1M。最大为512M。</li>
</ul>
<h3 id="链表">
  链表
  <a class="anchor" href="#%e9%93%be%e8%a1%a8">#</a>
</h3>
<h4 id="节点的结构">
  节点的结构
  <a class="anchor" href="#%e8%8a%82%e7%82%b9%e7%9a%84%e7%bb%93%e6%9e%84">#</a>
</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#75715e">//adlist.h/listNode
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">//结构
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">typedef</span> <span style="color:#66d9ef">struct</span> listNode {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">//前置节点
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">struct</span> listNode <span style="color:#f92672">*</span>prev;
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">//后置节点
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">struct</span> listNode <span style="color:#f92672">*</span>next;
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">//节点的值
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">void</span> <span style="color:#f92672">*</span>value;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ul>
<li>双端链表，获取节点的前置节点和后置节点的复杂度都是O(1)。</li>
<li>无环链表，表头指针的prev和表尾指针的next都是指向NULL。</li>
<li>list结构的head指针和tail指针能快速获取表头结点和表尾节点，复杂度是O(1)。</li>
<li>可以通过list结构的len属性来获取链表中节点的数量，复杂度是O(1)。</li>
</ul>
<h4 id="命令-1">
  命令
  <a class="anchor" href="#%e5%91%bd%e4%bb%a4-1">#</a>
</h4>
<ul>
<li><code>lpush/rpush k1 v1 v2 v3</code> 从左/右边插入</li>
<li><code>lpop/rpop k1</code> 从左/又边吐出一个值</li>
<li><code>lindex key index</code>按照索引下标获取元素</li>
<li><code>len key</code>获得列表的长度</li>
<li><code>lset key index value</code> 将key的下标为index设置为value</li>
<li><code>lrange key start stop</code> 按照下标索引获得元素，0表示左边第一个，-1表示右边第一个。</li>
<li><code>lrem key n value</code> 删除n个value</li>
</ul>
<h3 id="hash">
  hash
  <a class="anchor" href="#hash">#</a>
</h3>
<h4 id="命令-2">
  命令
  <a class="anchor" href="#%e5%91%bd%e4%bb%a4-2">#</a>
</h4>
<ul>
<li><code>hset key field value</code>设置值</li>
<li><code>hget key field</code>获取值</li>
<li><code>hdel key  field[field...]</code>删除一个或多个键值对</li>
<li><code>hlen key</code>计算field的个数</li>
<li><code>hmget key field [field...]</code> 批量获取</li>
<li><code>hmset key field value [field value ...]</code>批量设置</li>
<li><code>hexists key field</code>判断field是否存在</li>
<li><code>hkeys key</code>获取所有field</li>
<li><code>hvals key</code>获取所有value</li>
<li><code>hstrlen key field</code>获取value字符串长度</li>
</ul>
    </p>
  </article>
  

  
    <ul class="pagination pagination-default">
      <li class="page-item">
        <a href="/posts/" aria-label="First" class="page-link" role="button"><span aria-hidden="true">&laquo;&laquo;</span></a>
      </li>
      <li class="page-item">
        <a href="/posts/page/8/" aria-label="Previous" class="page-link" role="button"><span aria-hidden="true">&laquo;</span></a>
      </li>
      <li class="page-item">
        <a href="/posts/page/7/" aria-label="Page 7" class="page-link" role="button">7</a>
      </li>
      <li class="page-item">
        <a href="/posts/page/8/" aria-label="Page 8" class="page-link" role="button">8</a>
      </li>
      <li class="page-item active">
        <a aria-current="page" aria-label="Page 9" class="page-link" role="button">9</a>
      </li>
      <li class="page-item">
        <a href="/posts/page/10/" aria-label="Page 10" class="page-link" role="button">10</a>
      </li>
      <li class="page-item">
        <a href="/posts/page/11/" aria-label="Page 11" class="page-link" role="button">11</a>
      </li>
      <li class="page-item">
        <a href="/posts/page/10/" aria-label="Next" class="page-link" role="button"><span aria-hidden="true">&raquo;</span></a>
      </li>
      <li class="page-item">
        <a href="/posts/page/19/" aria-label="Last" class="page-link" role="button"><span aria-hidden="true">&raquo;&raquo;</span></a>
      </li>
    </ul>
 
	    </div>

      <footer class="page-footer">
        
  


 
      </footer>
    </div>

  </main>

</body>
</html>











