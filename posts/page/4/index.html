<!DOCTYPE html>
<html dir="ltr">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
<meta name="theme-color" content="#FFFFFF">
<meta name="color-scheme" content="light dark">

<title>主页 | 小象的blog</title>
<link rel="manifest" href="/manifest.json">
<link rel="icon" href="/favicon.png" type="image/x-icon">
<link rel="stylesheet" href="/book.min.e24d94cf619e7e6705439036ee43e77f243d24ac89100b59375379bc4d659d87.css" >
  <script defer src="/sw.min.6f6f90fcb8eb1c49ec389838e6b801d0de19430b8e516902f8d75c3c8bd98739.js" ></script>
<link rel="alternate" type="application/rss+xml" href="/posts/index.xml" title="小象的blog" />
<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->
</head>
<body dir="ltr">
  <input type="checkbox" class="hidden toggle" id="toc-control" />
  <main class="container flex">

    <aside class="book-menu">
      <div class="book-menu-content">
        
  <nav>
<h2 class="book-brand">
  <a class="flex align-center" href="/"><img src="/logo.png" alt="Logo" /><span>小象的blog</span>
  </a>
</h2>


















  
<ul>
  
  <li>
    <a href="/posts/">
        主页
      </a>
  </li>
  
  <li>
    <a href="/posts/linux/linux%E5%91%BD%E4%BB%A4/">
        linux命令总结
      </a>
  </li>
  
  <li>
    <a href="/posts/linux/shell%E8%84%9A%E6%9C%AC/">
        shell脚本
      </a>
  </li>
  
  <li>
    <a href="/categories/book/">
        书籍笔记
      </a>
  </li>
  
  <li>
    <a href="/about/">
        关于
      </a>
  </li>
  
</ul>





</nav>




  <script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>


  <div class="split-line"></div>
  
  
<nav>
  <ul>
  
    
	  
	
  
    
	  
		
		  <li>
			<a href="/tags/bios/"  class="flex justify-between">
			  <span>bios</span>
			  <span>9</span>
			</a>
		  </li>
		
		  <li>
			<a href="/tags/%E5%85%B6%E4%BB%96/"  class="flex justify-between">
			  <span>其他</span>
			  <span>4</span>
			</a>
		  </li>
		
		  <li>
			<a href="/tags/c%E8%AF%AD%E8%A8%80/"  class="flex justify-between">
			  <span>c语言</span>
			  <span>6</span>
			</a>
		  </li>
		
		  <li>
			<a href="/tags/linux/"  class="flex justify-between">
			  <span>linux</span>
			  <span>10</span>
			</a>
		  </li>
		
		  <li>
			<a href="/tags/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8/"  class="flex justify-between">
			  <span>信息安全</span>
			  <span>4</span>
			</a>
		  </li>
		
		  <li>
			<a href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/"  class="flex justify-between">
			  <span>计算机网络</span>
			  <span>7</span>
			</a>
		  </li>
		
		  <li>
			<a href="/tags/java/"  class="flex justify-between">
			  <span>java</span>
			  <span>53</span>
			</a>
		  </li>
		
		  <li>
			<a href="/tags/nginx/"  class="flex justify-between">
			  <span>nginx</span>
			  <span>5</span>
			</a>
		  </li>
		
		  <li>
			<a href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/"  class="flex justify-between">
			  <span>数据库</span>
			  <span>7</span>
			</a>
		  </li>
		
		  <li>
			<a href="/tags/%E5%89%8D%E7%AB%AF/"  class="flex justify-between">
			  <span>前端</span>
			  <span>4</span>
			</a>
		  </li>
		
		  <li>
			<a href="/tags/http/"  class="flex justify-between">
			  <span>http</span>
			  <span>7</span>
			</a>
		  </li>
		
		  <li>
			<a href="/tags/python/"  class="flex justify-between">
			  <span>python</span>
			  <span>6</span>
			</a>
		  </li>
		
		  <li>
			<a href="/tags/git/"  class="flex justify-between">
			  <span>git</span>
			  <span>1</span>
			</a>
		  </li>
		
		  <li>
			<a href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"  class="flex justify-between">
			  <span>设计模式</span>
			  <span>10</span>
			</a>
		  </li>
		
		  <li>
			<a href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"  class="flex justify-between">
			  <span>数据结构</span>
			  <span>7</span>
			</a>
		  </li>
		
		  <li>
			<a href="/tags/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/"  class="flex justify-between">
			  <span>操作系统</span>
			  <span>5</span>
			</a>
		  </li>
		
		  <li>
			<a href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/"  class="flex justify-between">
			  <span>计算机组成原理</span>
			  <span>1</span>
			</a>
		  </li>
		
      
	
  
  </ul>
</nav>


 
      </div>
    </aside>

    <div class="book-page">
      <div>
	      <header class="book-header">
          
  <div class="flex align-center justify-between">
   <label for="toc-control">
    
    <img src="/svg/toc.svg" class="book-icon" alt="Table of Contents" />
    
  </label>
  
  <strong>主页</strong>
</div>


  
    <aside class="hidden clearfix">
      <nav>
        




        








        

  
<ul>
  
  <li>
    <a href="/posts/">
        主页
      </a>
  </li>
  
  <li>
    <a href="/posts/linux/linux%E5%91%BD%E4%BB%A4/">
        linux命令总结
      </a>
  </li>
  
  <li>
    <a href="/posts/linux/shell%E8%84%9A%E6%9C%AC/">
        shell脚本
      </a>
  </li>
  
  <li>
    <a href="/categories/book/">
        书籍笔记
      </a>
  </li>
  
  <li>
    <a href="/about/">
        关于
      </a>
  </li>
  
</ul>





      </nav>
      <div class="split-line"></div>
      
  
<nav>
  <ul>
  
    
	  
	
  
    
	  
		
		  <li>
			<a href="/tags/bios/"  class="flex justify-between">
			  <span>bios</span>
			  <span>9</span>
			</a>
		  </li>
		
		  <li>
			<a href="/tags/%E5%85%B6%E4%BB%96/"  class="flex justify-between">
			  <span>其他</span>
			  <span>4</span>
			</a>
		  </li>
		
		  <li>
			<a href="/tags/c%E8%AF%AD%E8%A8%80/"  class="flex justify-between">
			  <span>c语言</span>
			  <span>6</span>
			</a>
		  </li>
		
		  <li>
			<a href="/tags/linux/"  class="flex justify-between">
			  <span>linux</span>
			  <span>10</span>
			</a>
		  </li>
		
		  <li>
			<a href="/tags/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8/"  class="flex justify-between">
			  <span>信息安全</span>
			  <span>4</span>
			</a>
		  </li>
		
		  <li>
			<a href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/"  class="flex justify-between">
			  <span>计算机网络</span>
			  <span>7</span>
			</a>
		  </li>
		
		  <li>
			<a href="/tags/java/"  class="flex justify-between">
			  <span>java</span>
			  <span>53</span>
			</a>
		  </li>
		
		  <li>
			<a href="/tags/nginx/"  class="flex justify-between">
			  <span>nginx</span>
			  <span>5</span>
			</a>
		  </li>
		
		  <li>
			<a href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/"  class="flex justify-between">
			  <span>数据库</span>
			  <span>7</span>
			</a>
		  </li>
		
		  <li>
			<a href="/tags/%E5%89%8D%E7%AB%AF/"  class="flex justify-between">
			  <span>前端</span>
			  <span>4</span>
			</a>
		  </li>
		
		  <li>
			<a href="/tags/http/"  class="flex justify-between">
			  <span>http</span>
			  <span>7</span>
			</a>
		  </li>
		
		  <li>
			<a href="/tags/python/"  class="flex justify-between">
			  <span>python</span>
			  <span>6</span>
			</a>
		  </li>
		
		  <li>
			<a href="/tags/git/"  class="flex justify-between">
			  <span>git</span>
			  <span>1</span>
			</a>
		  </li>
		
		  <li>
			<a href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"  class="flex justify-between">
			  <span>设计模式</span>
			  <span>10</span>
			</a>
		  </li>
		
		  <li>
			<a href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"  class="flex justify-between">
			  <span>数据结构</span>
			  <span>7</span>
			</a>
		  </li>
		
		  <li>
			<a href="/tags/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/"  class="flex justify-between">
			  <span>操作系统</span>
			  <span>5</span>
			</a>
		  </li>
		
		  <li>
			<a href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/"  class="flex justify-between">
			  <span>计算机组成原理</span>
			  <span>1</span>
			</a>
		  </li>
		
      
	
  
  </ul>
</nav>


    </aside>
  
 
        </header>
        
  
  <article class="markdown book-post">
    <h2>
      <a href="/posts/nginx/https%E9%85%8D%E7%BD%AE/">Https配置</a>
    </h2>
    
  <h5>2022-05-05</h5>



  

  
  <div>
    
      <a href="/tags/nginx/">nginx</a>
  </div>
  




    <p><h1 id="nginx的https配置">
  nginx的https配置
  <a class="anchor" href="#nginx%e7%9a%84https%e9%85%8d%e7%bd%ae">#</a>
</h1>
<h2 id="配置流程">
  配置流程
  <a class="anchor" href="#%e9%85%8d%e7%bd%ae%e6%b5%81%e7%a8%8b">#</a>
</h2>
<ol>
<li>编译nginx需要带上<code>--with-http_ssl_module</code>选项。编译失败可能是缺少依赖，安装对应依赖即可。</li>
</ol>
<pre tabindex="0"><code>./configure --prefix=/opt/nginx --with-http_ssl_module
make
make install
</code></pre><ol start="2">
<li>生成证书，在控制台中依次执行以下命令，执行完成后将生成的文件移动到/opt/nginx/ssl下。</li>
</ol>
<p>openssl genrsa -des3 -out uam.key</p>
<pre tabindex="0"><code>输入密码:********
再次输入密码:********
</code></pre><p>openssl req -new -key uam.key -out uam.csr</p>
<pre tabindex="0"><code>输入密码:********
依次输入如下
Country Name (2 letter code) [AU]:CN
State or Province Name (full name) [Some-State]:shaanxi
Locality Name (eg, city) []:xian
Organization Name (eg, company) [Internet Widgits Pty Ltd]:xiaoxiang
Organizational Unit Name (eg, section) []:
Common Name (e.g. server FQDN or YOUR name) []:
Email Address []:
Please enter the following &#39;extra&#39; attributes
to be sent with your certificate request
A challenge password []:
An optional company name []:
</code></pre><p>openssl rsa -in uam.key  -out uam.nopass.key</p>
<pre tabindex="0"><code>输入密码:********
</code></pre><p>openssl req -new -x509 -days 3650 -key uam.nopass.key  -out uam.crt</p>
<pre tabindex="0"><code>依次输入如下
Country Name (2 letter code) [AU]:CN
State or Province Name (full name) [Some-State]:shaanxi
Locality Name (eg, city) []:xian
Organization Name (eg, company) [Internet Widgits Pty Ltd]:xiaoxiang
Organizational Unit Name (eg, section) []:
Common Name (e.g. server FQDN or YOUR name) []:
Email Address []:
</code></pre><ol start="3">
<li>nginx中http块中添加如下配置：</li>
</ol>
<pre tabindex="0"><code>    server {
        listen       443 ssl;

        #使用https，证书位置
        ssl_certificate /opt/nginx/ssl/uam.crt;
        ssl_certificate_key /opt/nginx/ssl/uam.nopass.key;

        location /{
            proxy_pass http://localhost:80; 
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        }
        #http转发到https
        error_page 497 https://$host:$server_port$request_uri;
        error_page   500 502 503 504  /50x.html;
     }
</code></pre><h2 id="配置介绍">
  配置介绍
  <a class="anchor" href="#%e9%85%8d%e7%bd%ae%e4%bb%8b%e7%bb%8d">#</a>
</h2>
<h3 id="https配置">
  https配置
  <a class="anchor" href="#https%e9%85%8d%e7%bd%ae">#</a>
</h3>
<ul>
<li>nginx配置https，只有listen后面的<code>ssl</code>、<code>ssl_certificate</code>和<code>ssl_certificate_key</code>这三个参数是必须的。</li>
</ul>
<pre tabindex="0"><code>server {
    listen              443 ssl;
    server_name         www.example.com;
    ssl_certificate     www.example.com.crt;
    ssl_certificate_key www.example.com.key;
    ...
}
</code></pre><ul>
<li><code>ssl_protocols</code>和<code>ssl_ciphers</code>可以限制SSL/TLS的版本和密码，默认情况下nginx会使用<code>ssl_protocols TLSv1 TLSv1.1 TLSv1.2</code>和<code>ssl_ciphers HIGH:!aNULL:!MD5</code>，所以一般情况下不需要手动配置。</li>
</ul>
<h3 id="https优化">
  https优化
  <a class="anchor" href="#https%e4%bc%98%e5%8c%96">#</a>
</h3>
<ul>
<li>SSL会消耗额外的CPU资源，在多核的CPU上应该使<code>worker_processes</code>配置为不少于CPU核心数的值(可以将该参数设置为auto，这时nginx会自动调整工作进程数为CPU数量)。</li>
<li>CPU最密集的行为是SSL握手，有两种方式可以降低握手次数：
<ul>
<li>使用<code>keepalive_timeout</code>，使用该参数可以是多个请求通过同一个连接，后面的请求可以复用SSL会话。</li>
<li>通过<code>ssl_session_cache</code>可以将会话存储到工作进程之间共享的SSL会话缓存中，1MB的缓存可以包含大约4000个会话，默认缓存超时时间为5分钟，可以使用<code>ssl_session_timeout</code>来设置超时时间。</li>
</ul>
</li>
</ul>
<pre tabindex="0"><code>worker_processes auto;

http {
    ssl_session_cache   shared:SSL:10m;
    ssl_session_timeout 10m;

    server {
        listen              443 ssl;
        server_name         www.example.com;
        keepalive_timeout   70;

        ssl_certificate     www.example.com.crt;
        ssl_certificate_key www.example.com.key;
        ssl_protocols       TLSv1 TLSv1.1 TLSv1.2;
        ssl_ciphers         HIGH:!aNULL:!MD5;
        ...
}
</code></pre><h3 id="一个server中包含http和https">
  一个server中包含http和https
  <a class="anchor" href="#%e4%b8%80%e4%b8%aaserver%e4%b8%ad%e5%8c%85%e5%90%abhttp%e5%92%8chttps">#</a>
</h3>
<ul>
<li>可以在一个server块中处理http请求和https请求</li>
</ul>
<pre tabindex="0"><code>server {
    listen              80;
    listen              443 ssl;
    server_name         www.example.com;
    ssl_certificate     www.example.com.crt;
    ssl_certificate_key www.example.com.key;
    ...
}
</code></pre><h3 id="无法使用基于server_name的多个https服务">
  无法使用基于server_name的多个HTTPS服务
  <a class="anchor" href="#%e6%97%a0%e6%b3%95%e4%bd%bf%e7%94%a8%e5%9f%ba%e4%ba%8eserver_name%e7%9a%84%e5%a4%9a%e4%b8%aahttps%e6%9c%8d%e5%8a%a1">#</a>
</h3>
<ul>
<li>当为一个IP配置了多个域名时，使用server_name并不能区分这些域名所对应的server块。案例如下：</li>
</ul>
<pre tabindex="0"><code>server {
    listen          443 ssl;
    server_name     www.example.com;
    ssl_certificate www.example.com.crt;
    ...
}

server {
    listen          443 ssl;
    server_name     www.example.org;
    ssl_certificate www.example.org.crt;
    ...
}
</code></pre><ul>
<li>这个例子中无论输入哪个域名，浏览器都返回默认的证书(即<code>www.example.com</code>的证书)。因为SSL连接是建立在浏览器发送HTTP请求之前，nginx不能知道当前发送请求的是哪个域名，所以它只能返回默认的服务证书。</li>
<li>目前的解决方法是为每个HTTPS的server分配一个IP地址。</li>
</ul>
<pre tabindex="0"><code>server {
    listen          192.168.1.1:443 ssl;
    server_name     www.example.com;
    ssl_certificate www.example.com.crt;
    ...
}

server {
    listen          192.168.1.2:443 ssl;
    server_name     www.example.org;
    ssl_certificate www.example.org.crt;
    ...
}
</code></pre><p>相关链接 
  <a href="http://nginx.org/en/docs/http/configuring_https_servers.html">Configuring HTTPS servers (nginx.org)</a></p>
    </p>
  </article>
  
  <article class="markdown book-post">
    <h2>
      <a href="/posts/nginx/serve_name/">serve_name</a>
    </h2>
    
  <h5>2022-04-05</h5>



  

  
  <div>
    
      <a href="/tags/nginx/">nginx</a>
  </div>
  




    <p><p>server_name可以决定使用哪个server块来处理请求，server_name可以是精确的名称、通配符和正则表达式。</p>
<pre tabindex="0"><code>server {
    listen       80;
    server_name  example.org  www.example.org;
    ...
}

server {
    listen       80;
    server_name  *.example.org;
    ...
}

server {
    listen       80;
    server_name  mail.*;
    ...
}

server {
    listen       80;
    server_name  ~^(?&lt;user&gt;.+)\.example\.net$;
    ...
}
</code></pre><p>当按照域名来访问服务时，如果可以匹配多个server_name，就会按照如下的顺序来进行匹配：</p>
<ol>
<li>精确的名称。</li>
<li>以星号开头的最长通配符，如<code>*.exmaple.org</code>。</li>
<li>以星号结束的最长通配符，如<code>mail.*</code>。</li>
<li>第一个匹配的正则表达式(按照在配置文件出现的先后顺序)。</li>
</ol>
<h2 id="通配符">
  通配符
  <a class="anchor" href="#%e9%80%9a%e9%85%8d%e7%ac%a6">#</a>
</h2>
<p>包含星号的通配符只能出现在name的开始或者结束的地方，且只能在点号<code>.</code>的旁边。<code>www.*.example.org</code>和<code>w*.example.org</code>都是非法的。这种情况下可以使用正则表达式。如<code>~^www\..+\.example\.org$</code>和<code>~^w.*\.example\.org$</code>。星号可以匹配name的好几个部分，如<code>*.example.org</code>不仅可以匹配<code>www.example.org</code>也可以匹配<code>www.sub.example.org</code>。</p>
<p>如<code>.example.org</code>这种特殊格式的通配符不仅可以匹配<code>example.org</code>，还可以匹配通配符<code>*.example.org</code>。</p>
<h2 id="正则表达式">
  正则表达式
  <a class="anchor" href="#%e6%ad%a3%e5%88%99%e8%a1%a8%e8%be%be%e5%bc%8f">#</a>
</h2>
<p>nginx使用的正则表达式和Perl编程语言(即PCRE)兼容。如果要使用正则表达式，server_name必须以波浪线开始。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-nginx" data-lang="nginx"><span style="display:flex;"><span><span style="color:#66d9ef">server_name</span> ~<span style="color:#e6db74">^www\d+\.example\.net$;`</span>
</span></span></code></pre></div><p>如果不以波浪线开头，它会被认为是一个精确的名称，如果表达式中包含星号，它会被认为是一个通配符名称。<code>^</code>和<code>$</code>在逻辑上是必须要有的。域名中的<code>.</code>需要被转义，因为<code>.</code>也是正则的元字符。当正则表达式中包含<code>{</code>和<code>}</code>时，正则需要被括起来。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-nginx" data-lang="nginx"><span style="display:flex;"><span><span style="color:#66d9ef">server_name</span>  <span style="color:#e6db74">&#34;~^(?&lt;name&gt;\w\d</span>{<span style="color:#f92672">1,3}+)\.example\.net$&#34;</span>;
</span></span></code></pre></div><p>否则nginx在启动时会报错。</p>
<p>命名正则表达式捕获组可以当作一个变量使用:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-nginx" data-lang="nginx"><span style="display:flex;"><span><span style="color:#66d9ef">server</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">server_name</span>   ~<span style="color:#e6db74">^(www\.)?(?&lt;domain&gt;.+)$;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">location</span> <span style="color:#e6db74">/</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">root</span>   <span style="color:#e6db74">/sites/</span>$domain;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>PCRE支持下面这几种语法</p>
<ol>
<li><code>?&lt;name&gt;</code> 和<code>?'name'</code>Perl5.10兼容语法，自PCRE-7.0开始支持。</li>
<li><code>?P&lt;name&gt;</code> Python兼容依法，自PCRE-4.0开始支持。</li>
</ol>
<p>当nginx启动失败并显示以下错误时:</p>
<pre tabindex="0"><code>pcre_compile() failed: unrecognized character after (?&lt; in ...
</code></pre><p>这表示PCRE库版本太久，可以使用<code>?P&lt;name&gt;</code>语法代替。捕获组也可以使用数字形式。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-nginx" data-lang="nginx"><span style="display:flex;"><span><span style="color:#66d9ef">server</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">server_name</span>   ~<span style="color:#e6db74">^(www\.)?(.+)$;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">location</span> <span style="color:#e6db74">/</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">root</span>   <span style="color:#e6db74">/sites/</span>$2;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>然而，这种用法仅限于简单的情况，因为数字引用很容易被覆盖。</p>
<!--
## 复杂的name
http://nginx.org/en/docs/http/server_names.html
-->
    </p>
  </article>
  
  <article class="markdown book-post">
    <h2>
      <a href="/posts/%E6%95%B0%E6%8D%AE%E5%BA%93/InnoDB/">InnoDB</a>
    </h2>
    
  <h5>2022-03-20</h5>



  

  
  <div>
    
      <a href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a>
  </div>
  




    <p><h2 id="innodb">
  InnoDB
  <a class="anchor" href="#innodb">#</a>
</h2>
<ul>
<li>mysql服务器中负责对表中的数据读取和写入工作的部分是存储引擎，真实数据在不同存储引擎中存放的格式一般是不同的。</li>
<li>innodb会将数据划分为若干个页，以页作为磁盘和内存交互的基本单位，页也是innodb管理存储空间的基本单位，页的默认大小为16KB。一般情况下，一次最少从磁盘中读取16KB的内容到内存中，一次最少把内存中的16KB内容刷新到磁盘中。</li>
<li>innodb有4中行格式COMPACT、PEDUNDANT、DYNAMIC、COMPRESSED。</li>
</ul>
<pre tabindex="0"><code>CREATE TABLE 表名(列的信息) ROW_FORMAT=行格式名称;
ALTER TABLE 表名 ROW_FORMAT=行格式名称;
</code></pre><h3 id="compact行格式">
  COMPACT行格式
  <a class="anchor" href="#compact%e8%a1%8c%e6%a0%bc%e5%bc%8f">#</a>
</h3>
<p>
  <img src="/img/%e6%95%b0%e6%8d%ae%e5%ba%93/mysql/1.jpg" alt="COMPACT行格式" /></p>
<ol>
<li>记录的额外信息，包含3个部分：变长字段的长度列表、NULL值列表和记录头信息。
<ol>
<li>mysql支持一些变长的数据类型，如varchar、text和blob，变长数据类型占用的字节数也是不固定的，所以在存储数据时要把这些数据占用的字节数也存起来。一个变长的数据占用的存储空间分为两部分：真正的数据内容和该数据占用的字节数。各变长字段的真实数据占用的字节数按照列的顺序逆序存放。</li>
<li>当使用定长编码的字符集时（如ascii），CHAR(10)列所占用的字节数不会被加到变长字段长度列表中，而当采用变长编码的字符集时，CHAR(10)列所占用的字节数就会被加到变长字段的长度列表中。此外，采用变长编码字符集的CHAR(M)至少占用M个字节，而VARCHAR(M)没有这个要求。</li>
</ol>
</li>
</ol>
<ul>
<li>记录头信息由固定的5字节组成。</li>
</ul>
<p>
  <img src="/img/%e6%95%b0%e6%8d%ae%e5%ba%93/mysql/2.jpg" alt="" /></p>
<table>
<thead>
<tr>
<th>名称</th>
<th>大小(bit)</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>deleted_flag</td>
<td>1</td>
<td>标识该记录是否被删除。所有被删除的记录会组成一个垃圾链表，之后若有新的记录插入到表中，他们就可能覆盖掉这些记录所占用的存储空间。</td>
</tr>
<tr>
<td>min_rec_flag</td>
<td>1</td>
<td>B+树每层非叶子节点中的最小的目录项记录都会添加该标记</td>
</tr>
<tr>
<td>n_owned</td>
<td>4</td>
<td>一个页面中的记录会被分为多个组，每个组的最后那条记录会在n_owned中记录该组内由几条记录。其他的记录中该字段为0</td>
</tr>
<tr>
<td>heap_no</td>
<td>13</td>
<td>表示当前记录在页面堆中的相对位置</td>
</tr>
<tr>
<td>record_type</td>
<td>3</td>
<td>表示当前记录的类型，0表示普通记录，1表示B+树非叶节点的目录项，2表示Infimum记录，3表示Supremum记录</td>
</tr>
<tr>
<td>next_record</td>
<td>16</td>
<td>表示下一条记录的相对位置。下一条记录指的是按照主键值从小到大的顺序排列的下一条记录。infimum记录的下一条记录就是本页中主键最小的记录，本页中主键最大的记录的下一条记录就是supremum记录。</td>
</tr>
</tbody>
</table>
<ul>
<li>
<p>mysql默认会为每个记录添加一些隐藏列。innodb的主键生成策略：优先使用用户自定义的主键作为主键，如果没有主键，就选取一个不允许存储为NULL的UNIQUE键作为主键，如果没有，innodb会为表默认添加一个名为row_id的隐藏列作为主键。</p>
<table>
<thead>
<tr>
<th>列名</th>
<th>占用空间</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>row_id(DB_ROW_ID)</td>
<td>6字节</td>
<td>非必须，行ID，唯一标识一条记录</td>
</tr>
<tr>
<td>trx_id(DB_TRX_ID)</td>
<td>6字节</td>
<td>必须，事务ID</td>
</tr>
<tr>
<td>roll_pointer(DB_ROLL_PTR)</td>
<td>7字节</td>
<td>必须，回滚指针。</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>innodb是以页为基本单位来管理存储空间的，一个页的大小通常是16KB，有时候一个页存不了一条记录，所以mysql中会有溢出列的概念。</p>
</li>
<li>
<p>COMPACT和REDUNDANT行格式中，对于存储占用的空间非常多的列，在记录的真实数据处只会存储该列的一部分数据，而把剩余的数据分散存储到其他的几个页中，然后在记录真实数据处用20字节存储指向这些页的地址和这些页的数据占用的字节数。溢出列之间是使用链表连接起来的。</p>
</li>
<li>
<p>DYNAMIC和COMPRESSED类似于COMPACT行格式，但是在处理溢出列有点差异，他们不会在记录真实数据处存储列真实数据的前768字节，而是把所有的列都存到溢出页中。COMPRESSED行格式会采用压缩算法对页面进行压缩。</p>
</li>
</ul>
<h3 id="innodb数据页结构">
  innodb数据页结构
  <a class="anchor" href="#innodb%e6%95%b0%e6%8d%ae%e9%a1%b5%e7%bb%93%e6%9e%84">#</a>
</h3>
<ul>
<li>一个数据页可以被划分为7个部分，分别如下：
<ul>
<li>File Header：表示页的一些通用信息，占固定的38字节。</li>
<li>Page Header：表示数据页专有的一些信息，占固定的56字节。</li>
<li>Infimum和Supremum：两个虚拟的伪记录，分别表示页中最小记录和最大记录，占固定的26字节。</li>
<li>User Records：真正存储插入的记录，大小不固定。</li>
<li>Free Space：页中尚未使用的部分，大小不固定。</li>
<li>Page Directory：页中某些记录的相对位置，是各个槽对应的记录在页面中的地址偏移量；大小不固定，插入的记录越多，这部分占用的空间越多。</li>
<li>File Trailer：用于检验页是否完整，占固定的8字节。</li>
</ul>
</li>
<li>一条完整的记录时可以比大小的，比较记录的大小就是比较主键的大小。</li>
<li>User Records中的记录之间亲密物件的排列，这种结构称为堆(heap)。把一条记录在堆中的相对位置称为heap_no，靠前的heap_no相对较小，innodb会自动给每个页中加上两条记录，这两条记录一条为最小记录(infimum)，一条为页面的最大记录(supremum)。这两条记录的heap_no最小。堆中的heap_no在分配之后就不会发生改变了，即使之后删除了堆中的某条记录。</li>
<li>每个记录的头信息中都有一个next_record属性，可以是页面中的所有记录串联成一个单向链表。</li>
<li>Innodb会把页中的记录划分为若干个组，每个组的最后一个记录的地址偏移量作为一个槽，存放在Page Directory中，一个槽占用2字节。</li>
<li>在一个页中根据主键查找记录是非常快的，步骤为：通过二分法确定该记录所在分组对应的槽，并找到改槽所在分组中主键值最小的那条记录；通过记录的next_record遍历改槽所在组中的各个记录。</li>
<li>每个数据页的File Header都有上一页和下一页的编号，所有的数据页会组成一个双向链表。</li>
</ul>
    </p>
  </article>
  
  <article class="markdown book-post">
    <h2>
      <a href="/posts/%E5%89%8D%E7%AB%AF/javascript/">Javascript</a>
    </h2>
    
  <h5>2022-01-31</h5>



  

  
  <div>
    
      <a href="/tags/%E5%89%8D%E7%AB%AF/">前端</a>
  </div>
  




    <p><h2 id="基本语法">
  基本语法
  <a class="anchor" href="#%e5%9f%ba%e6%9c%ac%e8%af%ad%e6%b3%95">#</a>
</h2>
<ul>
<li>
<p>变量如果只声明而没有赋值，则该变量的值是<code>undefined</code>。</p>
</li>
<li>
<p>js是一种动态类型语言，变量的类型没有限制，变量可以随时更改类型。</p>
</li>
<li>
<p>js引擎的工作方式是先解析代码，获取所有被声明的变量，然后再一行行的运行，这会使得所有变量的声明语句，都会被提升到代码的头部。</p>
</li>
<li>
<p>变量命名规则如下：第一个字符可以是任意Unicode字母以及<code>$</code>和<code>_</code>，第二个字符及后面的字符还可以用数字0-9。</p>
</li>
</ul>
<h3 id="ifelse">
  if&hellip;else
  <a class="anchor" href="#ifelse">#</a>
</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">m</span> <span style="color:#f92672">===</span> <span style="color:#ae81ff">3</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// 满足条件时，执行的语句
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>} <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// 不满足条件时，执行的语句
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>}
</span></span></code></pre></div><h3 id="switch">
  switch
  <a class="anchor" href="#switch">#</a>
</h3>
<ul>
<li><code>switch</code>语句后面的表达式，与<code>case</code>语句后面的表示式比较运行结果时，采用的是严格相等运算符（<code>===</code>），这意味着比较时不会发生类型转换。</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">switch</span> (<span style="color:#a6e22e">x</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">case</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#39;x 等于1&#39;</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">case</span> <span style="color:#ae81ff">2</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#39;x 等于2&#39;</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">default</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#39;x 等于其他值&#39;</span>);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="三元运算符">
  三元运算符
  <a class="anchor" href="#%e4%b8%89%e5%85%83%e8%bf%90%e7%ae%97%e7%ac%a6">#</a>
</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span>(<span style="color:#a6e22e">条件</span>) <span style="color:#f92672">?</span> <span style="color:#a6e22e">表达式1</span> <span style="color:#f92672">:</span> <span style="color:#a6e22e">表达式2</span>
</span></span></code></pre></div><h3 id="循环语句">
  循环语句
  <a class="anchor" href="#%e5%be%aa%e7%8e%af%e8%af%ad%e5%8f%a5">#</a>
</h3>
<h4 id="while">
  while
  <a class="anchor" href="#while">#</a>
</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">i</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">while</span> (<span style="color:#a6e22e">i</span> <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">100</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#39;i 当前为：&#39;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">i</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">i</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">i</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h4 id="for">
  for
  <a class="anchor" href="#for">#</a>
</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">x</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">i</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; <span style="color:#a6e22e">i</span> <span style="color:#f92672">&lt;</span> <span style="color:#a6e22e">x</span>; <span style="color:#a6e22e">i</span><span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">i</span>);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h4 id="dowhile">
  do&hellip;while
  <a class="anchor" href="#dowhile">#</a>
</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">x</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">i</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">do</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">i</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">i</span><span style="color:#f92672">++</span>;
</span></span><span style="display:flex;"><span>} <span style="color:#66d9ef">while</span>(<span style="color:#a6e22e">i</span> <span style="color:#f92672">&lt;</span> <span style="color:#a6e22e">x</span>);
</span></span></code></pre></div><h3 id="break和continue">
  break和continue
  <a class="anchor" href="#break%e5%92%8ccontinue">#</a>
</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">i</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; <span style="color:#a6e22e">i</span> <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">5</span>; <span style="color:#a6e22e">i</span><span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">i</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">i</span> <span style="color:#f92672">===</span> <span style="color:#ae81ff">3</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">i</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">while</span> (<span style="color:#a6e22e">i</span> <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">100</span>){
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">i</span><span style="color:#f92672">++</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">i</span> <span style="color:#f92672">%</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">===</span> <span style="color:#ae81ff">0</span>) {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">continue</span>;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#39;i 当前为：&#39;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">i</span>);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="数据类型">
  数据类型
  <a class="anchor" href="#%e6%95%b0%e6%8d%ae%e7%b1%bb%e5%9e%8b">#</a>
</h2>
<h3 id="六种数据类型">
  六种数据类型
  <a class="anchor" href="#%e5%85%ad%e7%a7%8d%e6%95%b0%e6%8d%ae%e7%b1%bb%e5%9e%8b">#</a>
</h3>
<ul>
<li>数值（number）：整数和小数（比如<code>1</code>和<code>3.14</code>）。</li>
<li>字符串（string）：文本（比如<code>Hello World</code>）。</li>
<li>布尔值（boolean）：表示真伪的两个特殊值，即<code>true</code>（真）和<code>false</code>（假）。</li>
<li><code>undefined</code>：表示“未定义”或不存在，即由于目前没有定义，所以此处暂时没有任何值。</li>
<li><code>null</code>：表示空值，即此处的值为空。</li>
<li>对象（object）：各种值组成的集合。</li>
</ul>
<h3 id="typeof运算符">
  typeof运算符
  <a class="anchor" href="#typeof%e8%bf%90%e7%ae%97%e7%ac%a6">#</a>
</h3>
<p><code>typeof</code>运算符可以返回一个值的数据类型。</p>
<p>数值、字符串、布尔值分别返回<code>number</code>、<code>string</code>、<code>boolean</code>。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">typeof</span> <span style="color:#ae81ff">123</span> <span style="color:#75715e">// &#34;number&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">typeof</span> <span style="color:#e6db74">&#39;123&#39;</span> <span style="color:#75715e">// &#34;string&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">typeof</span> <span style="color:#66d9ef">false</span> <span style="color:#75715e">// &#34;boolean&#34;
</span></span></span></code></pre></div><p>函数返回<code>function</code>。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">f</span>() {}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">typeof</span> <span style="color:#a6e22e">f</span>
</span></span></code></pre></div><p><code>undefined</code>返回<code>undefined</code>。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">typeof</span> <span style="color:#66d9ef">undefined</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// &#34;undefined&#34;
</span></span></span></code></pre></div><p><code>typeof</code>可以用来检查一个没有声明的变量，而不报错。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">typeof</span> <span style="color:#a6e22e">v</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// &#34;undefined&#34;
</span></span></span></code></pre></div><p>对象返回<code>object</code>。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">typeof</span> window <span style="color:#75715e">// &#34;object&#34;
</span></span></span></code></pre></div><p><code>null</code>返回<code>object</code>。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">typeof</span> <span style="color:#66d9ef">null</span>
</span></span></code></pre></div><p>空数组（<code>[]</code>）的类型也是<code>object</code>，在 JavaScript 内部，数组本质上只是一种特殊的对象。</p>
<h3 id="nullundefined和布尔值">
  null、undefined和布尔值
  <a class="anchor" href="#nullundefined%e5%92%8c%e5%b8%83%e5%b0%94%e5%80%bc">#</a>
</h3>
<ul>
<li>
<p>null是一个表示“空”的对象，转为数值时为0；undefined是一个表示&quot;此处无定义&quot;的原始值，转为数值时为NaN。</p>
</li>
<li>
<p><code>undefined</code>表示“未定义”。</p>
</li>
</ul>
<h3 id="布尔值">
  布尔值
  <a class="anchor" href="#%e5%b8%83%e5%b0%94%e5%80%bc">#</a>
</h3>
<p>下面的值都会被转为<code>false</code>。</p>
<ul>
<li><code>undefined</code></li>
<li><code>null</code></li>
<li><code>false</code></li>
<li><code>0</code></li>
<li><code>NaN</code></li>
<li><code>&quot;&quot;</code>或<code>''</code>（空字符串）</li>
</ul>
<p>空数组（<code>[]</code>）和空对象（<code>{}</code>）对应的布尔值，都是<code>true</code>。</p>
<h2 id="数值">
  数值
  <a class="anchor" href="#%e6%95%b0%e5%80%bc">#</a>
</h2>
<h3 id="整数和浮点数">
  整数和浮点数
  <a class="anchor" href="#%e6%95%b4%e6%95%b0%e5%92%8c%e6%b5%ae%e7%82%b9%e6%95%b0">#</a>
</h3>
<p>JavaScript 内部，所有数字都是以64位浮点数形式储存，即使整数也是如此。所以，<code>1</code>与<code>1.0</code>是相同的，是同一个数。</p>
<h3 id="数值的表示方法">
  数值的表示方法
  <a class="anchor" href="#%e6%95%b0%e5%80%bc%e7%9a%84%e8%a1%a8%e7%a4%ba%e6%96%b9%e6%b3%95">#</a>
</h3>
<p>JavaScript 的数值有多种表示方法，默认情况下，JavaScript 内部会自动将八进制、十六进制、二进制转为十进制。</p>
<ul>
<li>十进制：没有前导0的数值。</li>
<li>八进制：有前缀<code>0o</code>或<code>0O</code>的数值，或者有前导0、且只用到0-7的八个阿拉伯数字的数值。</li>
<li>十六进制：有前缀<code>0x</code>或<code>0X</code>的数值。</li>
<li>二进制：有前缀<code>0b</code>或<code>0B</code>的数值。</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#ae81ff">0xff</span> <span style="color:#75715e">// 255
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#ae81ff">0o377</span> <span style="color:#75715e">// 255
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#ae81ff">0b11</span> <span style="color:#75715e">// 3
</span></span></span></code></pre></div><p>数值也可以采用科学计数法表示，下面是几个科学计数法的例子。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#ae81ff">123e3</span> <span style="color:#75715e">// 123000
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#ae81ff">123e-3</span> <span style="color:#75715e">// 0.123
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#f92672">-</span><span style="color:#ae81ff">3.1</span><span style="color:#a6e22e">E</span><span style="color:#f92672">+</span><span style="color:#ae81ff">12</span>
</span></span><span style="display:flex;"><span>.<span style="color:#ae81ff">1e-23</span>
</span></span></code></pre></div><h3 id="nan">
  NaN
  <a class="anchor" href="#nan">#</a>
</h3>
<p><code>NaN</code>是 JavaScript 的特殊值，表示“非数字”（Not a Number），主要出现在将字符串解析成数字出错的场合。</p>
<pre tabindex="0"><code>5 - &#39;x&#39; // NaN
</code></pre><p><code>NaN</code>不是独立的数据类型，而是一个特殊数值，它的数据类型依然属于<code>Number</code>，使用<code>typeof</code>运算符可以看得很清楚。</p>
<p><code>NaN</code>不等于任何值，包括它本身。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">NaN</span> <span style="color:#f92672">===</span> <span style="color:#66d9ef">NaN</span> <span style="color:#75715e">// false
</span></span></span></code></pre></div><h3 id="infinity">
  Infinity
  <a class="anchor" href="#infinity">#</a>
</h3>
<p>Infinity表示“无穷”，用来表示两种场景。一种是一个正的数值太大，或一个负的数值太小，无法表示；另一种是非0数值除以0，得到Infinity。</p>
<p><code>Infinity</code>有正负之分，<code>Infinity</code>表示正的无穷，<code>-Infinity</code>表示负的无穷。</p>
<p><code>Infinity</code>大于一切数值（除了<code>NaN</code>），<code>-Infinity</code>小于一切数值（除了<code>NaN</code>）。</p>
<p><code>Infinity</code>的四则运算，符合无穷的数学计算规则。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#ae81ff">5</span> <span style="color:#f92672">*</span> <span style="color:#66d9ef">Infinity</span> <span style="color:#75715e">// Infinity
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#ae81ff">5</span> <span style="color:#f92672">-</span> <span style="color:#66d9ef">Infinity</span> <span style="color:#75715e">// -Infinity
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">Infinity</span> <span style="color:#f92672">/</span> <span style="color:#ae81ff">5</span> <span style="color:#75715e">// Infinity
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#ae81ff">5</span> <span style="color:#f92672">/</span> <span style="color:#66d9ef">Infinity</span> <span style="color:#75715e">// 0
</span></span></span></code></pre></div><h3 id="相关函数">
  相关函数
  <a class="anchor" href="#%e7%9b%b8%e5%85%b3%e5%87%bd%e6%95%b0">#</a>
</h3>
<h4 id="parseint">
  parseInt
  <a class="anchor" href="#parseint">#</a>
</h4>
<p><code>parseInt</code>方法用于将字符串转为整数。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span>parseInt(<span style="color:#e6db74">&#39;123&#39;</span>) <span style="color:#75715e">// 123
</span></span></span></code></pre></div><p>如果字符串头部有空格，空格会被自动去除。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span>parseInt(<span style="color:#e6db74">&#39;   81&#39;</span>) <span style="color:#75715e">// 81
</span></span></span></code></pre></div><p>如果<code>parseInt</code>的参数不是字符串，则会先转为字符串再转换。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span>parseInt(<span style="color:#ae81ff">1.23</span>) <span style="color:#75715e">// 1
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// 等同于
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>parseInt(<span style="color:#e6db74">&#39;1.23&#39;</span>) <span style="color:#75715e">// 1
</span></span></span></code></pre></div><p>字符串转为整数的时候，是一个个字符依次转换，如果遇到不能转为数字的字符，就不再进行下去，返回已经转好的部分。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span>parseInt(<span style="color:#e6db74">&#39;8a&#39;</span>) <span style="color:#75715e">// 8
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>parseInt(<span style="color:#e6db74">&#39;12**&#39;</span>) <span style="color:#75715e">// 12
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>parseInt(<span style="color:#e6db74">&#39;12.34&#39;</span>) <span style="color:#75715e">// 12
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>parseInt(<span style="color:#e6db74">&#39;15e2&#39;</span>) <span style="color:#75715e">// 15
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>parseInt(<span style="color:#e6db74">&#39;15px&#39;</span>) <span style="color:#75715e">// 15
</span></span></span></code></pre></div><p>如果字符串的第一个字符不能转化为数字（后面跟着数字的正负号除外），返回<code>NaN</code>。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span>parseInt(<span style="color:#e6db74">&#39;abc&#39;</span>) <span style="color:#75715e">// NaN
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>parseInt(<span style="color:#e6db74">&#39;+1&#39;</span>) <span style="color:#75715e">// 1
</span></span></span></code></pre></div><p>对于那些会自动转为科学计数法的数字，<code>parseInt</code>会将科学计数法的表示方法视为字符串，因此导致一些奇怪的结果。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span>parseInt(<span style="color:#ae81ff">1000000000000000000000.5</span>) <span style="color:#75715e">// 1
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// 等同于
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>parseInt(<span style="color:#e6db74">&#39;1e+21&#39;</span>) <span style="color:#75715e">// 1
</span></span></span></code></pre></div><h4 id="parsefloat">
  parseFloat
  <a class="anchor" href="#parsefloat">#</a>
</h4>
<p><code>parseFloat</code>方法用于将一个字符串转为浮点数。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span>parseFloat(<span style="color:#e6db74">&#39;3.14&#39;</span>) <span style="color:#75715e">// 3.14
</span></span></span></code></pre></div><p>如果字符串符合科学计数法，则会进行相应的转换。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span>parseFloat(<span style="color:#e6db74">&#39;314e-2&#39;</span>) <span style="color:#75715e">// 3.14
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>parseFloat(<span style="color:#e6db74">&#39;0.0314E+2&#39;</span>) <span style="color:#75715e">// 3.14
</span></span></span></code></pre></div><p>如果字符串包含不能转为浮点数的字符，则不再进行往后转换，返回已经转好的部分。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span>parseFloat(<span style="color:#e6db74">&#39;3.14more non-digit characters&#39;</span>) <span style="color:#75715e">// 3.14
</span></span></span></code></pre></div><p><code>parseFloat</code>方法会自动过滤字符串前导的空格。</p>
<pre tabindex="0"><code>parseFloat(&#39;\t\v\r12.34\n &#39;) // 12.34
</code></pre><p>如果参数不是字符串，或者字符串的第一个字符不能转化为浮点数，则返回<code>NaN</code>。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span>parseFloat([]) <span style="color:#75715e">// NaN
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>parseFloat(<span style="color:#e6db74">&#39;&#39;</span>) <span style="color:#75715e">// NaN
</span></span></span></code></pre></div><h4 id="isnan">
  isNaN
  <a class="anchor" href="#isnan">#</a>
</h4>
<p><code>isNaN</code>方法可以用来判断一个值是否为<code>NaN</code>。</p>
<pre tabindex="0"><code>isNaN(NaN) // true
isNaN(123) // false
</code></pre><p>但是，<code>isNaN</code>只对数值有效，如果传入其他值，会被先转成数值。比如，传入字符串的时候，字符串会被先转成<code>NaN</code>，所以最后返回<code>true</code>，<code>isNaN</code>为<code>true</code>的值，有可能不是<code>NaN</code>，而是一个字符串。</p>
<p>判断<code>NaN</code>更可靠的方法是，利用<code>NaN</code>为唯一不等于自身的值的这个特点，进行判断。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">myIsNaN</span>(<span style="color:#a6e22e">value</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">value</span> <span style="color:#f92672">!==</span> <span style="color:#a6e22e">value</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h4 id="isfinite">
  isFinite
  <a class="anchor" href="#isfinite">#</a>
</h4>
<p><code>isFinite</code>方法返回一个布尔值，表示某个值是否为正常的数值。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span>isFinite(<span style="color:#66d9ef">Infinity</span>) <span style="color:#75715e">// false
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>isFinite(<span style="color:#f92672">-</span><span style="color:#66d9ef">Infinity</span>) <span style="color:#75715e">// false
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>isFinite(<span style="color:#66d9ef">NaN</span>) <span style="color:#75715e">// false
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>isFinite(<span style="color:#66d9ef">undefined</span>) <span style="color:#75715e">// false
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>isFinite(<span style="color:#66d9ef">null</span>) <span style="color:#75715e">// true
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>isFinite(<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>) <span style="color:#75715e">// true
</span></span></span></code></pre></div><h2 id="字符串">
  字符串
  <a class="anchor" href="#%e5%ad%97%e7%ac%a6%e4%b8%b2">#</a>
</h2>
<p>字符串就是零个或多个排在一起的字符，放在单引号或双引号之中。</p>
<p>字符串可以被视为字符数组，因此可以使用数组的方括号运算符，用来返回某个位置的字符（位置编号从0开始）。但无法改变字符串之中的单个字符。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">s</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;hello&#39;</span>;
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">s</span>[<span style="color:#ae81ff">0</span>] <span style="color:#75715e">// &#34;h&#34;
</span></span></span></code></pre></div><h3 id="length">
  length
  <a class="anchor" href="#length">#</a>
</h3>
<p><code>length</code>属性返回字符串的长度。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">s</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;hello&#39;</span>;
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">s</span>.<span style="color:#a6e22e">length</span> <span style="color:#75715e">// 5
</span></span></span></code></pre></div><h2 id="对象">
  对象
  <a class="anchor" href="#%e5%af%b9%e8%b1%a1">#</a>
</h2>
<p>对象就是一组“键值对”（key-value）的集合，是一种无序的复合数据集合。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">obj</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">foo</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;Hello&#39;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">bar</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;World&#39;</span>
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></div><p>对象的所有键都是字符串，所以加不加引号都可以。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">obj</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#39;foo&#39;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;Hello&#39;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#39;bar&#39;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;World&#39;</span>
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></div><p>对象的每一个键又称为“属性”（property），它的“键值”可以是任何数据类型。如果一个属性的值为函数，通常把这个属性称为“方法”，它可以像函数那样调用。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">obj</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">p</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">function</span> (<span style="color:#a6e22e">x</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">*</span> <span style="color:#a6e22e">x</span>;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">obj</span>.<span style="color:#a6e22e">p</span>(<span style="color:#ae81ff">1</span>) <span style="color:#75715e">// 2
</span></span></span></code></pre></div><p>属性可以动态创建，不必在对象声明时就指定。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">obj</span> <span style="color:#f92672">=</span> {};
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">obj</span>.<span style="color:#a6e22e">foo</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">123</span>;
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">obj</span>.<span style="color:#a6e22e">foo</span> <span style="color:#75715e">// 123
</span></span></span></code></pre></div><h3 id="对象引用">
  对象引用
  <a class="anchor" href="#%e5%af%b9%e8%b1%a1%e5%bc%95%e7%94%a8">#</a>
</h3>
<p>如果不同的变量名指向同一个对象，那么它们都是这个对象的引用，也就是说指向同一个内存地址。修改其中一个变量，会影响到其他所有变量。</p>
<h3 id="对象属性">
  对象属性
  <a class="anchor" href="#%e5%af%b9%e8%b1%a1%e5%b1%9e%e6%80%a7">#</a>
</h3>
<p>读取对象的属性，有两种方法，一种是使用点运算符，还有一种是使用方括号运算符。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">obj</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">p</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;Hello World&#39;</span>
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">obj</span>.<span style="color:#a6e22e">p</span> <span style="color:#75715e">// &#34;Hello World&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">//如果使用方括号运算符，键名必须放在引号里面
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">obj</span>[<span style="color:#e6db74">&#39;p&#39;</span>] <span style="color:#75715e">// &#34;Hello World&#34;
</span></span></span></code></pre></div><p>点运算符和方括号运算符，不仅可以用来读取值，还可以用来赋值。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">obj</span> <span style="color:#f92672">=</span> {};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">obj</span>.<span style="color:#a6e22e">foo</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;Hello&#39;</span>;
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">obj</span>[<span style="color:#e6db74">&#39;bar&#39;</span>] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;World&#39;</span>;
</span></span></code></pre></div><h3 id="属性的查看">
  属性的查看
  <a class="anchor" href="#%e5%b1%9e%e6%80%a7%e7%9a%84%e6%9f%a5%e7%9c%8b">#</a>
</h3>
<p>查看一个对象本身的所有属性，可以使用<code>Object.keys</code>方法。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">obj</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">key1</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">key2</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Object.<span style="color:#a6e22e">keys</span>(<span style="color:#a6e22e">obj</span>);
</span></span></code></pre></div><h3 id="属性的删除">
  属性的删除
  <a class="anchor" href="#%e5%b1%9e%e6%80%a7%e7%9a%84%e5%88%a0%e9%99%a4">#</a>
</h3>
<p><code>delete</code>命令用于删除对象的属性，删除成功后返回<code>true</code>。</p>
<p>删除一个不存在的属性，<code>delete</code>不报错，而且返回<code>true</code>。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">obj</span> <span style="color:#f92672">=</span> { <span style="color:#a6e22e">p</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">1</span> };
</span></span><span style="display:flex;"><span>Object.<span style="color:#a6e22e">keys</span>(<span style="color:#a6e22e">obj</span>) <span style="color:#75715e">// [&#34;p&#34;]
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">delete</span> <span style="color:#a6e22e">obj</span>.<span style="color:#a6e22e">p</span> <span style="color:#75715e">// true
</span></span></span></code></pre></div><h3 id="属性是否存在in-运算符">
  属性是否存在：in 运算符
  <a class="anchor" href="#%e5%b1%9e%e6%80%a7%e6%98%af%e5%90%a6%e5%ad%98%e5%9c%a8in-%e8%bf%90%e7%ae%97%e7%ac%a6">#</a>
</h3>
<p><code>in</code>运算符用于检查对象是否包含某个属性。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">obj</span> <span style="color:#f92672">=</span> { <span style="color:#a6e22e">p</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">1</span> };
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#39;p&#39;</span> <span style="color:#66d9ef">in</span> <span style="color:#a6e22e">obj</span> <span style="color:#75715e">// true
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#e6db74">&#39;toString&#39;</span> <span style="color:#66d9ef">in</span> <span style="color:#a6e22e">obj</span> <span style="color:#75715e">// true
</span></span></span></code></pre></div><h3 id="属性的遍历forin-循环">
  属性的遍历：for&hellip;in 循环
  <a class="anchor" href="#%e5%b1%9e%e6%80%a7%e7%9a%84%e9%81%8d%e5%8e%86forin-%e5%be%aa%e7%8e%af">#</a>
</h3>
<p><code>for...in</code>循环用来遍历一个对象的全部属性。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">obj</span> <span style="color:#f92672">=</span> {<span style="color:#a6e22e">a</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">1</span>, <span style="color:#a6e22e">b</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">2</span>, <span style="color:#a6e22e">c</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">3</span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">i</span> <span style="color:#66d9ef">in</span> <span style="color:#a6e22e">obj</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#39;键名：&#39;</span>, <span style="color:#a6e22e">i</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#39;键值：&#39;</span>, <span style="color:#a6e22e">obj</span>[<span style="color:#a6e22e">i</span>]);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><code>for...in</code>循环有两个使用注意点。</p>
<ul>
<li>它遍历的是对象所有可遍历（enumerable）的属性，会跳过不可遍历的属性。</li>
<li>它不仅遍历对象自身的属性，还遍历继承的属性。</li>
</ul>
<h2 id="函数">
  函数
  <a class="anchor" href="#%e5%87%bd%e6%95%b0">#</a>
</h2>
<h3 id="function">
  function
  <a class="anchor" href="#function">#</a>
</h3>
<p><code>function</code>命令声明的代码区块，就是一个函数。<code>function</code>命令后面是函数名，函数名后面是一对圆括号，里面是传入函数的参数。函数体放在大括号里面。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">print</span>(<span style="color:#a6e22e">s</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">s</span>);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="函数表达式">
  函数表达式
  <a class="anchor" href="#%e5%87%bd%e6%95%b0%e8%a1%a8%e8%be%be%e5%bc%8f">#</a>
</h3>
<p>除了用<code>function</code>命令声明函数，还可以采用变量赋值的写法。</p>
<pre tabindex="0"><code>var print = function(s) {
  console.log(s);
};
</code></pre><h3 id="name属性">
  name属性
  <a class="anchor" href="#name%e5%b1%9e%e6%80%a7">#</a>
</h3>
<p>函数的<code>name</code>属性返回函数的名字。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">f1</span>() {}
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">f1</span>.<span style="color:#a6e22e">name</span> <span style="color:#75715e">// &#34;f1&#34;
</span></span></span></code></pre></div><h2 id="数组">
  数组
  <a class="anchor" href="#%e6%95%b0%e7%bb%84">#</a>
</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">arr</span> <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;a&#39;</span>, <span style="color:#e6db74">&#39;b&#39;</span>, <span style="color:#e6db74">&#39;c&#39;</span>];
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">//除了在定义时赋值，数组也可以先定义后赋值。
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">//任何类型的数据，都可以放入数组。
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">arr</span> <span style="color:#f92672">=</span> [];
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">arr</span>[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;a&#39;</span>;
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">arr</span>[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">=</span> [<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>];
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">arr</span>[<span style="color:#ae81ff">2</span>] <span style="color:#f92672">=</span> {<span style="color:#a6e22e">a</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">1</span>};
</span></span></code></pre></div><p>数组属于一种特殊的对象。<code>typeof</code>运算符会返回数组的类型是<code>object</code>。</p>
<p><code>Object.keys</code>方法返回数组的所有键名。可以看到数组的键名就是整数0、1、2。</p>
<p>JavaScript 语言规定，对象的键名一律为字符串，所以，数组的键名其实也是字符串。</p>
<h3 id="length-属性">
  length 属性
  <a class="anchor" href="#length-%e5%b1%9e%e6%80%a7">#</a>
</h3>
<p>数组的<code>length</code>属性，返回数组的成员数量。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span>[<span style="color:#e6db74">&#39;a&#39;</span>, <span style="color:#e6db74">&#39;b&#39;</span>, <span style="color:#e6db74">&#39;c&#39;</span>].<span style="color:#a6e22e">length</span> <span style="color:#75715e">// 3
</span></span></span></code></pre></div><h3 id="forin-循环">
  for&hellip;in 循环
  <a class="anchor" href="#forin-%e5%be%aa%e7%8e%af">#</a>
</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">a</span> <span style="color:#f92672">=</span> [<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>];
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">i</span> <span style="color:#66d9ef">in</span> <span style="color:#a6e22e">a</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">a</span>[<span style="color:#a6e22e">i</span>]);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div>
    </p>
  </article>
  
  <article class="markdown book-post">
    <h2>
      <a href="/posts/javaee/elasticsearch%E8%B5%B7%E6%AD%A5/">Elasticsearch起步</a>
    </h2>
    
  <h5>2022-01-15</h5>



  

  
  <div>
    
      <a href="/tags/java/">java</a>
  </div>
  




    <p><ul>
<li>es是面向文档型数据库，一条数据在这里就是一条文档。</li>
</ul>
<h2 id="索引">
  索引
  <a class="anchor" href="#%e7%b4%a2%e5%bc%95">#</a>
</h2>
<ul>
<li>创建索引<code>PUT http://ip:9200/索引名称</code>。</li>
<li>获取索引的相关信息<code>GET http://ip:9200/索引名称</code>。</li>
<li>获取所有的索引<code>GET http://ip:9200/_cat/indices?v</code>。</li>
<li>删除索引<code>DELETE http://ip:9200/索引名称</code>。</li>
</ul>
<h2 id="文档">
  文档
  <a class="anchor" href="#%e6%96%87%e6%a1%a3">#</a>
</h2>
<h3 id="添加文档">
  添加文档
  <a class="anchor" href="#%e6%b7%bb%e5%8a%a0%e6%96%87%e6%a1%a3">#</a>
</h3>
<pre tabindex="0"><code>POST /索引名称/_doc
{
    &#34;title&#34;: &#34;xiaoxiang&#34;,
    &#34;url&#34;: &#34;xiaoxiang.space&#34;
}

PUT /索引名称/_doc/id
{
    &#34;title&#34;: &#34;xiaoxiang&#34;,
    &#34;url&#34;: &#34;xiaoxiang.space&#34;
}

PUT /&lt;target&gt;/_doc/&lt;_id&gt; 
POST /&lt;target&gt;/_doc/ 
PUT /&lt;target&gt;/_create/&lt;_id&gt; 
POST /&lt;target&gt;/_create/&lt;_id&gt;
</code></pre><h3 id="查询数据">
  查询数据
  <a class="anchor" href="#%e6%9f%a5%e8%af%a2%e6%95%b0%e6%8d%ae">#</a>
</h3>
<pre tabindex="0"><code>//查询一条数据
GET /索引名称/_doc/id

//全部查询
GET /索引名称/_search?pretty
</code></pre><h3 id="修改数据">
  修改数据
  <a class="anchor" href="#%e4%bf%ae%e6%94%b9%e6%95%b0%e6%8d%ae">#</a>
</h3>
<pre tabindex="0"><code>POST /索引名称/_update/12
{
    &#34;doc&#34;: {
        &#34;title&#34;: &#34;xiaoxiangmax&#34;
    }
}

#可以使用PUT进行数据修改，但需要罗列所有的字段
PUT my_goods/_doc/10 
{ 
	&#34;goodsName&#34;: &#34;三星 UA55RU7520JXXZ 52 英寸 4K 超高清&#34;,
	&#34;skuCode&#34;: &#34;skuCode10&#34;,
	...
}
</code></pre><h3 id="删除数据">
  删除数据
  <a class="anchor" href="#%e5%88%a0%e9%99%a4%e6%95%b0%e6%8d%ae">#</a>
</h3>
<pre tabindex="0"><code>DELETE /索引名称/_doc/id

#查询删除
POST /my_goods/_delete_by_query 
{ 
	&#34;query&#34;: { 
		&#34;match&#34;: { 
			&#34;shopCode&#34;: &#34;sc00002&#34; 
		} 
	} 
}
</code></pre><h2 id="文档复杂查询">
  文档复杂查询
  <a class="anchor" href="#%e6%96%87%e6%a1%a3%e5%a4%8d%e6%9d%82%e6%9f%a5%e8%af%a2">#</a>
</h2>
<h3 id="添加查询条件">
  添加查询条件
  <a class="anchor" href="#%e6%b7%bb%e5%8a%a0%e6%9f%a5%e8%af%a2%e6%9d%a1%e4%bb%b6">#</a>
</h3>
<pre tabindex="0"><code>//增加条件查询
GET /索引名称/_search
{
    &#34;query&#34;: {
        &#34;match&#34;: {
            &#34;category&#34;: &#34;xiaoxiang&#34;
        }
    }
}

//不拆解搜索字段
GET /gw_audit-*/_search
{
  &#34;query&#34;: {
    &#34;bool&#34;: {
      &#34;must&#34;: [
        {
          &#34;match_phrase&#34;: {
            &#34;user_name&#34;: &#34;zhao fei&#34;
          }
        }
      ]
    }
  }
}
</code></pre><h3 id="添加高亮显示">
  添加高亮显示
  <a class="anchor" href="#%e6%b7%bb%e5%8a%a0%e9%ab%98%e4%ba%ae%e6%98%be%e7%a4%ba">#</a>
</h3>
<pre tabindex="0"><code>//对某个条件添加高亮显示
GET /gw_audit-*/_search
{
  &#34;query&#34;: {
    &#34;bool&#34;: {
      &#34;must&#34;: [
        {
          &#34;match_phrase&#34;: {
            &#34;user_name&#34;: &#34;kpf&#34;
          }
        }
      ]
    }
  },
  &#34;highlight&#34;: {
    &#34;fields&#34;: {
      &#34;user_name&#34;: {}
    }
  }
}
</code></pre><h3 id="多条件查询">
  多条件查询
  <a class="anchor" href="#%e5%a4%9a%e6%9d%a1%e4%bb%b6%e6%9f%a5%e8%af%a2">#</a>
</h3>
<pre tabindex="0"><code>//多条件查询，(相当于and)
{
  &#34;query&#34;: {
    &#34;bool&#34;: {
      &#34;must&#34;: [
        {
          &#34;match&#34;: {
            &#34;category&#34;: &#34;xiaoxiang&#34;
          }
        },
        {
          &#34;match&#34;: {
            &#34;price&#34;: &#34;5999&#34;
          }
        }
      ]
    }
  }
}

//多条件查询，一个字段多个查询的值(相当于or)
GET /gw_audit-*/_search
{
  &#34;query&#34;: {
    &#34;bool&#34;: {
      &#34;should&#34;: [
        {
          &#34;match&#34;: {
            &#34;user_name&#34;: &#34;kpf&#34;
          }
        },
        {
          &#34;match&#34;: {
            &#34;user_name&#34;: &#34;zj&#34;
          }
        }
      ]
    }
  },
  &#34;size&#34;: 20000
}
</code></pre><h3 id="区间查询">
  区间查询
  <a class="anchor" href="#%e5%8c%ba%e9%97%b4%e6%9f%a5%e8%af%a2">#</a>
</h3>
<pre tabindex="0"><code>#区间查询
GET /gw_audit-*/_search
{
  &#34;query&#34;: {
    &#34;bool&#34;: {
      &#34;filter&#34;: [
        {
          &#34;range&#34;: {
            &#34;spent&#34;: {
              &#34;gte&#34;: 10,
              &#34;lte&#34;: 200
            }
          }
        }
      ]
    }
  }
}
</code></pre><h3 id="分页查询">
  分页查询
  <a class="anchor" href="#%e5%88%86%e9%a1%b5%e6%9f%a5%e8%af%a2">#</a>
</h3>
<pre tabindex="0"><code>//全量分页查询
GET /gw_audit-*/_search
{
	&#34;query&#34;: {
		&#34;match_all&#34;: {
		
		}
	},
	&#34;from&#34;: 0,
	&#34;size&#34;: 10
}
</code></pre><h3 id="只查询指定字段">
  只查询指定字段
  <a class="anchor" href="#%e5%8f%aa%e6%9f%a5%e8%af%a2%e6%8c%87%e5%ae%9a%e5%ad%97%e6%ae%b5">#</a>
</h3>
<pre tabindex="0"><code>//只查询指定字段
GET /索引名称/_search
{
	&#34;query&#34;: {
		&#34;match_all&#34;: {
		
		}
	},
	&#34;from&#34;: 0,
	&#34;size&#34;: 10,
	&#34;_source&#34;: [&#34;title&#34;]
}
</code></pre><h3 id="对结果排序">
  对结果排序
  <a class="anchor" href="#%e5%af%b9%e7%bb%93%e6%9e%9c%e6%8e%92%e5%ba%8f">#</a>
</h3>
<pre tabindex="0"><code>//对结果排序
GET /索引名称/_search
{
	&#34;query&#34;: {
		&#34;match_all&#34;: {
		
		}
	},
	&#34;from&#34;: 0,
	&#34;size&#34;: 10,
	&#34;sort&#34;: {
		&#34;price&#34;: {
			&#34;order&#34;: &#34;desc&#34;
		}
	}
}
</code></pre><h3 id="聚合操作求每组的数量">
  聚合操作，求每组的数量
  <a class="anchor" href="#%e8%81%9a%e5%90%88%e6%93%8d%e4%bd%9c%e6%b1%82%e6%af%8f%e7%bb%84%e7%9a%84%e6%95%b0%e9%87%8f">#</a>
</h3>
<pre tabindex="0"><code>#对查询结果进行聚合操作，统计每一组的数量
GET /gw_audit-*/_search
{
  &#34;aggs&#34;: {
    &#34;user_name_group&#34;: {
      &#34;terms&#34;: {
        &#34;field&#34;: &#34;user_name&#34;
      }
    }
  },
  &#34;size&#34;: 0
}
</code></pre><h3 id="聚合操作统计平均值">
  聚合操作，统计平均值
  <a class="anchor" href="#%e8%81%9a%e5%90%88%e6%93%8d%e4%bd%9c%e7%bb%9f%e8%ae%a1%e5%b9%b3%e5%9d%87%e5%80%bc">#</a>
</h3>
<pre tabindex="0"><code>#对查询结果进行聚合操作，统计平均值
GET /gw_audit-*/_search
{
  &#34;aggs&#34;: {
    &#34;user_name_avg&#34;: {
      &#34;avg&#34;: {
        &#34;field&#34;: &#34;spent&#34;
      }
    }
  },
  &#34;size&#34;: 0
}
</code></pre><h3 id="设置映射关系">
  设置映射关系
  <a class="anchor" href="#%e8%ae%be%e7%bd%ae%e6%98%a0%e5%b0%84%e5%85%b3%e7%b3%bb">#</a>
</h3>
<pre tabindex="0"><code>//设置映射关系
PUT test/_mapping
{
  &#34;properties&#34;: {
    &#34;name&#34;: {
      &#34;type&#34;: &#34;text&#34;, 
      &#34;index&#34;: true
    },
    &#34;sex&#34;: {
      &#34;type&#34;: &#34;keyword&#34;, //关键字不会被分开
      &#34;index&#34;: &#34;true&#34;
    },
    &#34;tel&#34;: {
      &#34;type&#34;: &#34;keyword&#34;,
      &#34;index&#34;: false
    }
  }
}
</code></pre><h2 id="_reindex">
  _reindex
  <a class="anchor" href="#_reindex">#</a>
</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">PUT</span> <span style="color:#960050;background-color:#1e0010">cpu</span><span style="color:#ae81ff">-2022</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;mappings&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;dynamic&#34;</span>: <span style="color:#e6db74">&#34;false&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;properties&#34;</span>: {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;cpu&#34;</span>: {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;type&#34;</span>: <span style="color:#e6db74">&#34;keyword&#34;</span>
</span></span><span style="display:flex;"><span>      },
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;host_name&#34;</span>: {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;type&#34;</span>: <span style="color:#e6db74">&#34;keyword&#34;</span>
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">POST</span> <span style="color:#960050;background-color:#1e0010">_reindex</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;source&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;index&#34;</span>: <span style="color:#e6db74">&#34;cpu-2022.07.*&#34;</span>
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;dest&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;index&#34;</span>: <span style="color:#e6db74">&#34;cpu-2022&#34;</span>
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">DELETE</span> <span style="color:#960050;background-color:#1e0010">cpu</span><span style="color:#ae81ff">-2022.07</span><span style="color:#960050;background-color:#1e0010">.*</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">GET</span> <span style="color:#960050;background-color:#1e0010">cpu</span><span style="color:#ae81ff">-2022</span><span style="color:#960050;background-color:#1e0010">/_search</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;size&#34;</span>: <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;track_total_hits&#34;</span>: <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div>
    </p>
  </article>
  
  <article class="markdown book-post">
    <h2>
      <a href="/posts/%E5%85%B6%E4%BB%96/%E6%AD%A3%E5%88%99/">正则</a>
    </h2>
    
  <h5>2022-01-12</h5>



  

  
  <div>
    
      <a href="/tags/java/">java</a>
  </div>
  




    <p><ul>
<li>完整的正则表达式由两种字符构成，特殊字符（元字符）和文字（普通字符）。</li>
</ul>
<h2 id="egrep命令">
  egrep命令
  <a class="anchor" href="#egrep%e5%91%bd%e4%bb%a4">#</a>
</h2>
<table>
<thead>
<tr>
<th>元字符</th>
<th>案例</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>^</code>匹配行的开始，<code>$</code>匹配行的结束。</td>
<td><code>^cat$</code> 匹配以c作为一行的第一个字符，紧接着一个a，紧接着以t结尾。</td>
</tr>
<tr>
<td><code>[abc]</code> (字符组)匹配多个字符之一</td>
<td><code>[-a-cA-D1.?_]</code> 匹配<code>-abcABCD1.?_</code>中的一个。<code>-</code>(连字符)表示一个范围，只有在字符组内他才可能是一个元字符，如果连字符出现在字符组开头，那么它表示的就是一个普通符号。在字符组中，`?.*</td>
</tr>
<tr>
<td><code>[^ABC]</code>排除型字符组</td>
<td><code>q[^u]</code> 匹配q后面的字符不为u的情况，注意：这要求q后面必须要有一个字符。<br /><code>[^-</code>中的连字符也不是一个元字符。</td>
</tr>
<tr>
<td><code>.</code>匹配任意字符</td>
<td>注意：在字符组中的<code>.</code>是普通字符。</td>
</tr>
<tr>
<td>`</td>
<td>` 表示或</td>
</tr>
<tr>
<td></td>
<td>egrep的<code>-i</code>参数表示忽略大小写。</td>
</tr>
<tr>
<td><code>\&lt;</code> 和<code>\&gt;</code>单词的起始位置和结束位置。</td>
<td><code>\&lt;cat</code> 匹配以cat开头的单词，<code>cat\&gt;</code> 匹配以cat结尾的单词。</td>
</tr>
<tr>
<td><code>?</code> 表示可选</td>
<td><code>July?</code>表示y是可选的，该正则可以匹配July和Jul。<br /><code>July? 4(th)?</code>中的th是可选的，可以匹配<code>July 4</code>和<code>July 4th</code>。</td>
</tr>
<tr>
<td><code>+</code> 表示紧邻的元素出现一次或多次<br /><code>*</code>表示紧邻的元素出现0次或多次</td>
<td><code>.+</code> 表示匹配任意字符至少一次。<br /><code>.*</code> 表示匹配任意字符0次到无数次。</td>
</tr>
<tr>
<td><code>{min,max}</code> 区间量词</td>
<td>允许重现的次数在[min,max]之间。</td>
</tr>
<tr>
<td>反向引用</td>
<td>如<code>([a-z]{3})([0-9]).+\1\2</code> 括号<code>()</code>可以记住子表达式的文本，元字符<code>\1\2</code>可以引用这些文本。从而这个正则可以匹配<code>the9 the9</code>。</td>
</tr>
<tr>
<td><code>\</code> 转义：将元字符转义为普通字符</td>
<td><code>\.</code> 表示一个普通的<code>.</code></td>
</tr>
<tr>
<td><code>()</code> 限制多选结构、分组、捕获文本</td>
<td>限制多选结构指的是和`</td>
</tr>
<tr>
<td>(?:&hellip;)</td>
<td>仅用于分组，但是不捕获</td>
</tr>
</tbody>
</table>
<h2 id="perl">
  Perl
  <a class="anchor" href="#perl">#</a>
</h2>
<h3 id="使用正则匹配文本">
  使用正则匹配文本
  <a class="anchor" href="#%e4%bd%bf%e7%94%a8%e6%ad%a3%e5%88%99%e5%8c%b9%e9%85%8d%e6%96%87%e6%9c%ac">#</a>
</h3>
<ul>
<li>Perl用<code>$variable =~ m/regex/</code>来判断一个正则表达式能否匹配某个字符串，<code>m</code>表示匹配<code>match</code>，可以省略，斜线用来标注正则表达式的边界。</li>
<li>元字符是具有特殊意义的字符，各个语言中对元字符的定义并不是统一的。</li>
<li>Perl和其他流派的正则表达式提供了许多有用的简记法。</li>
</ul>
<table>
<thead>
<tr>
<th>\b</th>
<th>作为单词起始和单词结束的元字符</th>
</tr>
</thead>
<tbody>
<tr>
<td>\t</td>
<td>制表符</td>
</tr>
<tr>
<td>\n</td>
<td>换行符</td>
</tr>
<tr>
<td>\r</td>
<td>回车符</td>
</tr>
<tr>
<td>\s</td>
<td>任何空白字符，如空格符、制表符等</td>
</tr>
<tr>
<td>\S</td>
<td>除了<code>\s</code>外的任何字符</td>
</tr>
<tr>
<td>\w</td>
<td>[a-zA-Z0-9_]</td>
</tr>
<tr>
<td>\W</td>
<td>除了<code>\w</code>外的任何符号</td>
</tr>
<tr>
<td>\d</td>
<td>[0-9]</td>
</tr>
<tr>
<td>\D</td>
<td>除了<code>\d</code>外的任何符号</td>
</tr>
</tbody>
</table>
<ul>
<li><code>/i</code>修饰符表示此测试不区分大小写。</li>
<li><strong><code>(?:...)</code>表示可以用来分组文本，但是不捕获。</strong></li>
<li>匹配成功后，Perl可以使用<code>$1</code> <code>$2</code> <code>$3</code> 之类的变量来保存相对应的<code>(...)</code>括号内的子表达式匹配的文本。</li>
<li>子表达式的编号按照小括号出现的先后排序，从1开始，子表达式可以嵌套。</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-perl" data-lang="perl"><span style="display:flex;"><span><span style="color:#75715e"># perl温度转换</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">print</span> <span style="color:#e6db74">&#34;enter a temperature(e.g., 32F, 100C):\n&#34;</span>;
</span></span><span style="display:flex;"><span>$input <span style="color:#f92672">=</span> <span style="color:#e6db74">&lt;STDIN&gt;</span>;	<span style="color:#75715e">#接收用户输入</span>
</span></span><span style="display:flex;"><span>chomp($input);	<span style="color:#75715e">#去掉输入末尾的换行</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> ($input <span style="color:#f92672">=~</span> <span style="color:#e6db74">m/^([-+]?[0-9]+(\.[0-9]*)?)\s*([CF])$/i</span>)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>	$InputNum <span style="color:#f92672">=</span> $1;
</span></span><span style="display:flex;"><span>	$type <span style="color:#f92672">=</span> $3;
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">if</span> ($type <span style="color:#f92672">=~</span> <span style="color:#e6db74">m/c/i</span>) {
</span></span><span style="display:flex;"><span>		<span style="color:#75715e">#输入的是摄氏温度，计算华氏温度</span>
</span></span><span style="display:flex;"><span>		$celsius <span style="color:#f92672">=</span> $InputNum;
</span></span><span style="display:flex;"><span>		$fahrenheit <span style="color:#f92672">=</span> ($celsius <span style="color:#f92672">*</span> <span style="color:#ae81ff">9</span> <span style="color:#f92672">/</span> <span style="color:#ae81ff">5</span>) <span style="color:#f92672">+</span> <span style="color:#ae81ff">32</span>;
</span></span><span style="display:flex;"><span>	} <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#75715e">#输入的是华氏温度，计算摄氏温度</span>
</span></span><span style="display:flex;"><span>		$fahrenheit <span style="color:#f92672">=</span> $InputNum;
</span></span><span style="display:flex;"><span>		$celsius <span style="color:#f92672">=</span> ($fahrenheit <span style="color:#f92672">-</span> <span style="color:#ae81ff">32</span>) <span style="color:#f92672">*</span> <span style="color:#ae81ff">5</span> <span style="color:#f92672">/</span> <span style="color:#ae81ff">9</span>;
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	printf <span style="color:#e6db74">&#34;%.2f C is %.2f F\n&#34;</span>, $celsius, $fahrenheit;
</span></span><span style="display:flex;"><span>} <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">print</span> <span style="color:#e6db74">&#34;expecting a number followed by \&#34;C\&#34; or \&#34;F\&#34;,\n&#34;</span>;
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">print</span> <span style="color:#e6db74">&#34;so I don&#39;t understand \&#34;$input\&#34; .\n&#34;</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="使用正则修改文本">
  使用正则修改文本
  <a class="anchor" href="#%e4%bd%bf%e7%94%a8%e6%ad%a3%e5%88%99%e4%bf%ae%e6%94%b9%e6%96%87%e6%9c%ac">#</a>
</h3>
<ul>
<li><code>$var =~ s/regex/replacement/</code> 当正则表达式能够匹配$var中的某段文本，则将这段文本替换为replacement。此替换只发生一次。</li>
<li><code>/g</code>用于在<code>s/.../.../</code>第一次替换完成后继续搜索更多的匹配文本，进行更多的替换。</li>
</ul>
<h3 id="环视功能">
  环视功能
  <a class="anchor" href="#%e7%8e%af%e8%a7%86%e5%8a%9f%e8%83%bd">#</a>
</h3>
<ul>
<li>环视是在文本的特定位置上匹配左边或者右边的文本，但是不会占用字符，类似<code>\b</code> <code>^</code> <code>$</code>，但是更加通用。</li>
</ul>
<table>
<thead>
<tr>
<th></th>
<th>介绍</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>(?=...)</code>肯定顺序环视</td>
<td>在当前位置向右查看文本，尝试匹配子表达式，如果能匹配，就返回匹配成功信息。</td>
</tr>
<tr>
<td><code>(?!...)</code>否定顺序环视</td>
<td>在当前位置向右查看文本，尝试匹配子表达式，如果不能够匹配，就返回成功信息。</td>
</tr>
<tr>
<td><code>(?&lt;=...)</code>肯定逆序环视</td>
<td>在当前位置向左查看文本，尝试匹配子表达式，如果匹配成功，就返回匹配成功信息。</td>
</tr>
<tr>
<td><code>(?&lt;!...)</code>否定逆序环视</td>
<td>在当前位置向左查看文本，尝试匹配子表达式，如果不能匹配，就返回成功信息。</td>
</tr>
</tbody>
</table>
<h2 id="匹配原理">
  匹配原理
  <a class="anchor" href="#%e5%8c%b9%e9%85%8d%e5%8e%9f%e7%90%86">#</a>
</h2>
<h3 id="优先选择最左边的匹配结果">
  优先选择最左边的匹配结果
  <a class="anchor" href="#%e4%bc%98%e5%85%88%e9%80%89%e6%8b%a9%e6%9c%80%e5%b7%a6%e8%be%b9%e7%9a%84%e5%8c%b9%e9%85%8d%e7%bb%93%e6%9e%9c">#</a>
</h3>
<ul>
<li>起始位置最靠左的匹配结果总是优于其他可能的匹配结果。</li>
<li>匹配会从需要查找的字符串的起始位置开始尝试匹配，在起始位置测试正则表达式不能匹配后，就从第二个字符开始测试匹配，直到找到能匹配成功的情况或到了字符串的最后一个字符。</li>
</ul>
<pre tabindex="0"><code>正则：fat|cat|belly|your
文本：the dragging belly indicates that your cat is too fat
结果：belly
</code></pre><h3 id="标准量词minmax是优先匹配的">
  标准量词?、*、+、{min,max}是优先匹配的。
  <a class="anchor" href="#%e6%a0%87%e5%87%86%e9%87%8f%e8%af%8dminmax%e6%98%af%e4%bc%98%e5%85%88%e5%8c%b9%e9%85%8d%e7%9a%84">#</a>
</h3>
<ul>
<li>例：<code>^.*([0-9][0-9])</code>匹配abot24characterslong的过程。
<ul>
<li><code>.*</code>匹配整个字符串以后，第一个<code>[0-9]</code>的匹配要求<code>.*</code>吐出来一个字符<code>g</code>，但这并不能让<code>[0-9]</code>匹配，所以<code>.*</code>必须继续吐字符，接下来的字符是<code>n</code>，如此循环15次，直到<code>.*</code>吐出来了<code>4</code>。</li>
<li>即使第一个<code>[0-9]</code>能匹配<code>4</code>，但是第二个<code>[0-9]</code>仍然不能匹配，为了匹配正则表达式，<code>[.*]</code>必须再次释放一个字符，这次是<code>2</code>，第一个由<code>[0-9]</code>匹配，<code>4</code>能够由<code>[0-9]</code>匹配，所以刺配成功，\1的值是<code>24</code>。</li>
</ul>
</li>
</ul>
<h3 id="传统nfa的多选结构是匹配优先的">
  传统NFA的多选结构是匹配优先的
  <a class="anchor" href="#%e4%bc%a0%e7%bb%9fnfa%e7%9a%84%e5%a4%9a%e9%80%89%e7%bb%93%e6%9e%84%e6%98%af%e5%8c%b9%e9%85%8d%e4%bc%98%e5%85%88%e7%9a%84">#</a>
</h3>
<ul>
<li>传统NFA遇到多选结构是，会按照从左到右的顺序检查表达式中的多选分支。如<code>^(subject|date):*</code>，当遇到此选择分支时，首先尝试匹配subject，如果可以匹配，就匹配接下来的<code>:*</code>。如果无法匹配，就尝试其他多选分支（尝试匹配date）。即多选结构既不是匹配优先，也不是忽略优先，而是按照多选结构的顺序。</li>
<li>用<code>tour|to|tournament</code>来匹配<code>three tournaments</code>时会得到什么呢？</li>
</ul>
<h2 id="回溯">
  回溯
  <a class="anchor" href="#%e5%9b%9e%e6%ba%af">#</a>
</h2>
<ul>
<li>NFA最重要的性质是，它会依次处理各个子表达式或组成元素，需要在两个可能成功的可能中进行选择的时候，它会选择其一，同时记住另一个，以备稍后可能的需要。</li>
<li>面对多个选择时，选择哪个分支呢？如果在进行尝试和跳过尝试之间选择，对于匹配优先量词，引擎会优先选择进行尝试，而对于忽略优先量词，会选择跳过尝试。</li>
<li>当发生回溯时，距离当前最近存储的选项就是当本地失败强制回溯返回的，使用的原则是LIFO（后进先出）。</li>
<li>回溯不但需要重新计算正则表达式和文本的对应位置，也需要维护括号内的子表达式所匹配的文本的状态。</li>
</ul>
<h2 id="固化分组">
  固化分组
  <a class="anchor" href="#%e5%9b%ba%e5%8c%96%e5%88%86%e7%bb%84">#</a>
</h2>
<ul>
<li>固化分组可能会放弃某些可能的路径，使用<code>(?&gt;...)</code>。</li>
<li>使用固化分组与正常的匹配毫无差别，但是当匹配到固化分组结构之后，在固化分组中的所有备用状态都会被放弃。在固化分组匹配结束时，他已匹配的文本已经固化为一个单元，只能作为整体而保留或放弃。</li>
<li><code>(?&gt;.*?)</code>永远无法匹配任何字符。</li>
</ul>
<h2 id="占有优先量词---mn">
  占有优先量词<code>?=</code> <code>*+</code> <code>++</code> <code>{m,n}+</code>
  <a class="anchor" href="#%e5%8d%a0%e6%9c%89%e4%bc%98%e5%85%88%e9%87%8f%e8%af%8d---mn">#</a>
</h2>
<ul>
<li>占有优先量词和匹配优先量词很相似，但是占有优先量词从不归还已匹配的字符。</li>
<li>占有优先量词和固化分组非常相似，如<code>w++</code>和<code>(?&gt;w+)</code>的匹配结果完全相同。</li>
</ul>
    </p>
  </article>
  
  <article class="markdown book-post">
    <h2>
      <a href="/posts/javaee/log4j2/">Log4j2</a>
    </h2>
    
  <h5>2022-01-07</h5>



  

  
  <div>
    
      <a href="/tags/java/">java</a>
  </div>
  




    <p><h3 id="log4j2文件加载顺序">
  log4j2文件加载顺序
  <a class="anchor" href="#log4j2%e6%96%87%e4%bb%b6%e5%8a%a0%e8%bd%bd%e9%a1%ba%e5%ba%8f">#</a>
</h3>
<ol>
<li>检查是否配置了log4j2.configurationFile系统属性，如果设置了，就会尝试使用匹配文件后缀的ConfigurationFactory去加载配置。该配置不限制为本地文件，也可以包含URL。</li>
<li>在classpath路径下找log4j2-test.properties。</li>
<li>在classpath路径下找log4j2-test.ymal 或log4j2-test.yml文件。</li>
<li>在classpath路径下找log4j2-test.json或Log4j2.jsn文件。</li>
<li>在classpath路径下找log4j2-test.xml。</li>
<li>在classpath路径下找log4j2.properties文件。</li>
<li>在classpath路径下找log4j2.ymal或log4j2.yml文件。</li>
<li>在classpath路径下找log4j2.json或log4j2.jsn文件。</li>
<li>在classpath路径下找log4j2.xml文件。</li>
<li>如果没有找到配置文件，则会使用默认配置，将日志输出到控制台。</li>
</ol>
    </p>
  </article>
  
  <article class="markdown book-post">
    <h2>
      <a href="/posts/javaee/syslog/">Syslog</a>
    </h2>
    
  <h5>2022-01-07</h5>



  

  
  <div>
    
      <a href="/tags/java/">java</a>
  </div>
  




    <p><h2 id="rfc5424">
  rfc5424
  <a class="anchor" href="#rfc5424">#</a>
</h2>
<h3 id="介绍">
  介绍
  <a class="anchor" href="#%e4%bb%8b%e7%bb%8d">#</a>
</h3>
<p>格式：<code>PRI VERSION TIMESTAMP HOSTNAME APP-NAME PROCID MSGID STRUCTURED-DATA MSG</code></p>
<ul>
<li>消息头
<ul>
<li>PRI 优先级</li>
<li>VERSION 版本</li>
<li>TIMESTAMP 时间</li>
<li>HOSTNAME 主机名</li>
<li>APP-NAME APP名称</li>
<li>PROCID 进程的ID</li>
<li>MSGID 消息ID</li>
</ul>
</li>
<li>STRUCTURED-DATA</li>
<li>消息体</li>
</ul>
<h4 id="pri">
  PRI
  <a class="anchor" href="#pri">#</a>
</h4>
<ul>
<li>PRI（priority）代表两个值（Facility）和日志级别（serverity）。PRI必须是类似<code>&lt;14&gt;</code>的格式。中间的值的计算公式为<code>priority = facility x 8 + serverity</code>。</li>
<li>Facility的值是<code>[0,23]</code>。各个值的含义如下：</li>
</ul>
<table>
<thead>
<tr>
<th>数字</th>
<th>介绍</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>内核消息</td>
</tr>
<tr>
<td>1</td>
<td>用户级别消息</td>
</tr>
<tr>
<td>2</td>
<td>邮件系统</td>
</tr>
<tr>
<td>3</td>
<td>系统守护进程</td>
</tr>
<tr>
<td>4</td>
<td>安全/认证消息</td>
</tr>
<tr>
<td>5</td>
<td>syslogd内部生成的消息</td>
</tr>
<tr>
<td>6</td>
<td>line printer subsystem</td>
</tr>
<tr>
<td>7</td>
<td>network news subsystem</td>
</tr>
<tr>
<td>8</td>
<td>UUCP subsystem</td>
</tr>
<tr>
<td>9</td>
<td>时钟守护程序</td>
</tr>
<tr>
<td>10</td>
<td>安全/认证消息</td>
</tr>
<tr>
<td>11</td>
<td>FTP守护程序</td>
</tr>
<tr>
<td>12</td>
<td>NTF子系统</td>
</tr>
<tr>
<td>13</td>
<td>log audit</td>
</tr>
<tr>
<td>14</td>
<td>log alert</td>
</tr>
<tr>
<td>15</td>
<td>clock daemon (note 2)</td>
</tr>
<tr>
<td>16</td>
<td>本地用户0（LOCAL0）</td>
</tr>
<tr>
<td>17</td>
<td>本地用户1（LOCAL1）</td>
</tr>
<tr>
<td>18</td>
<td>本地用户2（LOCAL2）</td>
</tr>
<tr>
<td>19</td>
<td>本地用户3（LOCAL3）</td>
</tr>
<tr>
<td>20</td>
<td>本地用户4（LOCAL4）</td>
</tr>
<tr>
<td>21</td>
<td>本地用户5（LOCAL5）</td>
</tr>
<tr>
<td>22</td>
<td>本地用户6（LOCAL6）</td>
</tr>
<tr>
<td>23</td>
<td>本地用户7（LOCAL7）</td>
</tr>
</tbody>
</table>
<h4 id="serverity">
  Serverity
  <a class="anchor" href="#serverity">#</a>
</h4>
<table>
<thead>
<tr>
<th>数字</th>
<th>介绍</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>emergency紧急，系统无法使用</td>
</tr>
<tr>
<td>1</td>
<td>alert警告，必须立即采取措施</td>
</tr>
<tr>
<td>2</td>
<td>critical</td>
</tr>
<tr>
<td>3</td>
<td>error</td>
</tr>
<tr>
<td>4</td>
<td>warning</td>
</tr>
<tr>
<td>5</td>
<td>notice；正常但是重要的情况</td>
</tr>
<tr>
<td>6</td>
<td>informational；普通信息</td>
</tr>
<tr>
<td>7</td>
<td>debug；</td>
</tr>
</tbody>
</table>
<h3 id="例子">
  例子
  <a class="anchor" href="#%e4%be%8b%e5%ad%90">#</a>
</h3>
<pre tabindex="0"><code>&lt;165&gt;1 2003-08-24T05:14:15.000003-07:00 192.0.2.1 myproc 8710 - - %% It&#39;s time to make the do-nuts
&lt;165&gt;1 2003-10-11T22:14:15.003Z mymachine.example.com evntslog - ID47 [exampleSDID@32473 iut=&#34;3&#34; eventSource=&#34;Application&#34; eventID=&#34;1011&#34;] BOMAn
&lt;165&gt;1 2003-10-11T22:14:15.003Z mymachine.example.com evntslog - ID47 [exampleSDID@32473 iut=&#34;3&#34; eventSource=&#34;Application&#34; eventID=&#34;1011&#34;][examplePriority@32473 class=&#34;high&#34;]
</code></pre><h3 id="log4j2配置">
  log4j2配置
  <a class="anchor" href="#log4j2%e9%85%8d%e7%bd%ae">#</a>
</h3>
<pre tabindex="0"><code>&lt;Syslog name=&#34;RFC5424&#34; format=&#34;RFC5424&#34; host=&#34;10.2.4.31&#34; port=&#34;5140&#34; protocol=&#34;UDP&#34; 
appName=&#34;auditSyslogDemo&#34; facility=&#34;LOCAL0&#34; newLine=&#34;true&#34; messageId=&#34;Audit&#34; id=&#34;App&#34;/&gt;
</code></pre><p>参考链接：
  <a href="https://www.rfc-editor.org/rfc/rfc5424.html">RFC 5424: The Syslog Protocol (rfc-editor.org)</a></p>
<p>参考链接：
  <a href="https://logging.apache.org/log4j/2.x/manual/appenders.html#SyslogAppender">Log4j – Log4j 2 Appenders (apache.org)</a></p>
    </p>
  </article>
  

  
    <ul class="pagination pagination-default">
      <li class="page-item">
        <a href="/posts/" aria-label="First" class="page-link" role="button"><span aria-hidden="true">&laquo;&laquo;</span></a>
      </li>
      <li class="page-item">
        <a href="/posts/page/3/" aria-label="Previous" class="page-link" role="button"><span aria-hidden="true">&laquo;</span></a>
      </li>
      <li class="page-item">
        <a href="/posts/page/2/" aria-label="Page 2" class="page-link" role="button">2</a>
      </li>
      <li class="page-item">
        <a href="/posts/page/3/" aria-label="Page 3" class="page-link" role="button">3</a>
      </li>
      <li class="page-item active">
        <a aria-current="page" aria-label="Page 4" class="page-link" role="button">4</a>
      </li>
      <li class="page-item">
        <a href="/posts/page/5/" aria-label="Page 5" class="page-link" role="button">5</a>
      </li>
      <li class="page-item">
        <a href="/posts/page/6/" aria-label="Page 6" class="page-link" role="button">6</a>
      </li>
      <li class="page-item">
        <a href="/posts/page/5/" aria-label="Next" class="page-link" role="button"><span aria-hidden="true">&raquo;</span></a>
      </li>
      <li class="page-item">
        <a href="/posts/page/19/" aria-label="Last" class="page-link" role="button"><span aria-hidden="true">&raquo;&raquo;</span></a>
      </li>
    </ul>
 
	    </div>

      <footer class="page-footer">
        
  
<a href="https://beian.miit.gov.cn" target="_blank" style="color:gray;"></a>

 
      </footer>
    </div>

  </main>

</body>
</html>











